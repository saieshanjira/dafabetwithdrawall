"63713e3027232be88072af467b99e26cbba24305";
(function(){var v=window.frosmo=window.frosmo||{},U=window._frosmo=window._frosmo||{},a=v.easy=v.easy||{};v.site=v.site||{};a.config=a.config||{};if(!0===a.namespaceLoaded)a.console&&a.console.error("frosmo.easy.js is already loaded. Initialization could be corrupted");else{var ba=window.Array,C=window.Boolean,na=window.clearInterval,V=window.clearTimeout,aa=window.console,B=window.Date,X=window.decodeURIComponent,w=window.document,W=window.encodeURIComponent,x=window.Error,da=window.escape,oa=window.Event,
ea=window.Function,pa=window.getComputedStyle,Q=window.history,qa=window.Image,ra=window.isFinite,sa=window.isNaN,ia=window.JSON,R=window.location,F=window.Math,ta=window.MutationObserver,M=window.navigator,S=window.Node,H=window.Number,I=window.Object,K=window.parseFloat,P=window.parseInt,N=window.RegExp,ua=window.setInterval,va=window.setTimeout,z=window.String,Y=window.TypeError,ja=window.unescape,wa=window.WebKitMutationObserver,xa=window.XMLHttpRequest,fa;try{fa=window.localStorage}catch(f){}v.MutationObserver=
ta;v.WebKitMutationObserver=wa;a.overrideBrowser=function(f,b){if(void 0===b){var e=a.domElements.selector("#frosmo-internal-frame")[0];e||(e=w.createElement("iframe"),e.width=0,e.height=0,e.tabIndex=-1,e.id="frosmo-internal-frame",e.style.display="none",(w.body?w.body:w.head).appendChild(e));b=e.contentWindow[f];if(!b)return}switch(f){case "Array":ba=b;break;case "Boolean":C=b;break;case "clearInterval":na=b;break;case "clearTimeout":V=b;break;case "console":aa=b;break;case "Date":B=b;break;case "decodeURIComponent":X=
b;break;case "document":w=b;break;case "encodeURIComponent":W=b;break;case "Error":x=b;break;case "escape":da=b;break;case "Event":oa=b;break;case "Function":ea=b;break;case "getComputedStyle":pa=b;break;case "history":Q=b;break;case "Image":qa=b;break;case "isFinite":ra=b;break;case "isNaN":sa=b;break;case "JSON":ia=b;break;case "localStorage":fa=b;break;case "location":R=b;break;case "Math":F=b;break;case "MutationObserver":ta=b;v.MutationObserver=b;break;case "navigator":M=b;break;case "Node":S=
b;break;case "Number":H=b;break;case "Object":I=b;break;case "parseFloat":K=b;break;case "parseInt":P=b;break;case "RegExp":N=b;break;case "setInterval":ua=b;break;case "setTimeout":va=b;break;case "String":z=b;break;case "TypeError":Y=b;break;case "unescape":ja=b;break;case "WebKitMutationObserver":wa=b;v.WebKitMutationObserver=b;break;case "XMLHttpRequest":xa=b}};a.deprecate=function(f,b,e,h,c){return function(){var d='"'+f+'" deprecated, use "'+b+'" instead';if(c)try{a.log.error(d,a.ERROR_TYPE_DEPRECATED+
".removed")}catch(g){a.console.error(g)}else a.console.error(d);return e.apply(h,arguments)}};(function(){a.VERSION="24.79.0";a.MINIMUM_RULES_VERSION="3.6";a.getVersion=function(){return a.VERSION+"-"+a.VERSION_RULES};a.versionAtLeast=function(f,b){if(!f||!b)return!1;for(var e=a.utils.map(z(f).split("."),H);3>e.length;)e.push(0);for(var h=a.utils.map(z(b).split("."),H);3>h.length;)h.push(0);for(var c=!0,d=0;3>d&&!(h[d]>e[d]);d++)if(h[d]<e[d]){c=!1;break}c||a.console.error("[version]","Minimum version mismatch, for "+
b+", expected "+f);return c}})();a.ERROR_SITE_JQUERY_MISSING=20017;a.ERROR_SITE_LOCALE=20008;a.ERROR_SITE_UNKNOWN=20009;a.ERROR_SITE_USER=20010;a.ERROR_SITE_CONVERSION=20021;a.ERROR_SITE_CONVERSION_TRANS_ID_MISSING=20013;a.ERROR_SITE_CONVERSION_ID=20014;a.ERROR_SITE_CONVERSION_VALUE=20015;a.ERROR_SITE_CONVERSION_QUANTITY=20025;a.ERROR_SITE_CUSTOMACTION=20024;a.ERROR_SITE_CUSTOMACTION_VALUE=20018;a.ERROR_SITE_INIT=20019;a.ERROR_SITE_CUSTOM_API=20020;a.ERROR_SITE_PRODUCT_ID=20026;a.ERROR_SITE_PRODUCT_ATTRIBUTE=
20027;a.ERROR_SITE_TRANSACTION=20029;a.EVENT_SEGMENT_ENTER="segment.enter";a.EVENT_SEGMENT_LEAVE="segment.leave";a.EVENT_SEGMENTS_READY="segments.ready";a.EVENT_CUSTOMACTION="customAction";a.EVENT_INIT_START="init.start";a.EVENT_INIT_SUCCESS="init.success";a.EVENT_INIT_FAILURE="init.failure";a.EVENT_INIT_UID="init.uid";a.EVENT_UID_CREATED="uid.created";a.EVENT_INIT_CONTEXT="init.context";a.EVENT_INIT_QUICK_CONTEXT="init.quick_context";a.EVENT_LOGIN="login";a.EVENT_LOGOUT="logout";a.EVENT_EASY_CONFIG=
"easy.config";a.EVENT_SCRIPT_LOAD="scriptLoad";a.EVENT_VISIT="visit";a.EVENT_LOCATION="location";a.EVENT_LOCATION_FAILURE="location.failure";a.EVENT_XDM_REQUEST="xdm.request";a.EVENT_XDM_READY="xdm.ready";a.EVENT_XDM_FAILURE="xdm.failure";a.EVENT_CONVERSION="conversion";a.EVENT_PRODUCT_DATA="product";a.EVENT_PRODUCT_PURCHASE="product.purchase";a.EVENT_DATALAYER="dataLayer";a.EVENT_MESSAGE_INIT="message.initSuccess";a.EVENT_MESSAGE_REQUEST="message.request";a.EVENT_MESSAGE_RECEIVE="message.receive";
a.EVENT_MESSAGE_SUCCESS="message.success";a.EVENT_MESSAGE_FAILURE="message.failure";a.EVENT_MESSAGESHOW_COMPLETE="messageshow.complete";a.EVENT_MESSAGESHOW_FAILED="messageshow.failed";a.EVENT_MESSAGE_SHOW="message.showMessage";a.EVENT_MESSAGE_CLICK="message.clickMessage";a.EVENT_MESSAGE_TRUE_DISPLAY="message.trueDisplay";a.EVENT_URL_CHANGED="pageload.urlChanged";a.EVENT_PAGE_CHANGED="pagechange.urlChanged";a.EVENT_DOM_EVENT="domEvent";a.EVENT_DOM_WAIT="domWait";a.EVENT_EASY_EVENT="easyEvent";a.EVENT_JSVAR_WAIT=
"jsvarWait";a.EVENT_TRIGGER_EVENT="trigger.event";a.EVENT_TRIGGER_FIRE="trigger.fire";a.EVENT_PREVIEW_TOOL_ENABLE="previewTool.enable";a.EVENT_PREVIEW_TOOL_DISABLE="previewTool.disable";a.EVENT_ERROR_SENT="error.sent";a.EVENT_EASY_READY="easy.ready";a.EVENT_DOM_READY="domReady";a.EVENT_JQUERY_READY="jquery.ready";a.EVENT_STATE_REMOVE="state.remove";a.EVENT_STATE_SET="state.set";a.EVENT_PROMISE_REJECTION_HANDLED="promise.rejectionHandled";a.EVENT_PROMISE_UNHANDLED_REJECTION="promise.unhandledRejection";
a.XDM_INIT_TIMEOUT=5E3;a.ENV="prod";a.CUSTOM_SCRIPT_UPDATED_AT=void 0;a.COOKIE_QUICK_CONTEXT="frosmo_quickContext";a.COOKIE_MAX_SIZE=3E3;a.MESSAGE_TRUE_DISPLAY_TIME=3E3;a.JQUERY_INIT_TIMEOUT=1E4;a.CONTEXT_TYPE_SERVER="context.api";a.CONTEXT_TYPE_STORAGE="local.storage";a.CONTEXT_TYPE_XDM="shared.context";a.MESSAGE_TYPE_BASIC="basic";a.MESSAGE_TYPE_CACHED="cached";a.STATE_DEVICE="_device";a.STATE_MODE="_mode";a.STATE_MODE_TEST="test";a.STATE_TYPE_PAGE=3;a.STATE_TYPE_SESSION=2;a.DEVICE_REGEXP_IOS=/(iPhone|iPod)/i;
a.DEVICE_REGEXP_IPAD=/iPad/i;a.DEVICE_REGEXP_ANDROIDMOBILE=/Android.+(mobile|Opera (mini|mobi))/i;a.DEVICE_REGEXP_ANDROIDTABLET=/Android(?!.+(mobile|Opera (mini|mobi)))/i;a.DEVICE_REGEXP_WINDOWSPHONE=/Windows Phone|Windows CE|Windows Mobile|IEMobile/i;a.DEVICE_REGEXP_WINDOWSTABLET=/Windows.*ARM/i;a.DEVICE_REGEXP_OTHERMOBILE=/(\sPPC|Blackberry|Cricket|iPAQ|HTC_Touch|HTC_HD2|HTC-ST7377|Kindle|LG\d|LG-G|LG-L|LGE|Teleca|POLARIS|MOT-|MOT\d|Nintendo|Nokia|Symbian|SymbOS|SPV\s|PalmSource|PalmOS|SAMSUNG|sam-r\d|samr\d|SCH-A950|SEC-SGH|SHARP|SIE-|UP\.BROWSER|sonyericsson|UC(\s?)Browser|WebOS|Pantech|MobileExplorer|ZuneWP7|Opera Mini|Opera Mobi)/i;
a.DEVICE_REGEXP_OTHERTABLET=/Playbook|hp-tablet|Opera Tab/i;a.MESSAGE_PRE_RENDERER_SCRIPT_ID="frosmo_message_pre_renderer_script_id_";a.MESSAGE_SCRIPT_ID="frosmo_message_script_id_";a.SHARED_CODE_ID="frosmo_shared_code_id_";a.MESSAGE_STYLE_ID="frosmo_message_style_id_";a.DOM_EVENT_NAMESPACE="easy_core";a.LOG_LEVEL_DEBUG="debug";a.LOG_LEVEL_INFO="info";a.LOG_LEVEL_WARN="warn";a.LOG_LEVEL_WARNING="warning";a.LOG_LEVEL_LOG="log";a.LOG_LEVEL_ERROR="error";a.LOG_LEVEL_CRITICAL="critical";a.MAXIMUM_URL_LENGTH=
4100;a.MAXIMUM_TRACE_LENGTH=2E3;a.GA_INIT_TIMEOUT=5E3;a.ERROR_TYPE_AJAX_EXCEPTION="ajax.exception";a.ERROR_TYPE_AJAX_CANCELLED="ajax.cancelled";a.ERROR_TYPE_AJAX_TIMEOUT="ajax.timeout";a.ERROR_TYPE_ARG_INVALID="arg.invalid";a.ERROR_TYPE_CONTEXT_EXCEPTION="context.exception";a.ERROR_TYPE_CONTEXT_INVALID="context.invalid";a.ERROR_TYPE_CONTEXT_INIT="context.init";a.ERROR_TYPE_CONTEXT_INIT_LONG="context.init_long";a.ERROR_TYPE_CONTEXT_INIT_READY="context.init_ready";a.ERROR_TYPE_CONTEXT_INIT_REQUIREMENTS=
"context.init_requirements";a.ERROR_TYPE_CONTEXT_INIT_SELECTOR="context.init_selector";a.ERROR_TYPE_CONTEXT_INIT_STORAGE="context.init_storage";a.ERROR_TYPE_CONTEXT_INIT_TIMEOUT="context.init_timeout";a.ERROR_TYPE_CONTEXT_READY="context.ready";a.ERROR_TYPE_COOKIE_LONG="cookie.long";a.ERROR_TYPE_CORE_INIT="core.init";a.ERROR_TYPE_CUSTOM_ACTION_INVALID="customaction.invalid";a.ERROR_TYPE_DEPRECATED="deprecated";a.ERROR_TYPE_ELEMENTS_LONG="elements.long";a.ERROR_TYPE_EXCEPTION="exception";a.ERROR_TYPE_GA_EXCEPTION=
"ga.exception";a.ERROR_TYPE_GA_MISSING="ga.missing";a.ERROR_TYPE_INIT="init";a.ERROR_TYPE_JQUERY_MISSING="jquery.missing";a.ERROR_TYPE_SHARED_CODE_EXCEPTION="sharedCode.exception";a.ERROR_TYPE_MESSAGE_EXCEPTION="message.exception";a.ERROR_TYPE_MESSAGE_INIT="message.init";a.ERROR_TYPE_MESSAGE_INVALID="message.invalid";a.ERROR_TYPE_MODULE_MISSING="module.missing";a.ERROR_TYPE_ORIGIN_MISMATCH="origin.mismatch";a.ERROR_TYPE_POSITION_EXCEPTION="position.exception";a.ERROR_TYPE_QUEUE_LONG="queue.long";
a.ERROR_TYPE_RENDERER_INVALID="renderer.invalid";a.ERROR_TYPE_SEGMENT_EXCEPTION="segment.exception";a.ERROR_TYPE_SELECTOR_INVALID="selector.invalid";a.ERROR_TYPE_SITE_EXCEPTION="site.exception";a.ERROR_TYPE_SITE_INIT="site.init";a.ERROR_TYPE_STORAGE_EXCEPTION="storage.exception";a.ERROR_TYPE_STORAGE_MISSING="storage.missing";a.ERROR_TYPE_TEMPLATE_EXCEPTION="template.exception";a.ERROR_TYPE_TEMPLATE_MISSING="template.missing";a.ERROR_TYPE_TIMEOUT="timeout";a.ERROR_TYPE_TRIGGER_EXCEPTION="trigger.exception";
a.ERROR_TYPE_URL_LONG="url.long";a.ERROR_TYPE_VERSION_INVALID="version.invalid";a.MODULE_CORE="[core]";a.MODULE_SITE="[site]";a.MODULE_SHARED_CODE="[sharedCode]";a.MODULE_MESSAGE="[message]";a.MODULE_POSITION="[position]";a.MODULE_SEGMENT="[segment]";a.MODULE_TRIGGER="[trigger]";(function(){a.xdmLocal=function(f){if(!f.remote)throw new x('Invalid "remote" property for '+f.remote);this.timeout=f.timeout;this.timerId=0;f=a.utils.parseUri(f.remote);this.domain=f.protocol+"://"+f.authority;this.path=
f.path;this.callbacks=[];this.allowedOrigin=this.domain;this.remoteOrigin=this.remoteIframe=null;this.debugging=a.store.get("frosmo_xdm_debug");this.index=this.totalCount;this.selector=a.config.xdmIframeInHead?"head":"body";f="Selector: "+this.selector+", Domain: "+this.domain+", Path: "+this.path;this.errOpts={level:a.LOG_LEVEL_ERROR,debug:f};this.warnOpts={level:a.LOG_LEVEL_WARNING,debug:f};this.infoOpts={level:a.LOG_LEVEL_INFO,debug:f};return this};a.xdmLocal.prototype={totalCount:0,domains:{},
init:function(){if(!this.domain||!this.path)throw new x("Invalid domain/path for "+this.domain+","+this.path);if(a.xdmLocal.prototype.domains[this.domain])throw new x("Already connected to "+this.domain);a.xdmLocal.prototype.domains[this.domain]=!0;a.xdmLocal.prototype.totalCount+=1;this.log("Initialize "+this.domain);var f=this,b=new a.Promise(function(a,b){f.onReady=function(){a(f)};f.onError=b});return a.domElements.waitFor({selector:f.selector,timeout:1E4}).then(function(e){a.domEvents.on(window,
"message."+a.DOM_EVENT_NAMESPACE,f.receiveMessage,f);var h=w.createElement("iframe");h.src=f.domain+f.path+"?"+a.VERSION;h.width=0;h.height=0;h.tabIndex=-1;h.id="frosmo-xdm";h.style.display="none";e[0].appendChild(h);f.timeout&&(f.timerId=a.utils.setTimeout(function(){var c=new x('xdmRemote "ready" method timed out after '+f.timeout+" millisecond(s)");f.onError(a.internal.createLogError(c,a.ERROR_TYPE_CONTEXT_INIT_TIMEOUT,f.warnOpts))},f.timeout));return b}).catch(function(e){f.onError(a.internal.createLogError(e,
a.ERROR_TYPE_CONTEXT_INIT_SELECTOR,f.warnOpts));return b})},get:function(f){var b=this;return new a.Promise(function(a){b.callbacks.push(a);b.sendMessage({method:"get",name:f})})},set:function(f,b){var e=this;return new a.Promise(function(a){e.callbacks.push(a);e.sendMessage({method:"set",name:f,value:b})})},reset:function(){a.xdmLocal.prototype.domains={};a.xdmLocal.prototype.totalCount=0},receiveMessage:function(f){if(f.origin)if(f.origin.toLowerCase()!==this.allowedOrigin.toLowerCase())this.log("Invalid domain for "+
f.origin+", it was not "+this.allowedOrigin,void 0,!0);else{var b;try{b=v.JSON.parse(f.data),b.method=b.method}catch(e){this.log('Invalid message "data" property',f,!0);return}this.log("Recieved (local) "+b.method+", origin: "+f.origin,f.data);switch(b.method){case "ready":V(this.timerId);if(this.remoteIframe){a.log.warn('xdmRemote "ready" method already received',a.ERROR_TYPE_CONTEXT_READY,this.warnOpts);break}this.remoteIframe=f.source;this.remoteOrigin=f.origin;this.onReady();break;case "error":V(this.timerId);
f=new x(b.value);switch(b.type){case a.ERROR_TYPE_CONTEXT_INIT_REQUIREMENTS:this.onError(a.internal.createLogError(f,a.ERROR_TYPE_CONTEXT_INIT_REQUIREMENTS,this.infoOpts));break;case a.ERROR_TYPE_CONTEXT_INIT_LONG:this.onError(a.internal.createLogError(f,a.ERROR_TYPE_CONTEXT_INIT_LONG,this.warnOpts));break;default:this.onError(a.internal.createLogError(f,a.ERROR_TYPE_CONTEXT_EXCEPTION,this.errOpts))}break;case "get":case "set":f=this.callbacks.shift(),a.utils.isFunction(f)&&f(b.value),b.error&&a.log.warn(b.error,
a.ERROR_TYPE_CONTEXT_EXCEPTION,this.warnOpts)}}else this.log('Invalid "message" argument, does not contain an origin property',void 0,!0)},sendMessage:function(f){if(!this.remoteIframe||!this.remoteOrigin){f=new x('xdmRemote "ready" method not received');var b=a.utils.clone(this.errOpts);b.module=a.internal.getCurrentModule();throw a.internal.createLogError(f,a.ERROR_TYPE_CONTEXT_INIT_READY,b);}try{this.remoteIframe.postMessage(v.JSON.stringify(f),this.remoteOrigin)}catch(e){throw a.internal.createLogError(e,
"context_"+a.ERROR_TYPE_ARG_INVALID,this.warnOpts);}},log:function(f,b,e){this.debugging&&(e?a.console.error:a.console.log)("[xdmLocal]","Index:"+this.index+","+f,b)}}})();a.fetch=function(){function f(c){function d(c,b){c=c||r.status?c.slice(0,255):"Unexpected error with the ajax request (default)";var d={text:c,type:b,status:r.status,url:k,method:l},g;try{g=v.JSON.stringify(d)}catch(m){g='{"text":"Unexpected error with the ajax request (default)","type":"'+b+'","status":-1,"url":"'+k+'","method":"'+
l+'"}'}t?t(r,r.statusText,d,g):a.Promise.hasRejectionHandler(u.promise)||a.log.error(c,b,{debug:g});u.reject({xhr:r,textStatus:r.statusText,errorThrown:d})}if(!a.utils.isObject(c)||a.utils.isEmpty(c))throw new x('Invalid type for ajax "options" argument, for "'+c+'"');if(!c.url)throw new x('Invalid type for ajax "url" property, got "'+a.utils.getType(c.url)+'"');var g=c.dataType||"JSON";b(g,e,"options.dataType");b(c.method,h,"options.method");var l=c.method.toUpperCase(),f=a.utils.isFunction(c.success)?
a.guard(c.success):function(){},t=a.utils.isFunction(c.error)?a.guard(c.error):void 0,r=new xa,u=a.Promise.withResolvers();u.onCancel(function(){r.abort()});var k=c.url,m=c.data,n=c.headers;switch(l){case "GET":k=a.utils.addQueryString(k,c.params);m=void 0;break;case "POST":case "PUT":case "PATCH":"formdata"!==a.utils.getType(m)&&a.utils.isObject(m)&&(m=a.utils.addQueryString("",m).slice(1)),c.skipDefaultHeaders||(n=a.utils.extend({"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},
n))}r.onload=r.onerror=a.guard(function(){if(u.promise.isCancelled())d("Request was cancelled",a.ERROR_TYPE_AJAX_CANCELLED);else if(200<=r.status&&299>=r.status)a:{var b=r.responseText,m=b;if("JSON"===g)try{m=v.JSON.parse(b)}catch(n){if("GET"===l){d('Invalid JSON ajax response, for "'+b+'"',a.ERROR_TYPE_AJAX_EXCEPTION);break a}}f(m,r.statusText,r);u.resolve(m);a.debug.addEntry("fetched",{response:m,request:c})}else d(r.responseText,a.ERROR_TYPE_AJAX_EXCEPTION)});r.ontimeout=a.guard(function(){d("Timeout occurred with the ajax request (default)",
a.ERROR_TYPE_AJAX_TIMEOUT)});a.utils.setTimeout(function(){r.open(l,k,!0);r.withCredentials=C(c.withCredentials);a.utils.each(n,function(a,c){r.setRequestHeader(c,a)});0<c.timeout&&(r.timeout=c.timeout);r.send(void 0===m?null:m);a.debug.addEntry("fetch",c)});return u.promise}function b(c,b,g){if(!a.utils.inArray(b,z(c).toUpperCase()))throw new x('Invalid ajax "'+g+'" argument, got "'+v.JSON.stringify(c)+'"');}var e=["JSON","TEXT"],h=["GET","POST","PUT","DELETE","PATCH"];return{ajax:f,get:function(c,
b){return f(a.utils.extend({},b,{url:c,method:"GET"}))},post:function(b,d){return f(a.utils.extend({},d,{url:b,method:"POST"}))}}}();a._jsonp=function(){var f={},b=0;return{request:function(e,h){if(a.utils.isString(e)&&a.utils.isFunction(h)){var c="req"+b++;e=a.utils.addQueryString(e,{callback:"frosmo.easy._jsonp._callbacks."+c});var d=a.domElements.addScriptTag(e,!1);f[c]=a.guard(function(a){h(a);f[c]=function(){};d.removeAttribute("src");d.parentNode&&d.parentNode.removeChild(d)})}},_callbacks:f}}();
v.JSON=function(){function f(){return ia.parse.apply(this,arguments)}return{parse:f,stringify:function(){return ia.stringify.apply(this,arguments)},safeParse:function(b,e,h){try{return f(b,h)}catch(c){a.console.warn("[JSON]",'Invalid type for "str" argument, got',b,c,h)}return e}}}();a.spa=function(){function f(c,d){if(d.hashchange)a.domEvents.on(window,"hashchange."+a.DOM_EVENT_NAMESPACE,a.spa.onHashChangeEvent);if(d.popstate)a.domEvents.on(window,"popstate."+a.DOM_EVENT_NAMESPACE,a.spa.onPopStateEvent);
d.pushstate&&Q&&Q.pushState&&(h=Q.pushState,b(d.checkInterval))}function b(d){Q.pushState!==e&&(void 0!==e&&d.updateRef&&(h=Q.pushState),Q.pushState=e=a.guard(a.spa.onPushState));0<d.delay&&(c=a.utils.setTimeout(function(){b(d)},d.delay))}var e,h,c=0,d,g=[];return{init:function(b){a.spa.isEnabled()&&(d=b,f(b,a.spa.getConfig()),a.ready(function(){a.events.on(a.EVENT_PAGE_CHANGED,a.spa.onPageChangeEvent)}))},clear:function(){a.domEvents.off(window,"hashchange."+a.DOM_EVENT_NAMESPACE,a.spa.onHashChangeEvent);
a.domEvents.off(window,"popstate."+a.DOM_EVENT_NAMESPACE,a.spa.onPopStateEvent);V(c);void 0!==h&&Q.pushState!==h&&(Q.pushState=h);a.events.off(a.EVENT_PAGE_CHANGED,a.spa.onPageChangeEvent);h=e=void 0;c=0;d=void 0},getConfig:function(){if(!a.config.singlePageSupport)return{hashchange:!1,popstate:!1,pushstate:!1,cancelPendingRequests:!1,clearEvents:[],checkInterval:{delay:1E3,updateRef:!1}};var b={hashchange:!0,popstate:!0,pushstate:!0,cancelPendingRequests:!1,clearEvents:[],checkInterval:{delay:1E3,
updateRef:!1}};if(a.utils.isObject(a.config.singlePageSupport))return a.utils.extend(b,a.config.singlePageSupport);a.deprecate('Data type of boolean for "easy.config.singlePageSupport"',"SinglePageConfig",function(){})();return b},isEnabled:function(){return C(a.config.singlePageSupport)},onPageChangeEvent:function(b,c){a.console.log("[spa]","URL changed, re-initializing",b);var d=a.spa.getConfig();a.events.clearEvent(a.EVENT_UID_CREATED);a.events.clearEvent(a.EVENT_VISIT);a.events.clearEvent(a.EVENT_URL_CHANGED);
a.utils.each(d.clearEvents,function(b){a.events.clearEvent(b)});a.message.clear();a.triggers.clear();a.segments.clear();a.smartDiscovery&&a.smartDiscovery.clear();a.strategies&&a.strategies.clear();var e=a.main.getCurrentBrowserData(),f=a.utils.extend({},R,{href:b});a.handleCurrentPage(f,e.href);a.events.clearEvent(a.EVENT_SCRIPT_LOAD);a.events.clearEvent(a.EVENT_DOM_READY);a.debug.clear();a.utils.each(g,function(a){a()});g=[];a.events.trigger(a.EVENT_SCRIPT_LOAD);a.events.trigger(a.EVENT_DOM_READY);
a.strategies&&a.strategies.init(a.config.strategies);a.triggers.init(a.config.triggers);a.states.init();a.internal.states(f.href);a.segments.init();a.quickMessage.requestMessages();a.config.requestMessages&&a.message.requestMessages({cancelPending:d.cancelPendingRequests});a.events.trigger(a.EVENT_URL_CHANGED,b,c)},onClear:function(b){a.utils.isFunction(b)?g.push(a.guard(b)):this._logSend('Invalid type for "fn" argument, got "'+a.utils.getType(b)+'" for "'+b+'". Expected function type',a.ERROR_TYPE_ARG_INVALID,
a.LOG_LEVEL_ERROR)},onHashChangeEvent:function(){var b=R.href;a.utils.getAbsoluteUrl(b)!==d&&a.spa.trigger(b)},onPopStateEvent:function(){a.spa.trigger(R.href)},onPushState:function(b,c,d){a.spa.trigger(d);return h.apply(Q,arguments)},trigger:function(b){b=a.utils.getAbsoluteUrl(b);a.events.trigger(a.EVENT_PAGE_CHANGED,b,d);d=b}}}();a.config={};a.init=function(f){a.main.setCurrentBrowserData(R.href,w.referrer);a.main.initStart();if(a.isDisabled())return a.console.warn("[init]","Frosmo Core is disabled"),
!1;a.internal.debug(R.href);f=a.utils.extend({},a.config,f);a.config=f;a.api.init(f.api.domain,f.api.origin,f.api.fcp);if(!a.checkRequirements(M.userAgent))return a.main.initFailure(void 0),!1;if(!a.versionAtLeast(a.MINIMUM_RULES_VERSION,a.VERSION_RULES))return a.main.initFailure('Invalid minimum "rules" version, expected '+a.MINIMUM_RULES_VERSION,a.ERROR_TYPE_VERSION_INVALID,{level:a.LOG_LEVEL_WARNING}),!1;a.events.trigger(a.EVENT_SCRIPT_LOAD);a.internal.dispatchEvent("frosmo.load");f.cookieDomain&&
a.cookies.setCookieDomain(f.cookieDomain);a.events.trigger(a.EVENT_EASY_CONFIG);a.sharedCode.init(f.sharedCode);a.domEvents.init();a.spa.init(R.href);a.smartDiscovery&&a.smartDiscovery.init(a.config.smartDiscoveryStrategies);a.strategies&&a.strategies.init(f.strategies);a.triggers.init(f.triggers);a.domElements.addStyles(a.styles);a.states.init();a.internal.states(R.href);a.message.init({positions:f.positions});if(f.requestMessages){var b=a.spa.getConfig();a.message.requestMessages({cancelPending:b.cancelPendingRequests})}f.dataLayer&&
a.ready(a.dataLayer.init);a.contextLoader.init(f,M.userAgent);a.events.once(a.EVENT_INIT_CONTEXT,function(b){if(b.origin!==f.api.origin)a.main.initFailure('Origin mismatch for local context, got "'+b.origin+'"',a.ERROR_TYPE_ORIGIN_MISMATCH,{level:a.LOG_LEVEL_ERROR,module:a.internal.getCurrentModule()});else a.events.once(a.EVENT_INIT_UID,function(){a.main.init(b,f,new B)})});a.quickMessage.init(f.quickMessages,M.userAgent);a.events.once(a.EVENT_INIT_QUICK_CONTEXT,function(b){a.quickMessage.requestMessages();
b.origin&&b.origin!==f.api.origin&&a.log.info('Origin mismatch for quick context, got "'+b.origin+'"',a.ERROR_TYPE_ORIGIN_MISMATCH,{module:a.internal.getCurrentModule()})});return!0};a.handleCurrentPage=function(f,b){a.main.updateBrowserData(window,function(){a.conversion.handle(w,"core_module",0)},f,b)};a.isDev=function(){return"dev"===a.ENV};a.isDisabled=function(){var f=a.utils.parseUri(R.href).queryKey.frosmo;"on"===f?a.cookies.remove("frosmo-off"):"off"===f&&a.cookies.set("frosmo-off",1);return C(a.cookies.get("frosmo-off"))};
a.isReady=function(){return a.events.isTriggered(a.EVENT_EASY_READY)};a.ready=function(f,b){if(a.utils.isFunction(f))a.events.once(a.EVENT_EASY_READY,f,b);return new a.Promise(function(e){a.events.once(a.EVENT_EASY_READY,e,b)})};(function(){function f(a){a._internalRejectionHandler=!0;return a}function b(c,d){function g(a,c,d){if(!f)return f=!0,d?b(a,c):a.reject(c)}if(c.promise===d)c.reject(new Y("A Promise's callback cannot return the same Promise instance"));else if(d instanceof a.Promise)d.then(function(a){return b(c,
a)},c.reject);else if(a.utils.isFunction(d)||a.utils.isObject(d)){var e;try{e=d.then}catch(k){c.reject(k);return}if(a.utils.isFunction(e)){var f=!1;try{e.call(d,function(a){return g(c,a,!0)},function(a){return g(c,a,!1)})}catch(k){g(c,k,!1)}}else c.resolve(d)}else c.resolve(d)}function e(b){g(function(){b._rejectionChecked||"rejected"!==b._state||b._suppressRejections||(d(b)?a.events.trigger(a.EVENT_PROMISE_REJECTION_HANDLED,b.value,b):(a.events.trigger(a.EVENT_PROMISE_UNHANDLED_REJECTION,b.value,
b),a.console.warn("[easy.Promise]","Uncaught (in Promise)",b.value,b)))});if("pending"!==b._state&&b._chains.length!==b._index)for(;b._index<b._chains.length;){var c=b._chains[b._index++];c.promise._suppressRejections=b._suppressRejections;var e="resolved"===b._state?c.onResolved:c.onRejected;e?g(h(c,b,e)):"resolved"===b._state?c.resolve(b.value):"rejected"===b._state&&(c.promise._isCancelled=b._isCancelled,c.reject(b.value))}}function h(a,c,d){return function(){try{b(a,d(c.value))}catch(g){a.reject(g)}}}
function c(a,b,c){var d=3===arguments.length;a._onCancel=function(a){void 0===a&&(a=new x("Promise was cancelled"));this._isCancelled=!0;g(function(){try{d&&c(),b(a)}catch(g){b(g)}})}}function d(b){if(b._rejectionChecked||b._hasRejectionHandler)return!0;b._rejectionChecked=!0;return a.utils.some(b._chains,function(a){return d(a.promise)})}function g(b){1===t.push(a.guard(b,u))&&r()}function l(){for(;0<t.length;)t.shift()()}var q=0,t=[],r=function(){var b=v.MutationObserver||v.WebKitMutationObserver||
b;if(!b)return function(){a.utils.setTimeout(l)};var c=0,d=w.createTextNode("");(new b(function(){a.runGuarded(l)})).observe(d,{characterData:!0});return function(){c=1-c;d.data=c}}(),u={onError:function(b){a.log.send(b,"promise."+a.ERROR_TYPE_EXCEPTION,{level:a.LOG_LEVEL_CRITICAL})}},k=!0;a.Promise=function(d,g){var k=this instanceof a.Promise;if(!k)throw new Y('"easy.Promise" cannot be called as a function. Use the "new" keyword to construct a new "Promise" object');if(!a.utils.isFunction(d))throw new Y('Invalid type for "executor" argument, got "'+
a.utils.getType(d)+'"');if(k&&("pending"===this._state||"resolved"===this._state))throw new Y('Invalid "this", cannot be a pending or resolved "Promise" object');this._id=++q;this._index=0;this._state="pending";this.value=void 0;this._chains=[];a.isDev()&&(this._executor=d,this._stackTrace=(new x).stack);var l={promise:this,onResolved:void 0,onRejected:void 0},h=this;l.resolve=function(a){"pending"===h._state&&(h._state="resolved",h.value=a,e(h))};l.reject=f(function(a){"pending"===h._state&&(h._state=
"rejected",h.value=a,e(h))});l.onCancel=function(a){c(h,l.reject,a)};this._isCancelled=!1;c(this,l.reject);this._suppressRejections=void 0===g?a.Promise.suppressRejections:C(g);this._rejectionChecked=this._hasRejectionHandler=!1;try{d(function(a){return b(l,a)},l.reject,l.onCancel)}catch(L){l.reject(L)}};a.Promise.prototype.then=function(b,c){var d={};d.promise=new this.constructor(function(a,b,c){d.resolve=a;d.reject=f(b);d.onCancel=c});d.onResolved=a.utils.isFunction(b)?b:void 0;var g=a.utils.isFunction(c);
d.promise._hasRejectionHandler=g&&!c._internalRejectionHandler;d.onRejected=g?c:void 0;this._chains.push(d);e(this);return d.promise};a.Promise.prototype.catch=function(a){return this.then(void 0,a)};a.Promise.prototype.finally=function(b){b=a.utils.isFunction(b)?b:function(){};var c=this;return c.then(function(a){return c.constructor.try(b).then(function(){return a})}).catch(f(function(a){return c.constructor.try(b).then(function(){throw a;})}))};a.Promise.all=function(b){var c=this;return new c(function(d,
g){f(g);if(a.utils.isArray(b)){var e=[],k=b.length;0===k?d(e):a.utils.each(b,function(a,b){c.resolve(a).then(function(a){e[b]=a;0===--k&&d(e)},g)})}else g(new Y('Invalid type for "iterable" argument, got "'+a.utils.getType(b)+'"'))})};a.Promise.race=function(b){var c=this;return new c(function(d,g){f(g);a.utils.isArray(b)?a.utils.each(b,function(a){c.resolve(a).then(d,g)}):g(new Y('Invalid type for "iterable" argument, got "'+a.utils.getType(b)+'"'))})};a.Promise.resolve=function(b){return a.utils.isObject(b)&&
b.constructor===this?b:new this(function(a){a(b)})};a.Promise.reject=function(a){return new this(function(b,c){c(a)})};a.Promise.try=function(a){return new this(function(b){b(a())})};a.Promise.withResolvers=function(){var a={};a.promise=new this(function(b,c,d){a.resolve=b;a.reject=c;a.onCancel=d});return a};a.Promise.prototype.isCancelled=function(){return this._isCancelled};a.Promise.prototype.cancel=function(a){"pending"!==this._state||this.isCancelled()||this._onCancel(a)};a.Promise.prototype.timeout=
function(b,c){1===arguments.length&&(c=a.internal.createLogError(new x("Promise timed out after "+b+" millisecond(s)"),a.ERROR_TYPE_TIMEOUT));var d=this,g;return d.constructor.race([d,new d.constructor(function(e,k){g=a.utils.setTimeout(function(){d.cancel(c);k(c)},b)})]).finally(function(){g&&(V(g),g=void 0)})};I.defineProperty(a.Promise,"suppressRejections",{get:function(){return k},set:function(b){if(!a.utils.isBoolean(b))throw new x('Invalid type for "suppressRejections" argument, got "'+a.utils.getType(b)+
'"');k=b}});a.Promise.hasRejectionHandler=function(b){if(!(b instanceof a.Promise))throw new x('Invalid type for "promise" argument, got "'+a.utils.getType(b)+'"');return b._hasRejectionHandler||a.utils.some(b._chains,function(b){return a.Promise.hasRejectionHandler(b.promise)})}})();a.console=function(){function f(b){var d=a.store.get("frosmo_debug_level")||a.LOG_LEVEL_WARN;return c[b]>=c[d]}function b(){return!0===h||!1===h?h:h=C(aa&&a.store.get("frosmo_debug"))}function e(c,e,h){if(b()&&f(c)){var t=
B.now();d=d||t;t-=d;e=a.utils.arrayFrom(e);var r=e[0];a.utils.isString(r)&&0===r.search(/^\[.*\]$/)?(r=r.substring(1,r.length-1),e.shift(),t=t+": FROSMO ["+r+"] "+c+"::"):t=t+": FROSMO "+c+"::";c=h||c;aa[c]?(e.unshift(t),aa[c].apply(aa,e)):aa.log(t,1===e.length?e[0]:e)}}var h,c={critical:4,error:4,log:3,warn:2,warning:2,info:1,debug:0},d;return{debug:function(){e(a.LOG_LEVEL_DEBUG,arguments,a.LOG_LEVEL_INFO)},error:function(){e(a.LOG_LEVEL_ERROR,arguments)},info:function(){e(a.LOG_LEVEL_INFO,arguments)},
log:function(){e(a.LOG_LEVEL_LOG,arguments)},warn:function(){e(a.LOG_LEVEL_WARN,arguments)},isActiveLevel:f,isEnabled:b,setEnabled:function(b){h=C(b);a.store.set("frosmo_debug",h)},setLevel:function(b){if(!a.utils.isNumber(c[b]))throw new x('Invalid console "level" argument, got  "'+b+'"');a.store.set("frosmo_debug_level",b)}}}();a.domEvents=function(){function f(b){if(a.utils.isString(b))b=[b];else if(!a.utils.isArray(b))throw new x('Invalid type for DOM "eventNamespace" argument, got "'+a.utils.getType(b)+
'" for "'+b+'"');a.utils.each(d(b),function(b,c){a.utils.each(b,function(a){h(a,a.el)});l[c]=[]})}function b(a,b,c,d,g,f){e("once",a,b,c,d,g,f)}function e(b,d,g,e,k,f,n){var p=z(g).split(".")[0];if(!a.utils.isString(p)||0===p.length)throw new x('Invalid type for DOM "eventNamespace" argument, got "'+a.utils.getType(g)+'" for "'+g+'"');a.utils.isFunction(e)&&(n=f,f=k,k=e,e=void 0);f=f||this;a.utils.isBoolean(n)||a.utils.isObject(n)||(n=!1);a.utils.each(c(d),function(c){var d={type:b,el:c,domEvent:p,
selector:e,origFn:k,fn:a.guard(function(b){a:{var c=d,g=f;if(!c.handled||"once"!==c.type)if(c.selector)for(var e=b.target,k=a.domElements.selector(c.selector,c.el);e&&c.el!==e&&e.nodeType!==S.DOCUMENT_NODE;){if(a.utils.inArray(k,e)){c.handled=!0;c.origFn.call(g,b,e);break a}e=e.parentNode}else c.handled=!0,c.origFn.call(g,b,c.el)}}),options:n,handled:!1};l[g]=l[g]||[];l[g].push(d);c.addEventListener(p,d.fn,n)})}function h(a,b,c,d){return!b.removeEventListener||b!==a.el||d&&d!==a.origFn||c&&c!==a.selector?
!1:(b.removeEventListener(a.domEvent,a.fn,a.options),!0)}function c(b){if(a.utils.isString(b))return a.domElements.selector(b);b=a.utils.isArray(b)?b:[b];return a.utils.filter(b,function(b){return b&&a.utils.isFunction(b.addEventListener)})}function d(b){var c=/^\*\./,d={};a.utils.each(l,function(g,e){a.utils.some(b,function(b){b=c.test(b)?".*\\."+a.utils.escapeRegExp(b.replace(c,"")):a.utils.escapeRegExp(b);return(new N("^"+b+"(\\.|$)")).test(e)})&&(d[e]=g)});return d}function g(){a.events.isTriggered(a.EVENT_DOM_READY)||
a.events.trigger(a.EVENT_DOM_READY)}var l={};return{init:function(){"loading"===w.readyState?(b(w,"DOMContentLoaded."+a.DOM_EVENT_NAMESPACE,g),b(window,"load."+a.DOM_EVENT_NAMESPACE,g)):g();a.utils.waitFor(10,a.JQUERY_INIT_TIMEOUT,function(){return C(window.jQuery)}).then(function(){a.events.trigger(a.EVENT_JQUERY_READY,window.jQuery)}).catch(function(){a.events.trigger(a.ERROR_SITE_JQUERY_MISSING)})},clear:f,fire:function(a,b){var c=w.createEvent("HTMLEvents");c.initEvent(b,!0,!0);return!a.dispatchEvent(c)},
off:function(b,g,e,f){var k=c(b);a.utils.isFunction(e)&&(f=e,e=void 0);a.utils.each(d([g]),function(b,c){a.utils.each(k,function(d){l[c]=a.utils.filter(b,function(a){return!h(a,d,e,f)})})})},on:function(a,b,c,d,g,f){e("on",a,b,c,d,g,f)},once:b,ready:function(b,c){if(a.utils.isFunction(b))a.events.once(a.EVENT_DOM_READY,b,c);return new a.Promise(function(b){a.events.once(a.EVENT_DOM_READY,b,c)})},_testClear:function(){f(a.utils.keys(l))}}}();a.domElements=function(){function f(a,b,c,d){var g=w.createElement("script");
b?g.text=a:g.src=a;g.async=!0;return k(g,c,!1,d)}function b(b,c){a.utils.isString(c)&&c.length&&(b="/**"+c+"**/\n"+b+"\n/**"+c+"**/\n");g(a.utils.trim(y+" "+b))}function e(a){return a&&p(a)?a.getBoundingClientRect():{}}function h(a){var b=e(a);a=l(a);return 300<b.width||300<b.height?.75<=a.visible||.75<=a.possible:1===a.visible}function c(a){var b=e(a);return"none"!==a.style.display&&"hidden"!==a.style.visibility&&(0<b.width||0<b.height)}function d(b,c,d){c=c||w;d=!1!==d;var g=a.events.isTriggered(a.EVENT_JQUERY_READY)&&
window.jQuery;try{return d&&g?a.utils.arrayFrom(window.jQuery(b,c)):a.sizzle?a.sizzle(b,c):a.utils.arrayFrom(c.querySelectorAll(b))}catch(e){a.log.error(e,a.ERROR_TYPE_SELECTOR_INVALID,{debug:d&&!g?'jQuery not found for selector of "'+b+'"':"Invalid "+(d?"jQuery":"CSS")+' selector of "'+b+'"'})}return[]}function g(a){D||(D=w.createElement("style"),D.id="f3-style");y=D.innerHTML=a;d("#f3-style")[0]||w.head.appendChild(D)}function l(b){var c={possible:1,visible:1},d=w.documentElement.clientHeight,g=
w.documentElement.clientWidth,f=e(b);if(0<=f.top&&0<=f.left&&f.bottom<=d&&f.right<=g)return c;if(!w.body)throw a.internal.createLogError("Body not found",a.ERROR_TYPE_SELECTOR_INVALID,{module:a.internal.getCurrentModule()});var k=w.body.scrollLeft,p=w.body.scrollTop;b=n(f.left+k,f.top+p,b.offsetWidth,b.offsetHeight);d=n(k,p,g,d);g=F.max(b.left,d.left);k=F.min(b.right,d.right);p=F.max(b.top,d.top);p=F.min(b.bottom,d.bottom)-p;g=k-g;g=0<=g&&0<=p?g*p:0;d=g/(F.min(b.width,d.width)*F.min(b.height,d.height));
b=g/(b.width*b.height);c.possible=d||0;c.visible=b||0;return c}function q(b,c,d,g){function e(){f&&(f.disconnect(),f=void 0);k&&(V(k),k=void 0)}var f,k;g(e);g=a.guard(function(){r(b,c,e)});var p=v.MutationObserver||v.WebKitMutationObserver||p;f=new p(g);f.observe(w.documentElement,{attributes:!1,characterData:!1,childList:!0,subtree:!0});0<b.timeout&&(k=a.utils.setTimeout(function(){u(b,d,e)},b.timeout));g()}function t(b,c,d,g){var e=a.utils.waitFor(b.interval,b.timeout,function(){return r(b,c)},
function(){u(b,d)});g(function(){e.cancel()})}function r(a,b,c){var g=d(a.selector,a.context);if(0===g.length)return!1;c&&c();b(g);a.success(g);return!0}function u(b,c,d){d&&d();d=a.internal.createLogError(new x("Timed out after "+b.timeout+' millisecond(s), for the selector "'+b.selector+'"'),a.ERROR_TYPE_TIMEOUT);c(d);b.failure(d)}function k(b,c,d,g){c=a.utils.isFunction(c)?c:function(){};if(d)c(b);else a.domEvents.once(b,"load."+a.DOM_EVENT_NAMESPACE,function(){c(b)});(g||w.head).appendChild(b);
return b}function m(b){b=a.utils.isArray(b)?b:[b];return a.utils.filter(b,function(a){return a&&a.nodeType===S.ELEMENT_NODE})}function n(a,b,c,d){a=F.round(a)||0;b=F.round(b)||0;c=F.round(c)||0;d=F.round(d)||0;return{left:a,top:b,width:c,height:d,right:a+c,bottom:b+d}}function p(a){for(var b=0;a;)b=a.nodeType,a=a.parentNode;return b===S.DOCUMENT_NODE}function J(a,b){var c=b.join("|"),d=new N("<\\s*("+c+")\\b[^>]*>([\\s\\S]*?)<\\/(?:"+c+")>","gim"),g=new N("^<\\s*(?:"+c+")[^>]+src=([\\'\"])(.*?)\\1"),
e=[];a=a.replace(d,function(a,b,c){a=a.match(g);e.push({name:b,srcAttr:a?a[2]:"",content:c});return""});return[a,e]}function E(c,d){var g=0;a.utils.each(c,function(c){switch(c.name){case "script":c.srcAttr&&c.content&&a.console.warn('Invalid "script" tag, both "src" and "content" have been defined. Info:',d.guardOptions);c.srcAttr?(c=f(c.srcAttr),d.scriptNamespace&&a.utils.addClassName(c,d.scriptNamespace)):c.content&&(a.internal.safeEval(c.content,d,g),g+=1);break;case "style":b(c.content,d.styleNamespace)}})}
function L(b){return b.getClientRects?a.utils.every(b.getClientRects(),function(a){for(a=w.elementFromPoint((a.left+a.right)/2,(a.top+a.bottom)/2);a&&a.parentNode&&a.nodeType===S.ELEMENT_NODE;){if(a===b)return!0;a=a.parentNode}return!1}):!1}var D=null,y="";return{addScriptTag:f,addStyleTag:function(a,b,c,d){var g=w.createElement(b?"style":"link");b?g.innerHTML=a:(g.href=a,g.rel="stylesheet",g.type="text/css");return k(g,c,b,d)},addStyles:b,getBoundingClientRect:e,getCssStyles:function(){return y},
getStylesElement:function(){return D},html:function(b,c,d){b=m(b);if(void 0===c)return b.length?b[0].innerHTML:void 0;if(!a.utils.isString(c))throw new x('Invalid type for "htmlString" argument, got "'+a.utils.getType(c)+'"');c=J(c,["script","style"]);var g=c[0];a.utils.each(b,function(a){a.innerHTML=g});d=a.utils.extend({args:{},guardOptions:{},scriptNamespace:void 0,styleNamespace:void 0},d);E(c[1],d)},isInViewPort:h,isSelector:function(a){try{return w.querySelector(a),!0}catch(b){}return!1},isStyleVisible:c,
isVisible:function(b){if(!b)return a.console.warn("[domElements]",'Invalid argument, "el" was not an element node for checking visibility'),!1;var d=h(b),g=c(b);b=L(b);return d&&g&&b},matches:function(b,c,d){d=d||b.ownerDocument||w;c=a.domElements.selector(c,d);return a.utils.inArray(c,b)},removeStyles:function(b,c){if(D){b=a.utils.isString(b)?b:"";c=a.utils.isString(c)?c:"";var d=(c=a.utils.escapeRegExp(c))?"\\s*\\/\\*\\*"+c+"\\*\\*\\/\\s*":"\\s*";b=a.utils.escapeRegExp(b).replace(/"|'/g,"(\"|')");
d=new N(d+(b?b+"(\\s*)\\{[^\\{\\}]*\\}":"[\\s\\S]*")+d,"gi");d=y.replace(d,"\n").replace(/\n+/g,"\n");g(a.utils.trim(d))}},removeStylesElement:function(){D&&(D.parentNode.removeChild(D),D=null,y="")},selector:d,updateStylesElement:g,visible:l,visibility:function(a){var b;if(!(b=!p(a))){a:{for(b=a;b&&b.nodeType!==S.DOCUMENT_NODE;){var c=pa(b);if("0"===c.opacity||"none"===c.display||"hidden"===c.visibility){b=!1;break a}b=b.parentNode}b=!0}b=!b}if(b)return 0;b=w.documentElement.clientHeight;var c=w.documentElement.clientWidth,
d=e(a);return 0>d.bottom||0>d.right||d.top>b||d.left>c||0===d.height||0===d.width?0:l(a).visible},waitFor:function(b){return new a.Promise(function(c,d,g){var e={selector:b.selector,context:b.context,success:a.utils.isFunction(b.success)?b.success:function(){},failure:a.utils.isFunction(b.failure)?b.failure:function(){},interval:K(b.interval)||100,timeout:a.utils.isNumeric(b.timeout)?K(b.timeout):5E3},f=v.MutationObserver||v.WebKitMutationObserver||f;f?q(e,c,d,g):t(e,c,d,g)})}}}();(function(){a.storage=
function(f){if(!(this instanceof a.storage))throw new x('"easy.storage" cannot be called as a function. Use the "new" keyword to construct a new "Storage" object');this._storage=f&&f.clear&&f.getItem&&f.removeItem&&f.setItem?f:null};a.storage.prototype={get length(){return this.exists()?H(this._storage.length):0},set length(a){}};a.storage.prototype.clear=function(){if(this.exists())try{this._storage.clear()}catch(a){}};a.storage.prototype.exists=function(){return C(this._storage)};a.storage.prototype.get=
function(f,b){if(!this.exists())return null;var e="__frosmoeasy__"+f,h;try{h=this._storage.getItem(e)}catch(c){throw a.internal.createLogError(c,a.ERROR_TYPE_STORAGE_EXCEPTION,{level:a.LOG_LEVEL_WARNING,module:a.internal.getCurrentModule()});}if(h=h?v.JSON.safeParse(h):void 0)return h.data;this.remove(e);return b};a.storage.prototype.remove=function(a){this.exists()&&this._storage.removeItem("__frosmoeasy__"+a)};a.storage.prototype.set=function(f,b){if(this.exists())try{this._storage.setItem("__frosmoeasy__"+
f,v.JSON.stringify({data:b}))}catch(e){throw a.internal.createLogError(e,a.ERROR_TYPE_STORAGE_EXCEPTION,{level:a.LOG_LEVEL_WARNING,module:a.internal.getCurrentModule()});}}})();a.store=new a.storage(fa);a.store.check=function(){if(this.exists())try{return this.set("_(test_key)",1),this.remove("_(test_key)"),!0}catch(a){}return!1};a.utils=function(){function f(a,b,c){var d=!0;G(a,function(a,g,e){return b.call(c,a,g,e)?!0:d=!1},c,0,!0);return d}function b(a,b,c){var d=[];G(a,function(a,g,e){b.call(c,
a,g,e)&&d.push(a)});return d}function e(a){return h(a,function(a,b){return z(b)})}function h(a,b,c){var d=[];G(a,function(a,g,e){d.push(b.call(c,a,g,e))});return d}function c(a){return h(a,function(a){return a})}function d(a){return ba.isArray(a)}function g(a){return"date"===D(a)}function l(a){return t(a)?!0:ga(a)||m(a)?0===a.length:0===e(a).length}function q(a){return"function"===typeof a||"function"===D(a)}function t(a){return null===a||void 0===a}function r(a){return"number"===typeof a||"number"===
D(a)}function u(a){return(r(a)||m(a))&&!sa(a-K(a))}function k(a){return I(a)===a}function m(a){return"string"===typeof a||"string"===D(a)}function n(a,b){if(!k(a))return a;b=p({complex:!0,function:!1,node:!1,regexp:!1},b);var c=D(a);switch(c){case "array":return h(a,function(a){return n(a,b)});case "date":return new B(a.getTime());case "function":if(b.function)return function(){return a.apply(this,arguments)};break;case "regexp":if(b.regexp)return c=a.toString().match(/[gimuy]*$/)[0],new N(a.source,
c);break;default:if(ha(a))return b.node&&a.cloneNode?a.cloneNode(!0):a}if("object"!==c&&!b.complex)return a;var d={};G(a,function(a,c){d[c]=n(a,b)});return d}function p(a){G(arguments,function(b){G(b,function(b,c){a[c]=b})},void 0,1);return a}function J(a){var b={anchor:"",host:"",params:{},path:"",queryVariables:{}};if(t(a)||0===z(a).length)return b;a=E(a);if(a.anchor)try{b.anchor=X(a.anchor)}catch(c){b.anchor=a.anchor}b.host=a.host;G(a.queryKey,function(a,c){try{c=X(c),a=X(a),b.params[c]=a}catch(d){b.params[c]=
a}});try{b.path=X(a.path)}catch(c){b.path=a.path}b.queryVariables=a.queryKey;return b}function E(a){a=Aa(a);var b=14,c={};for(a=Z.parser[Z.strictMode?"strict":"loose"].exec(a);0<b-1;)--b,c[Z.key[b]]=a[b]||"";c[Z.queryKey.name]={};c[Z.key[12]].replace(Z.queryKey.parser,function(a,b,d){b&&(c[Z.queryKey.name][b]=d)});return c}function L(a){return ha(a)&&(a=a.getAttribute("class"))?a.match(/[^\x20\t\r\n\f]+/g)||[]:[]}function D(a){return I.prototype.toString.call(a).replace(/^\[object (.*?)\]$/,"$1").toLowerCase()}
function y(b){var c=a.context?a.context.userAgent:M.userAgent;switch(b){case "android":return a.DEVICE_REGEXP_ANDROIDMOBILE.test(c)&&!y("windowsphone");case "ios":return a.DEVICE_REGEXP_IOS.test(c)&&!y("windowsphone");case "othermobile":return a.DEVICE_REGEXP_OTHERMOBILE.test(c)&&!y("android")&&!y("ios")&&!y("windowsphone");case "androidtablet":return a.DEVICE_REGEXP_ANDROIDTABLET.test(c);case "ipad":return a.DEVICE_REGEXP_IPAD.test(c);case "othertablet":return a.DEVICE_REGEXP_OTHERTABLET.test(c)&&
!y("androidtablet")&&!y("windowstablet");case "windowsphone":return a.DEVICE_REGEXP_WINDOWSPHONE.test(c);case "windowstablet":return a.DEVICE_REGEXP_WINDOWSTABLET.test(c)&&!y("windowsphone");case "desktop":return!y("android")&&!y("ios")&&!y("windowsphone")&&!y("othermobile")&&!y("androidtablet")&&!y("ipad")&&!y("windowstablet")&&!y("othertablet");default:throw new x('Invalid "deviceType" argument, got "'+b+'"');}}function A(b,c){return va(a.guard(b),c)}function v(a,b){return-1!==O(a,b)}function O(a,
b,c){if(ga(a))for(c=P(c,10)||0,c=F.max(0<=c?c:a.length-F.abs(c),0);c<a.length;c++)if(b===a[c])return c;return-1}function ya(){var a=[];G(arguments,function(b){G(b,function(b){v(a,b)||a.push(b)})});return a}function C(a){var b=/([\].|*?+(){}^$\\:=[])/g;return m(a)?a.replace(b,"\\$&"):a}function la(a,b,c){var d=0<=c;c=F.abs(c);a=z(a);if(0===a.length||a.length>=c)return a;b=z(b);if(0===b.length)return a;c-=a.length;var g=F.ceil(c/b.length)+1;b=ba(g).join(b).slice(0,c);return d?b+a:a+b}function ca(a,
b){if(!m(a))return a;b=m(b)?C(b):"\\s\\uFEFF\\xA0";return a.replace(new N("^["+b+"]+|["+b+"]+$","g"),"")}function G(a,b,c,d,g){if(ga(a))for(d=d||0;d<a.length&&(!1!==b.call(c,a[d],d,a)||!g);d++);else if(a)for(var e in a)if(I.prototype.hasOwnProperty.call(a,e)&&!1===b.call(c,a[e],e,a)&&g)break}function ma(a){m(a)?a=ca(a).split(" "):d(a)||(a=void 0);return a}function za(a){return a=ha(a)?[a]:b(a,ha)}function ga(a){return a&&r(a.length)&&0<=a.length&&9007199254740991>=a.length}function ha(a){return a&&
a.nodeType===S.ELEMENT_NODE}function Aa(a){if(!a)return a;var b=[[/\?&/g,"?"],[/@/,W("@")]];G(b,function(b){a=a.replace(b[0],b[1])});return a}var Z={strictMode:!1,key:"source protocol authority userInfo user password host port relative path directory file query anchor".split(" "),queryKey:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:/?#]*)(?::(\d*))?))?((((?:[^?#/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@/]*@)([^:/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#/]*\.[^?#/.]+(?:[?#]|$)))*\/?)?([^?#/]*))(?:\?([^#]*))?(?:#(.*))?)/}};
return{each:function(a,b,c){G(a,b,c)},entries:function(a){return h(a,function(a,b){return[b,a]})},every:f,filter:b,find:function(a,b,c){var d;G(a,function(a,g,e){return b.call(c,a,g,e)?(d=a,!1):!0},c,0,!0);return d},findIndex:function(a,b,c){var d=-1;G(a,function(a,g,e){return b.call(c,a,g,e)?(d=g,!1):!0},c,0,!0);return d},keys:e,map:h,reduce:function(a,b,c,d){var g=3<=arguments.length;G(a,function(a,e,f){g?c=b.call(d,c,a,e,f):(g=!0,c=a)});return c},some:function(a,b,c){var d=!1;G(a,function(a,g,
e){return b.call(c,a,g,e)?(d=!0,!1):!0},c,0,!0);return d},values:c,isArray:d,isBoolean:function(a){return"boolean"===typeof a||"boolean"===D(a)},isDate:g,isEmpty:l,isFunction:q,isInteger:function(a){return r(a)&&ra(a)&&F.floor(a)===a},isNil:t,isNumber:r,isNumeric:u,isObject:k,isPlainObject:function(a){if(!k(a))return!1;a=I.getPrototypeOf(I(a));if(null===a)return!0;a=I.prototype.hasOwnProperty.call(a,"constructor")&&a.constructor;return q(a)&&a instanceof a&&ea.prototype.toString.call(a)===ea.prototype.toString.call(I)},
isPositiveInteger:function(a){var b=~~H(a);return z(b)===a&&0<b},isString:m,arrayFrom:function(a,b,d){return ga(a)?q(b)?h(a,b,d):c(a):[]},clone:n,extend:p,addQueryString:function(b,c){c=h(c,function(d,g){k(d)&&a.console.error("[utils]",'Invalid type for "params" value. Arrays/Objects should be serialized.',d,g,b,c);return W(g)+"="+W(d)});if(0===c.length)return b;var d=/\?/.test(b)?"&":"?";return b+d+c.join("&")},getAbsoluteUrl:function(a){var b=w.createElement("a");b.href=a;return b.href},getLocationFromUrl:J,
matchStringUrls:function(b,c,d){if(/^\//.test(c)){var g=a.main.getCurrentBrowserData().href;c=(g?J(g).host:"")+c}c=J(c);var e={};G(c.queryVariables,function(a,b){e[b]=["matchExact",a]});var g={anchor:c.anchor,matcher:"matchExact"},f=/^www\./;d=J(d);return c.host.toLowerCase().replace(f,"")===d.host.toLowerCase().replace(f,"")&&a.evaluator.matchUrl(b,c.path,e,g,d)},parseUri:E,getDateFromContextFormat:function(a){if(!m(a)||8!==a.length)throw new x('Invalid length for "str" argument, got "'+a+'"');var b=
P(a.substring(0,4),10),c=P(a.substring(4,6),10)-1;a=P(a.substring(6,8),10);return new B(b,c,a,0,0,0,0)},getDateInContextFormat:function(b){if(!g(b))throw a.internal.createLogError('Invalid type for "date" argument, got "'+a.utils.getType(b)+'" for "'+b+'"',a.ERROR_TYPE_ARG_INVALID,{level:a.LOG_LEVEL_WARNING});var c=b.getFullYear(),d=la(b.getMonth()+1,"0",2);b=la(b.getDate(),"0",2);return z(c)+z(d)+z(b)},addClassName:function(a,b){G(za(a),function(a){var c=ya(L(a),ma(b));a.setAttribute("class",c.join(" "))})},
getClassNames:L,hasClassName:function(a,b){var c=L(a);return f(ma(b),function(a){return v(c,a)})},removeClassName:function(a,c){c=ma(c);G(za(a),function(a){var d=b(L(a),function(a){return!v(c,a)});a.setAttribute("class",d.join(" "))})},getIEVersion:function(a,b){var c=new N(b?"(?:MSIE|Trident.*rv|Edge)[ :/]([0-9]+)":"(?:MSIE|Trident.*rv)[ :]([0-9]+)","i");return(c=a.match(c))?P(c[1],10):-1},getByDotString:function(a,b,c){b=b||window;c=p({empty:!0,nonObjects:!0,self:!0},c);var d;"window"===a?d=window:
(a=a.replace(/^\bwindow\b\.?/,""),d=b,G(a.split("."),function(a){d=d&&I.prototype.hasOwnProperty.call(d,a)?d[a]:void 0}));return c.empty&&l(d)||c.self&&d===b||c.nonObjects&&!k(d)?void 0:d},getTimestamp:function(a){a=g(a)?a:new B;return F.round(a.getTime()/1E3)},getType:D,isDesktop:function(){return y("desktop")},isDevice:y,isMobile:function(){return y("android")||y("ios")||y("othermobile")||y("windowsphone")},isTablet:function(){return y("androidtablet")||y("ipad")||y("othertablet")||y("windowstablet")},
setInterval:function(b,c){(!u(c)||0>=c)&&a.log.error("Invalid interval delay argument, got "+c,a.ERROR_TYPE_ARG_INVALID);return ua(a.guard(b),c)},setTimeout:A,waitFor:function(b,c,d,g){function e(){n=!0;h&&(V(h),h=void 0)}function f(a,b){try{return a(b)}catch(c){throw k(c),m.reject(c),c;}}function k(a){l&&(l=!1,g(a))}function p(){if(!n)if(f(d,m))m.resolve();else if(J&&B.now()>=L){var g=a.internal.createLogError(new x("Timed out after "+c+" millisecond(s)"),a.ERROR_TYPE_TIMEOUT);f(k,g);m.reject(g)}else h=
A(p,b)}var n=!1,l=q(g),h,m=a.Promise.withResolvers(),D=m.resolve;m.resolve=function(){var a=arguments;e();D.apply(null,a)};var E=m.reject;m.reject=function(){var a=arguments;e();E.apply(null,a)};m.onCancel(e);c=K(c);var J=0!==c,L=J?B.now()+c:c;a.runGuarded(p,void 0,{type:a.ERROR_TYPE_TIMEOUT});return m.promise},inArray:v,indexOf:O,uniq:ya,escapeRegExp:C,pad:la,subs:function(a,b,c){if(b.length!==c.length)throw new x('Invalid lengths for "set1" and "set2" arguments, got '+b.length+" and "+c.length);
G(b,function(b,d){a=a.replace(new N(b,"g"),c[d])});return a},trim:ca,trimInside:function(a){var b=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,c=/\s+/g;return m(a)?a.replace(b,"").replace(c," "):a}}}();a.states=function(){function f(b){delete c[b];a.ready(function(){void 0!==a.context.states.session[b]&&(delete c[b],delete a.context.states.session[b],a.context.save())});a.events.trigger(a.EVENT_STATE_REMOVE,b)}function b(b,g,e){c[b]=g;e===a.STATE_TYPE_SESSION&&a.ready(function(){c[b]=g;a.context.states.session[b]=
g;a.context.save()});a.events.trigger(a.EVENT_STATE_SET,b,g,e)}function e(){a.utils.each(a.context.states.session,function(a,b){f(b)})}function h(c){a.utils.each(c.states.session,function(a,c){b(c,a)})}var c={};return{init:function(){c={};a.events.once(a.EVENT_INIT_CONTEXT,h);a.events.once(a.EVENT_INIT_QUICK_CONTEXT,h);a.events.on(a.EVENT_VISIT,e)},get:function(a){return c[a]},getAll:function(){var b={};a.utils.each(c,function(a,c){b[c]=z(a)});return b},remove:f,set:b}}();a.cookies=function(){function f(a){try{a+=
"=";for(var b=w.cookie.split(";"),c=0;c<b.length;c++){var e=b[c].replace(/^\s*/,"");if(0===e.indexOf(a))return ja(e.substring(a.length,e.length))}}catch(f){}return null}function b(b,g,f){if(c){var q="";f&&(q=new B,f*=864E5,q.setTime(q.getTime()+f),q="; expires="+q.toGMTString());try{w.cookie=da(b)+"="+da(g)+q+e+"; path="+h,w.cookie.length>a.COOKIE_MAX_SIZE&&a.log.warn("Cookie size of "+w.cookie.length+", limit is "+a.COOKIE_MAX_SIZE,a.ERROR_TYPE_COOKIE_LONG,{module:a.internal.getCurrentModule()})}catch(t){throw a.internal.createLogError(t,
a.ERROR_TYPE_STORAGE_EXCEPTION,{level:a.LOG_LEVEL_ERROR,module:a.internal.getCurrentModule()});}}}var e="",h="/",c=!0;return{check:function(){try{return 0<=w.cookie.split(";").length}catch(a){}return!1},exists:function(a){return null!==f(a)},get:f,isEnabled:function(){return c},remove:function(a){b(a,"",-1)},set:b,setCookieDomain:function(a){e=/\.[a-z]+$/.test(a)?";domain="+da(a):""},setCookiePath:function(b){if(0<arguments.length&&!a.utils.isString(b))throw new x('Invalid type for cookie "path" argument, got "'+
a.utils.getType(b)+'" for "'+b+'"');h=b||"/"},setEnabled:function(a){c=C(a)}}}();a.debug=function(){var f,b,e=[],h,c;return{addEntry:function(b,g){var l;!0!==c&&!1!==c&&(c=a.isDev()||a.utils.isObject(window.frosmoExtensions)||a.preview.isLoadable());l=c;l&&(l=B.now(),h=h||l,l=[b,l-h,g,a.guard.current()],e.push(l),f&&f(l))},clear:function(){e=[];h=void 0;b&&b()},getAll:function(){return a.utils.arrayFrom(e)},setCallbacks:function(a,c){f=a;b=c}}}();a.log=function(){function f(f,c,d){var g=a.api.getApiUrl("error"),
l=a.api.getOrigin();if(g&&l){var q=f instanceof x;if(!a.utils.isString(f)&&!q)throw new x('Invalid type for logging "data" argument, got "'+a.utils.getType(f)+'" for "'+f+'"');if(!a.utils.isNumber(c)&&!a.utils.isString(c))throw new x('Invalid type for logging "type" argument, got "'+a.utils.getType(c)+'" for "'+c+'"');if(!d||!d.level||!a.utils.isString(d.level))throw new x('Invalid type for logging "options" argument or "level" property, got "'+a.utils.getType(d)+'" for "'+d+'"');var t=e(d);if(q||
void 0===d.trace)q=void 0===f.stack?(new x).stack:f.stack,t.trace=a.internal.truncate(z(q),a.MAXIMUM_TRACE_LENGTH);d=b(l,f,c,d.level,t);q=a.utils.addQueryString(g,d);q.length>a.MAXIMUM_URL_LENGTH&&(f="URL limit of "+a.MAXIMUM_URL_LENGTH+' exceeded. URL: "'+W(a.internal.truncate(q,1E3))+'"',c=a.ERROR_TYPE_URL_LONG,d=b(l,f,c,a.LOG_LEVEL_ERROR,t),q=a.utils.addQueryString(g,d));a.internal.send(q);g=a.console[d.level]||a.console.log;switch(d.level){case a.LOG_LEVEL_CRITICAL:g=a.console.error;break;case a.LOG_LEVEL_WARNING:g=
a.console.warn}g("[log]","Data:",f,",","Type:",c,",","Info:",d)}else a.console.warn("[log]","easy.api has not been initialized")}function b(b,c,d,g,e){b=a.utils.extend({},e,{message:z(c),errorType:d,level:g,url:a.main.getCurrentBrowserData().href||R.href,userAgent:M.userAgent,origin:b,cookieId:a.uid.get(),ver:a.getVersion(),customScriptUpdatedAt:a.CUSTOM_SCRIPT_UPDATED_AT});c.name&&(b.name=c.name);c=a.internal.getWorkspaceId();0<c&&(b.workspaceId=c);return b}function e(b){var c={html:[a.utils.isString,
z],trace:[a.utils.isString,z],module:[a.utils.isString,z],modules:[a.utils.isString,z],sharedCodeId:[a.utils.isNumeric,H],messageId:[a.utils.isNumeric,H],revisionId:[a.utils.isNumeric,H],positionId:[a.utils.isNumeric,H],rendererName:[a.utils.isString,z],segmentId:[a.utils.isString,z],templateId:[a.utils.isString,z],triggerId:[a.utils.isNumeric,H],scriptId:[a.utils.isNumeric,H],debug:[a.utils.isString,z]},d=a.guard.current(),g={};a.utils.each(c,function(c,e){var f=void 0!==b[e]?b[e]:d[e];if(void 0!==
f){if(!(0,c[0])(f))throw new x('Invalid type for logging "'+e+'" property, got "'+a.utils.getType(f)+'" for "'+f+'"');g[e]=(0,c[1])(f)}});return g}return{error:function(b,c,d){return f(b,c,a.utils.extend({},d,{level:a.LOG_LEVEL_ERROR}))},info:function(b,c,d){return f(b,c,a.utils.extend({},d,{level:a.LOG_LEVEL_INFO}))},warn:function(b,c,d){return f(b,c,a.utils.extend({},d,{level:a.LOG_LEVEL_WARNING}))},send:f}}();a.evaluator=function(){function f(a){return null===a?null:""===a?"/":"/"!==a?a.replace(/\/$/,
""):a}function b(a,b,c){c&&(a=a.toLowerCase(),b=b.toLowerCase());return b&&0<=b.toLowerCase().indexOf(a.toLowerCase())}function e(a,b,c){var d="";c&&(d+="i");return(new N(a,d)).test(b)}function h(a){return(a=z[a])?a:!1}function c(a){for(var b in z)if(z.hasOwnProperty(b)&&a===z[b])return b;return!1}function d(b){for(var c,d=0,g=0;g<b.length;g+=1)c=a.utils.getDateFromContextFormat(b[g]),c>=y&&(d+=1);return d}function g(b,c){function d(b){var g=[],f,k;f=c[b.keyType];if(f.hasOwnProperty(b.keyValue))for(e=
a.evaluator.getMatcherFunction(b.match),k=f[b.keyValue],f=0;f<k.length;f+=1)g.push(e(b.content,k[f]));else g.push(!1);return C.or.apply(this,g)}var g=!1,e,g=[],f=[];switch(b[0]){case "and":f=C.and;break;default:return!1}for(var k=1;k<b.length;k+=1)g.push(d(b[k]));return g=f.apply(this,g)}function l(b){if(!a.utils.isArray(b)||0===b.length)throw x("ruleEvaluator expects an array, given:"+b);var c=b[0];b=b.slice(1,b.length);var d=[];if(!C.hasOwnProperty(c)||!a.utils.isFunction(C[c]))throw x("Not a valid evaluate function: "+
c);ca=c;G=b;for(var g=0;g<b.length;g++)a.utils.isArray(b[g])?d[g]=l(b[g]):d[g]=b[g];return C[c].apply(window,d)}var q,t,r,u,k,m,n,p,J,E,L,D,y,A,ka,O,w,z={matchExact:function(a,b,c){c&&(a=a.toLowerCase(),b=b.toLowerCase());return a.toLowerCase()===b.toLowerCase()},matchPartial:b,matchBegins:function(a,b,c){c&&(a=a.toLowerCase(),b=b.toLowerCase());return b&&0===b.toLowerCase().indexOf(a.toLowerCase())},matchRegex:e,matchContains:function(a,b,c){c&&(a=a.toLowerCase(),b=b.toLowerCase());return b&&0<=
b.indexOf(a)}},C={and:function(){for(var a=0;a<arguments.length;a+=1)if(!arguments[a])return!1;return!0},or:function(){for(var a=0;a<arguments.length;a+=1)if(arguments[a])return!0;return!1},sum:function(){for(var a=0,b=0;b<arguments.length;b+=1)a+=P(arguments[b],10);return a},gte:function(a,b){return a>=b},lte:function(a,b){return a<=b},gt:function(a,b){return a>b},ly:function(a,b){return a<b},eq:function(a,b){return a==b},not:function(a){return!a},matchReferer:function(b){var c=a.utils.parseUri(b),
d=k.host===c.host;d||/^www\./.test(c.host)?d||!/^www\./.test(c.host)||/^www\./.test(k.host)||(d="www."+k.host===c.host):d=k.host==="www."+c.host;d&&(A.referer=A.referer||{},A.referer[b]=O);return!d&&A.referer&&A.referer[b]?a.utils.getDateFromContextFormat(A.referer[b])>=y:d},matchLandingpage:function(b){b=m[b];return"undefined"!==typeof b?(b=a.utils.getDateFromContextFormat(b),b>=y):!1},pathVisits:function(b){var c=q[b];return"undefined"===typeof c||a.utils.isArray(c)?"undefined"===typeof c?0:d(c):
(a.log.error("pathVisits not an array for id:"+b+", typeof:"+typeof c+", stringified:"+v.JSON.stringify(c),a.ERROR_TYPE_ARG_INVALID),0)},inSegment:function(a){return"undefined"!==typeof u[a]},enterSegment:function(b){var c=w&&w.enterSegment&&a.utils.inArray(w.enterSegment,b)?!0:!1;b=L&&L.enter?L.enter[b]:null;return c?!0:b?(b=a.utils.getDateFromContextFormat(b),b>=y):!1},leaveSegment:function(b){var c=w&&w.leaveSegment&&a.utils.inArray(w.leaveSegment,b)?!0:!1;b=L&&L.leave?L.leave[b]:null;return c?
!0:b?(b=a.utils.getDateFromContextFormat(b),b>=y):!1},customAction:function(a,b){var c=J[a],g=0;if(!c)return!1;g=d(c);return g>=b},newUser:function(){return 1===t.length||r>=y},matchRefererUrl:function(b,d){var g=a.utils.parseUri(d),e=c(b)+"|"+d;a.utils.isFunction(b)||(b=h(b));g.path=f(g.path);k.path=f(k.path);if(g=b(g.host+"/"+g.path,k.host+"/"+k.path))A.refererUrl=A.refererUrl||{},A.refererUrl[e]=O;else if(A.refererUrl&&A.refererUrl[e])return a.utils.getDateFromContextFormat(A.refererUrl[e])>=y;
return g},matchForm:function(b,c){a.utils.isFunction(b)||(b=h(b));return a.evaluateEvents.matchEvent("forms",w,b,c,A,O,y)},matchLink:function(b,c){a.utils.isFunction(b)||(b=h(b));return a.evaluateEvents.matchEvent("links",w,b,c,A,O,y)},matchSearchengine:function(c,d){var g=!1,e=!1,f=[],p,n=c+"|"+d;if(k.queryVariables){switch(c){case "bing":g="bing.com";p="q";break;case "yahoo":g="yahoo.com";p="p";break;case "askcom":g="ask.com";p="q";break;case "google":g="google.";p="q";break;default:return!1}k.queryVariables[p]&&
(f=X(k.queryVariables[p]).split(/\+| |%20/));g=g&&b(g,k.host);if(""!==d)for(d=d.split(","),p=0;p<f.length;p+=1)for(var l=0;l<d.length;l+=1){if(f[p]===d[l]){e=!0;break}}else e=!0;e=g&&e}else e=!1;e?(A.searchEngine=A.searchEngine||{},A.searchEngine[n]=O):A.searchEngine&&A.searchEngine[n]&&(e=a.utils.getDateFromContextFormat(A.searchEngine[n])>=y);return e},matchMetaRules:g,matchMetaTag:function(b,c){function d(a){a===c[g]&&(f=!0)}var g,e=b+"|"+c,f=!1,k=!1;if(!c)return!1;c=c.split(",");if("keyword"===
b&&n.keywords&&0<n.keywords.length){"object"!==typeof c&&(c=[c]);for(g=0;g<c.length;g+=1)a.utils.each(n.keywords,d);k=f}else if("description"===b&&n.description)for(k=!0,g=0;g<c.length;g+=1){if(-1===n.description.indexOf(c[g])){k=!1;break}}else if("ogtitle"===b&&n.ogtitle)for(k=!0,g=0;g<c.length;g+=1){if(-1===n.ogtitle.indexOf(c[g])){k=!1;break}}else if("ogdescription"===b&&n.ogdescription)for(k=!0,g=0;g<c.length;g+=1)if(-1===n.ogdescription.indexOf(c[g])){k=!1;break}k?(A.metaData=A.metaData||{},
A.metaData[e]=O):A.metaData&&A.metaData[e]&&(k=a.utils.getDateFromContextFormat(A.metaData[e])>=y);return k},matchCountry:function(b){var c=""!==b&&b===p.country;c?(A.country=A.country||{},A.country[b]=O):A.country&&A.country[b]&&(c=a.utils.getDateFromContextFormat(A.country[b])>=y);return c},matchDevice:function(b){var c=a.utils.isDevice(b);c?(A.device=A.device||{},A.device[b]=O):A.device&&A.device[b]&&(c=a.utils.getDateFromContextFormat(A.device[b])>=y);return c},parse:function(b){switch(b.method){case "conversion":var c=
b.conversionType;(b=b.conversionId)&&(c=a.visitsHistory.getConversionIdKey(c,b));return 1<=d(E[c]||[])?!0:!1;default:return!1}},siteVisitCount:function(){return d(t)},metaCount:function(a){return D.hasOwnProperty(a)?d(D[a]):0}},ca=null,G=null;return{evaluate:function(b,c,d){"undefined"===typeof d&&(d=0);y=new B(ka.toString());y.setDate(y.getDate()-d);y.setHours(0);y.setMinutes(0);y.setSeconds(0);O=a.utils.getDateInContextFormat(ka);try{return w=c,l(b)}catch(g){if(a.isDev())throw g;a.log.error(g,a.ERROR_TYPE_EXCEPTION,
{debug:"Last fn: "+ca+", last part: "+v.JSON.stringify(G)+", rule: "+v.JSON.stringify(b)});return null}},setContext:function(a){q=a.pageVisits;t=a.siteVisits;u=a.segments;k=a.referer;m=a.landingPages;D=a.metaCount;n=a.metaData;p=a.country;r=new B(a.firstVisit);J=a.customActions;E=a.conversions;L=a.segmentEvents;ka=a.evaluationTime;A=a.evaluatedEvents||{}},getContext:function(){return{evaluatedEvents:A}},matchUrl:function(b,c,d,g,k){var p=null,n;a.utils.isFunction(b)||(b=h(b));if(b===e){if(!b(c,k.path))return!1}else if(c=
a.utils.parseUri(c),c.path=f(c.path),k.path=f(k.path),!b(c.path,k.path))return!1;for(p in d)if(d.hasOwnProperty(p)&&(b=h(d[p][0]),c=d[p][1].toString(),n=k.params[p],"undefined"===typeof n||!b(c,n,!0)))return!1;return g.anchor&&(d=h(g.matcher),!d(g.anchor,k.anchor))?!1:!0},matchMetaRules:g,getMatcherFunction:h,getMatcherName:c,canonizePathSlashes:f}}();a.evaluateEvents=function(){return{matchEvent:function(f,b,e,h,c,d,g){var l=a.evaluator.getMatcherName(e)+"|"+h;b[f]&&b[f][0]&&a.utils.matchStringUrls(e,
h,b[f][0])&&(c[f]=c[f]||{},c[f][l]=d);return c[f]&&c[f][l]?a.utils.getDateFromContextFormat(c[f][l])>=g:!1}}}();(function(){function f(b,e,f){return a.runGuarded(b,[e],a.utils.extend({},f._logOptions,{context:f,errorReturn:null}))}a.baseEvaluator=function(){this._logOptions=void 0;this.values={document:function(){return w},location:function(){return a.main.getCurrentBrowserData().href},referrer:function(){return a.main.getCurrentBrowserData().referer},segments:function(){return a.context.segments}}};
a.baseEvaluator.prototype.evaluatorFunctions={and:function(){return a.utils.every(arguments,function(a){return a})},or:function(){return a.utils.some(arguments,function(a){return a})},"+":function(){var b=0;a.utils.each(arguments,function(a){b+=K(a)});return b},">=":function(a,e){return K(a)>=K(e)},"<=":function(a,e){return K(a)<=K(e)},">":function(a,e){return K(a)>K(e)},"<":function(a,e){return K(a)<K(e)},"eq?":function(a,e){return!0===a&&"true"===e||!1===a&&"false"===e||"true"===a&&!0===e||"false"===
a&&!1===e?!0:a==e},"eq??":function(a,e){return a===e},not:function(a){return!a},begins:function(b,e){return a.utils.isString(b)&&0===b.indexOf(e)},contains:function(b,e){return a.utils.isString(b)&&-1<b.indexOf(e)},ends:function(b,e){return a.utils.isString(b)&&a.utils.isString(e)&&-1!==b.indexOf(e,b.length-e.length)},exists:function(b){return a.utils.isNil(b)?!1:a.utils.isBoolean(b)||a.utils.isNumber(b)||!a.utils.isEmpty(b)},in:function(b,e){return a.utils.inArray(e,b)},"regex?":function(b,e,f){a.utils.isNil(b)&&
(b="");return(new N(e,f)).test(b)},array:function(){return a.utils.arrayFrom(arguments)},location:function(a,e){return this._url(this.getEvaluatorValue("location"),a,e)},referrer:function(a,e){return this._url(this.getEvaluatorValue("referrer"),a,e)},url:function(){return this._url.apply(this,arguments)},domelem:function(b,e){var f=this.getEvaluatorValue("document"),f=a.domElements.selector(b,f)[0];if(!f)return null;if(!e)return f;var c=/^attr:/,d=/^prop:/;return"html"===e?f.innerHTML:"text"===e?
f.textContent||f.innerText||null:d.test(e)?(c=e.replace(d,""),c in f?f[c]:null):c.test(e)?f.getAttribute(e.replace(c,"")):f.getAttribute(e)||f[e]},cookie:function(b){return a.cookies.get(b)},localstorage:function(a){return fa.getItem(a)},js_var:function(b){return a.utils.getByDotString(b,window,{empty:!1,nonObjects:!1,self:!1})},pluck:function(b,e){a.utils.each(e,function(e){b=a.utils.isNil(b)?void 0:b[e]});return b},js:function(b){return a.internal.eval(b,{easy:v.easy,site:v.site})},var:function(a){return this.getEvaluatorValue(a)},
inSegment:function(a){return void 0!==this.getEvaluatorValue("segments")[a]}};a.baseEvaluator.prototype.evaluate=function(b){if(!a.utils.isArray(b))throw new x('Invalid type for evaluator "rules" argument, got "'+a.utils.getType(b)+'"');return 0===b.length?!0:f(function(){return this._ruleEvaluator(b)},b,this)};a.baseEvaluator.prototype.addEvaluatorFunction=function(b,e){a.utils.isFunction(e)?this.evaluatorFunctions[b]=e:a.log.error('Invalid type for evaluator "fn" argument, got "'+a.utils.getType(e)+
'" for "'+b+'"',a.ERROR_TYPE_ARG_INVALID)};a.baseEvaluator.prototype.getEvaluatorValue=function(b){if(!this.values.hasOwnProperty(b))return null;b=this.values[b];return a.utils.isFunction(b)?b.call(this):b};a.baseEvaluator.prototype.removeEvaluatorValue=function(a){delete this.values[a]};a.baseEvaluator.prototype.setEvaluatorValue=function(b,e){this.values[b]=a.utils.isFunction(e)?e:function(){return e}};a.baseEvaluator.prototype._ruleEvaluator=function(b){if(!a.utils.isArray(b)||0===b.length)throw new x('Invalid type for evaluator "rules" argument, got "'+
a.utils.getType(b)+'"');var e=b[0];if(!this.evaluatorFunctions.hasOwnProperty(e)||!a.utils.isFunction(this.evaluatorFunctions[e]))throw new x('Invalid evaluator function type, got "'+a.utils.getType(e)+'" for "'+e+'"');var h=b.slice(1),c=[];a.utils.each(h,function(b,g){a.utils.isArray(b)?c[g]=this._ruleEvaluator(b):c[g]=b;return c},this);return f(function(){return this.evaluatorFunctions[e].apply(this,c)},b,this)};a.baseEvaluator.prototype._url=function(b,e,f){if(!a.utils.inArray("anchor host href path protocol query".split(" "),
e))return"";var c=a.utils.parseUri(b);switch(e){case "href":return b;case "query":return f?c.queryKey[f]:c.query;default:return c[e]}};a.baseEvaluator.prototype.setErrorOptions=function(a){this._logOptions=a}})();a.triggers=function(){function f(e){var f=e.on_event;e=b(f);if(!m[e])switch(f.type){case a.EVENT_DOM_EVENT:h(f,e,function(a,b){return{element:b}});break;case a.EVENT_DOM_WAIT:c(f,e,function(a){return{element:a[0]}});break;case a.EVENT_EASY_EVENT:d(f,e,function(b,c){switch(f.eventName){case a.EVENT_MESSAGE_SHOW:case a.EVENT_MESSAGE_CLICK:case a.EVENT_MESSAGE_TRUE_DISPLAY:case a.EVENT_PRODUCT_PURCHASE:case a.EVENT_CONVERSION:case a.EVENT_LOCATION:return a.utils.clone(b);
case a.EVENT_CUSTOMACTION:return{name:b,value:c};case a.EVENT_VISIT:break;default:return b}});break;case a.EVENT_JSVAR_WAIT:l(f,e,function(){});break;case a.EVENT_SCRIPT_LOAD:case a.EVENT_EASY_READY:case a.EVENT_DOM_READY:d(g(f),e,function(){return{}});break;case a.EVENT_DATALAYER:d(g(f),e,function(a){return a});break;case a.EVENT_URL_CHANGED:d(g(f),e,function(a,b){return{url:a,previousUrl:b}})}}function b(b){switch(b.type){case a.EVENT_DOM_EVENT:return b.type+"|"+b.eventName+"|"+b.selector;case a.EVENT_DOM_WAIT:return b.type+
"|"+b.selector+"|"+z(e(b.timeout));case a.EVENT_EASY_EVENT:return b.type+"|"+b.eventName;case a.EVENT_JSVAR_WAIT:return b.type+"|"+b.js_var+"|"+z(e(b.timeout));default:return b.type}}function e(a){a=1E3*H(a);return 0<=a?a:0}function h(b,c,d){d=q(b,c,d);a.domEvents.on(w,b.eventName,b.selector,d);t(b,c,d,void 0)}function c(b,c,d){d=q(b,c,d);var g=a.domElements.waitFor({selector:b.selector,timeout:e(b.timeout),success:d});t(b,c,d,g);g.catch(function(a){r(b,c,g,a)})}function d(b,c,d){d=q(b,c,d);a.events.on(b.eventName,
d);t(b,c,d,void 0)}function g(b){return a.utils.extend({eventName:b.type},b)}function l(b,c,d){d=q(b,c,d);var g=a.utils.waitFor(128,e(b.timeout),function(){return void 0!==a.utils.getByDotString(b.js_var,window,{empty:!1,nonObjects:!1,self:!1})});t(b,c,d,g);g.then(d,function(a){r(b,c,g,a)})}function q(b,c,d){return a.guard(function(){var c=d.apply(null,arguments);a.triggers.fireEvent(b,c)},{useCallingZone:!0,html:"triggerEventKey: "+c})}function t(b,c,d,g){m[c]=a.utils.extend({triggerFn:d,promise:g},
b)}function r(c,d,g,e){c=a.utils.filter(n,function(a){return b(a.on_event)===d});c=a.utils.map(c,function(a){return a.id});a.debug.addEntry("errors_trigger_events",{error:e,triggerIds:c});e&&e.type===a.ERROR_TYPE_TIMEOUT||g.isCancelled()||a.console.error(u,e,v.JSON.stringify({triggerEventKey:d,triggerIds:c}))}var u=a.MODULE_TRIGGER,k,m={},n;return{init:function(b){k=new a.baseEvaluator;n=a.utils.clone(b);a.utils.each(n,a.guard(f,{module:a.MODULE_TRIGGER}))},clear:function(){a.utils.each(m,function(b){switch(b.type){case a.EVENT_DOM_EVENT:a.domEvents.off(w,
b.eventName,b.selector,b.triggerFn);break;case a.EVENT_DOM_WAIT:case a.EVENT_JSVAR_WAIT:b.promise.cancel();break;default:a.events.off(b.eventName,b.triggerFn)}});m={};a.events.clearEvent(a.EVENT_TRIGGER_EVENT);a.events.clearEvent(a.EVENT_TRIGGER_FIRE)},fireEvent:function(c,d){var g=b(c),e=a.utils.filter(n,function(c){return b(c.on_event)===g&&a.triggers.evaluateTrigger(c,d)});a.events.trigger(a.EVENT_TRIGGER_EVENT,{data:d,event:c,triggers:e})},evaluateTrigger:function(b,c){a.utils.each(c,function(a,
b){k.setEvaluatorValue(b,a)});k.setErrorOptions({type:a.ERROR_TYPE_TRIGGER_EXCEPTION,level:a.LOG_LEVEL_ERROR,module:a.MODULE_TRIGGER,triggerId:b.id});var d=k.evaluate(b.rules);a.utils.each(c,function(a,b){k.removeEvaluatorValue(b,a)});if(!d)return!1;a.events.trigger(a.EVENT_TRIGGER_FIRE,b,c);b.alias&&a.events.trigger(b.alias,b,c);return!0},_testGetEvaluator:function(){return k}}}();a.events=function(){function f(c,d,g,f,q){var t={type:c,origFn:g,fn:a.guard(g,{context:f}),handled:!1};e[d]=e[d]||[];
e[d].push(t);q=a.utils.extend({ignoreTriggered:!1},q);q.ignoreTriggered||a.utils.each(h[d],function(a){b(t,a)})}function b(a,b){a.handled&&"once"===a.type||(a.handled=!0,a.fn.apply(null,b))}var e={},h={};return{clear:function(){e={};h={}},clearEvent:function(a){delete h[a]},isTriggered:function(a){return C(h[a])},off:function(b,d){var g=a.utils.isFunction(d);e[b]=a.utils.filter(e[b],function(a){return g&&d!==a.origFn})},on:function(a,b,g,e){f("on",a,b,g,e)},once:function(a,b,g,e){f("once",a,b,g,e)},
trigger:function(c){var d=a.utils.arrayFrom(arguments).slice(1);a.debug.addEntry("event",{name:c,args:d});h[c]=h[c]||[];h[c].push(d);a.utils.each(e[c],function(a){b(a,d)});a.console.info("[events]",c,d)}}}();var T={prevFrame:void 0,zone:{type:a.ERROR_TYPE_EXCEPTION,module:a.MODULE_SITE,modules:a.MODULE_SITE}};a.guard=function(f,b){function e(){var d=h?c:T.zone;T={prevFrame:T,zone:d};try{return f.apply(b.context||this,arguments)}catch(e){try{e instanceof x||(e=new x(z(e)));var g=d.type;if(a.utils.isNumber(e.type)||
a.utils.isString(e.type))g=z(e.type);if(a.utils.isFunction(b.onError))return b.onError(e,g,d),b.errorReturn;var l=a.internal.createLogOptions(e.options,b.level);a.log.send(e,g,a.utils.extend({level:a.LOG_LEVEL_ERROR},d,l))}catch(r){T.zone={};var q=z(a.MODULE_SITE);a.log.send(r,"guard_"+a.ERROR_TYPE_ARG_INVALID,{level:z(a.LOG_LEVEL_ERROR),module:q,modules:q,debug:e+", Type: "+g})}}finally{T=T.prevFrame}return b.errorReturn}if(f.hasExceptionHandling)return f;a.utils.isObject(b)||(b={});var h=!b.useCallingZone,
c={};h&&(a.utils.extend(c,T.zone),a.utils.each(b,function(a,b){void 0!==a&&(c[b]=a)}),T.zone.module!==c.module&&(c.modules=T.zone.modules+" "+c.module),a.utils.isNumber(c.type)||a.utils.isString(c.type)||(c.type=a.ERROR_TYPE_EXCEPTION),delete c.level,delete c.context,delete c.errorReturn,delete c.onError);e.origFn=f;e.hasExceptionHandling=!0;return e};a.guard.current=function(){return T.zone};a.runGuarded=function(f,b,e){return a.guard(f,e).apply(null,a.utils.isArray(b)?b:[])};a.uid=function(){function f(){return null!==
c}function b(a){h(a,"uid");c=a}function e(b){var c,e=a.utils.find({"bingbot|adidxbot|BingPreview":function(){return"bingbot.00000000"},"Google Web Preview|Googlebot|Mediapartners-Google|AdsBot-Google":function(){return"webpreview.00000000"},HeadlessChrome:function(){return"headless.00000000"},"AdobeAIR/(\\d+(\\.\\d+)*)":function(a){return"adobeair_"+a[1].replace(/\./g,"")+".00000000"}},function(a,e){return c=b.match(new N(e))});return e&&c?e(c):void 0}function h(b,c){if(!a.utils.isString(b)||0===
b.length)throw new x('Invalid type for "'+c+'" argument, got "'+a.utils.getType(b)+'" for "'+v.JSON.stringify(b)+'"');}var c=null;return{get:function(){return c},getDecilForUid:function(b){h(b,"uid");b=P(a.md5(b+"randomized decil").substr(0,8),16)/F.pow(2,32);return P(10*b,10)+1},isDefined:f,isInComparisonGroup:function(b){h(b,"uid");return P(a.md5(b).substr(0,8),16)/F.pow(2,32)<a.config.comparisonGroupRatio},newUid:function(a){h(a,"userAgent");if(!f()){var g;if(!(g=e(a))){g=2166136261;for(var l=
0;l<a.length;l++)g+=(g<<1)+(g<<4)+(g<<7)+(g<<8)+(g<<24),g^=a.charCodeAt(l);g=(g&2147483647).toString(36)+"."+B.now().toString(36)}b(g)}return c},set:b,_testResetUID:function(){c=null}}}();a.segmentchange=function(){function f(b){return 1===a.context.segments[b]}function b(b,c){var d=B.now(),g=a.utils.getDateInContextFormat(p);"enter"===c?(a.context.segmentEvents.enter[b]=g,delete a.context.segmentEvents.leave[b]):"leave"===c&&(a.context.segmentEvents.leave[b]=g,delete a.context.segmentEvents.enter[b]);
a.context.segmentChanged=d;a.context.save()}function e(b,c){r=r||{};u=u||{};r[b]=r[b]||[];u[b]=u[b]||[];a.utils.inArray(u[b],c)||u[b].push(c);a.utils.inArray(r[b],c)||r[b].push(c)}function h(a,b){var c=[],d=r[a];if(d){for(var g=0;g<d.length;g+=1)d[g]!==b&&c.push(d[g]);r[a]=c}}function c(a,b){var c=k[a];k[a]=b;c!==b&&(0===b?(e("leaveSegment",a),h("enterSegment",a)):1===b&&(e("enterSegment",a),h("leaveSegment",a)),k[a]=b)}function d(c,d){if(f(c))return!1;if(d)a.context.segments[c]=1,a.context.save(),
a.api.setUserSegment(null,c,"value1"),b(c,"enter"),a.events.trigger(a.EVENT_SEGMENT_ENTER,c);else{var g=a.utils.clone(a.context.segments);g[c]=1;q({enterSegment:[c]},new B,g)}return!0}function g(c,d){if(!f(c))return!1;if(d)delete a.context.segments[c],a.context.save(),a.api.setUserSegment(null,c,"value0"),b(c,"leave"),a.events.trigger(a.EVENT_SEGMENT_LEAVE,c);else{var g=a.utils.clone(a.context.segments);g[c]=0;q({leaveSegment:[c]},new B,g)}return!0}function l(b,c,d){return""===b||null===b||"undefined"===
typeof b?!1:a.evaluator.evaluate(b,c,d)}function q(b,c,d){var g={};k=d||a.utils.clone(a.context.segments);u=b;for(d=0;10>d;d+=1){r={};a.segmentchange.evaluateSegments(b,c);a.segmentchange.evaluateSegmentGroups(b);var e=[];a.utils.each(r.enterSegment,function(a){e.push(a)});a.utils.each(r.leaveSegment,function(a){e.push(a)});if(0===e.length)break;a.utils.each(e,function(a){g[a]=g[a]?g[a]+1:1})}10===d&&(b="segmentchange.evaluate(): max evaluation rounds:10 reached\n"+v.JSON.stringify(g),a.log.error(b,
a.ERROR_TYPE_ARG_INVALID,{module:a.MODULE_SEGMENT}),a.console.log("[segmentchange]",b));t(k);k={};return{evaluationRounds:d,changesBySegment:g}}function t(b){var c=0;a.utils.each(b,function(b,e){var f=a.context.segments.hasOwnProperty(e);0===b&&f?(g(e,!0),c+=1):1!==b||f||(d(e,!0),c+=1)});return c}var r={},u={},k={},m=[],n,p;return{init:function(a,b){u={};m=a.segments;n=a.segmentGroups||{};p=b},evaluate:q,evaluateSegments:function(b,d){a.context.evaluationTime=d;a.evaluator.setContext(a.context);for(var g=
0;g<m.length;g+=1){var e=m[g],f="sggp_"+e.group;n.hasOwnProperty(f)&&(n[f].rules||(n[f].rules={}),n[f].rules[e.name]=e);b.rule=e;var f=l(e.leave,b,e.timelimit),p=l(e.enter,b,e.timelimit);null!==p&&null!==f&&(p&&f&&(p=!1),k.hasOwnProperty(e.name)?(f||!p&&e.autoexit)&&c(e.name,0):p&&c(e.name,1))}a.context.evaluatedEvents=a.evaluator.getContext().evaluatedEvents},evaluateSegmentGroups:function(b){function d(b,g,e){function f(a){a=v.JSON.stringify(a);return a=a.replace(/conversionType":"([^"]+)","conversionId":"([^"]+)"/g,
function(a,b,c){return'conversionType":"'+b+" "+c+'"'})}function n(b,c){var d=!1,g=f(b.enter),e;for(e in c)if(c.hasOwnProperty(e)){var k=c[e];if(d)break;if(a.utils.isArray(k))for(var l=0;l<k.length;l+=1)if(-1<g.indexOf('"'+k[l]+'"')){d=!0;break}}return d}var l=[],m=[],p=[],h=[],q;for(q=0;q<b.length;q+=1){var E=b[q];1===k[E]&&n(g[E],e)&&p.push(E);a.context.segments.hasOwnProperty(E)&&1===k[E]?l.push(E):1===k[E]&&m.push(E)}(g=p.pop())||(g=0<l.length?l.pop():m.pop());for(q=0;q<b.length;q+=1)b[q]===g?
c(b[q],1):1===k[b[q]]&&(c(b[q],0),h.push(b[q]))}a.utils.each(n,function(a){if("funnel"===a.mode){a=a.segments;var g=-1,e;for(e=0;e<a.length;e+=1)1===k[a[e]]&&(g=e);for(e=0;e<g;e+=1)1===k[a[e]]&&c(a[e],0)}else"radio"===a.mode&&d(a.segments,a.rules,b)})},expireSegments:function(){var b=!1,c=new B(p);c.setHours(0);c.setMinutes(0);c.setSeconds(0);c.setMilliseconds(0);for(var d=0;d<m.length;d+=1)if(a.context.lastVisit.time&&m[d].timelimit&&m[d].autoexit&&a.context.segmentEvents.enter[m[d].name]){var g=
new B(a.context.lastVisit.time);g.setDate(g.getDate()+m[d].timelimit);g.setHours(0);g.setMinutes(0);g.setSeconds(0);g.setMilliseconds(0);g<c&&(delete a.context.segments[m[d].name],b=!0)}b&&a.context.save()},segmentChanged:b,setSegment:d,removeSegment:g,inSegment:f}}();a.uihooks=function(){function f(b,d){return function(g,e){var f={};f[b]=[e[d]];a.segmentchange.evaluate(f,new B)}}function b(b,d,g){for(var e=0;e<d.length;e++)if(a.utils.matchStringUrls(d[e][0],d[e][1],b)){g();break}}var e=[],h=[];return{initForms:function(c){a.utils.each(a.domElements.selector("form"),
function(d){a.utils.isString(d.action)&&b(d.action,c,function(){a.utils.inArray(e,d)||(a.domEvents.on(d,"submit."+a.DOM_EVENT_NAMESPACE,f("forms","action")),e.push(d))})})},initLinks:function(c){a.utils.each(a.domElements.selector("a"),function(d){b(d.getAttribute("href"),c,function(){a.utils.inArray(h,d)||(a.domEvents.on(d,"mousedown."+a.DOM_EVENT_NAMESPACE,f("links","href")),h.push(d))})})},forms:e,links:h}}();a.main=function(){function f(b,c,d){"success"===r?a.log.warn('initFailure function called, when the state was "success"',
a.ERROR_TYPE_CORE_INIT):(a.events.trigger(a.EVENT_INIT_FAILURE),r="failure",void 0!==b&&a.log.send(b instanceof x?b:z(b),z(c),a.internal.createLogOptions(d)))}function b(b,c){a.utils.isString(b)&&(t.href=b);a.utils.isString(c)&&(t.referer=c)}function e(d,g,e){a.utils.isString(g)||(a.log.error('Invalid "referer" argument, got "'+g+'"',a.ERROR_TYPE_CORE_INIT),g="");a.utils.isString(d.href)||a.log.error('Invalid type for "href" property, got "'+a.utils.getType(d.href)+'"',a.ERROR_TYPE_CORE_INIT);a.utils.isString(d.search)||
a.log.warn('Invalid type for "search" property, got "'+a.utils.getType(d.search)+'"',a.ERROR_TYPE_CORE_INIT);b(d.href,g);l(d,g);c(d,g,q.landingPages);a.visitsHistory.addPageVisit(d,q.pages,u,a.guard(function(b){a.segmentchange.evaluate({forms:[],links:[],pageVisits:b||[]},u);a.context.save();a.utils.isFunction(e)&&a.runGuarded(e)}))}function h(){a.handleCurrentPage();a.segments.init(q.segmentsV2,q.segmentGroupsV2,q.segmentCountersV2);a.events.trigger(a.EVENT_EASY_READY);a.internal.dispatchEvent("frosmo.ready");
a.events.trigger(a.EVENT_INIT_SUCCESS);r="success";a.contextLoader.useServerApi(a.context.userAgent)&&a.utils.setInterval(function(){a.context.save(!0)},1E3)}function c(b,c,d){var g=a.context.referer,e=a.utils.getLocationFromUrl(b.href);c=a.utils.getLocationFromUrl(c);if(c.host===e.host)a.context.referer=c;else if(c.host!==g.host||c.path!==g.path||c.queryVariables!==g.queryVariables)a.context.referer=c,b.href&&a.utils.each(d,function(b,c){var d=a.evaluator.getMatcherFunction(b[0]);a.evaluator.matchUrl(d,
b[1],b[2],{},e)&&(a.context.landingPages[c]=a.utils.getDateInContextFormat(u))}),a.context.landingpage=a.utils.getLocationFromUrl(b.href),a.context.save()}function d(b){var c={name:{},property:{}};a.utils.each(a.domElements.selector("meta",b),function(a){var b=a.getAttribute("name"),d=c.name;b||(b=a.getAttribute("property"),d=c.property);b&&(d[b]=d[b]||[],d[b].push(a.getAttribute("content")))});var d=[];a.utils.each(q.meta,function(b,g){a.evaluator.matchMetaRules(b,c)&&(a.visitsHistory.addMetaCount(g,
u),d.push(g))});0<d.length&&a.segmentchange.evaluate({events:d},u)}function g(){a.location.isSupported()&&a.location.get(function(b){b.country2&&a.context.country.country!==b.country2&&a.segmentchange.evaluate({forms:[],links:[]},u);a.context.country.country=b.country2;a.context.country.latitude=b.latitude;a.context.country.longitude=b.longitude;a.context.country.city=b.city;a.context.country.time=u.getTime();a.context.save()})}function l(b,c){var d=u.getTime();if(18E5<=d-a.context.lastPageView.time){var e=
u,f;f=a.utils.getLocationFromUrl(b.href);var l=a.utils.getLocationFromUrl(c);f=""===c||l.host===f.host?"direct":l.host;a.api.setSessionStartTime(e.getTime());a.segmentchange.expireSegments();a.context.lastVisit.time=e.getTime();a.context.lastVisit.source=f;a.context.referer=a.utils.clone(a.defaultContext.referer);a.context.landingpage=a.utils.clone(a.defaultContext.landingpage);g();0!==a.context.siteVisits.length||a.context.firstVisit||(a.context.firstVisit=e.toString());a.visitsHistory.addSiteVisit(e);
a.context.sessionPathVisits={};a.context.save();a.api.visit(null,f,a.states.get(a.STATE_DEVICE));a.events.trigger(a.EVENT_VISIT)}a.context.lastPageView.time=d;a.context.save()}var q=null,t={href:null,referer:null},r,u;return{init:function(b,c,d){a.events.clearEvent(a.EVENT_EASY_READY);a.events.clearEvent(a.EVENT_INIT_SUCCESS);q=c||{};u=d||new B;a.context=b;a.api.setRequestEnabled(!0);if(void 0===q.segments||null===q.segments)return f("Segments were not found",a.ERROR_TYPE_CORE_INIT,{level:a.LOG_LEVEL_ERROR}),
!1;a.api.setSessionStartTime(a.context.lastVisit.time);a.segmentchange.init(q,u);q.customActions&&a.customAction.init(q.customActions);q.conversions&&a.conversion.init(q.conversions);q.googleAnalytics&&a.googleAnalytics.init(q.googleAnalytics);a.user.init();a.domEvents.ready(function(){a.uihooks.initForms(q.forms);a.uihooks.initLinks(q.links)});a.preview.init();"failure"===r?a.log.warn('_initEnd function called, when the state was "failure"',a.ERROR_TYPE_CORE_INIT):h();return!0},VISIT_TIMEOUT:18E5,
getCurrentBrowserData:function(){return a.utils.clone(t)},getState:function(){return r},initFailure:f,initStart:function(){a.events.trigger(a.EVENT_INIT_START);r="initializing"},setCurrentBrowserData:b,updateBrowserData:function(b,c,g,f){g=g||b.location;f=f||b.document.referrer;a.context.userAgent=b.navigator.userAgent||a.context.userAgent;d(b.document.head);e(g,f,c);a.events.isTriggered(a.EVENT_EASY_READY)&&a.messageTrueDisplay.clear();a.context.save()},updateLocation:e}}();a.internal=function(){var f=
0;return{createLogError:function(a,e,f){var c=a instanceof x?a:new x(a);c.type=a.type?a.type:e;c.options=a.options?a.options:f;return c},createLogOptions:function(b,e){b&&b.level&&a.utils.isString(b.level)||(b=b||{},b.level=e&&a.utils.isString(e)?e:a.LOG_LEVEL_ERROR);return b},debug:function(b){b=a.utils.parseUri(b).queryKey;"on"===b.frosmodebug?a.console.setEnabled(!0):"off"===b.frosmodebug&&a.console.setEnabled(!1);b.frosmodebuglevel&&a.console.setLevel(b.frosmodebuglevel)},dispatchEvent:function(a){try{var e=
new oa(a);window.dispatchEvent(e)}catch(f){}},eval:function(b,e){var f=a.utils.map(e,function(a,b){return b+" = this."+b}).join(",");return function(){return eval((f?"var "+f+";\n":"")+b)}.call(e)},getCurrentModule:function(b){var e=a.guard.current().module;return!0!==b&&e===a.MODULE_CORE?a.MODULE_SITE:e},getProfile:function(){return a.profile?a.profile.get():void 0},getSegmentIds:function(b){var e=[];a.utils.each(b,function(a,b){1===a&&e.push(b)});return e.join(".").replace(/sgmt_/g,"")},getWorkspaceId:function(){if(!a.workspaces)return 0;
var b=a.workspaces.getId();return 0<b?b:0},isMessage:function(b){return C(b)&&a.utils.every(["id","revision","revisionType"],function(a){return void 0!==b[a]})},safeEval:function(b,e,f){f=0<=f?f:0;a.isDev()&&(b='\n"use strict";\n'+b);e.scriptNamespace&&(b+="\n//# sourceURL="+e.scriptNamespace+"_"+f);var c=a.utils.extend({},e.guardOptions,{level:a.LOG_LEVEL_CRITICAL,scriptId:f});return a.runGuarded(function(){var c=[],g=[];a.utils.each(e.args,function(a,b){c.push(b);g.push(a)});c.push(b);var l=ea.apply(null,
c),q=a.utils.extend({},e.guardOptions,{scriptId:f});return a.runGuarded(l,g,q)},void 0,c)},send:function(b,e){var h=a.utils.parseUri(b),h=h.protocol+"://"+h.host+h.path+"?_transportMethod=image"+(h.query?"&":"")+h.query,c=new qa;c.src=e?h:h+"&"+f++;a.debug.addEntry("send_api",{url:h,method:"IMAGE"});return c},sendBeacon:function(b,e){b.length>a.MAXIMUM_URL_LENGTH&&a.log.warn("URL limit of "+a.MAXIMUM_URL_LENGTH+' exceeded. URL: "'+W(a.internal.truncate(b,300))+'"',a.ERROR_TYPE_URL_LONG,{module:"[internal]"});
a.utils.isFunction(M.sendBeacon)?M.sendBeacon(e?b:b+"&"+f++)?(a.debug.addEntry("send_api",{url:b,method:"BEACON"}),a.console.info("[internal]",'Queued Beacon API call "'+b+'"')):a.log.error("Skipped Beacon API call",a.ERROR_TYPE_QUEUE_LONG,{module:"[internal]",debug:W(a.internal.truncate(b,300))}):a.internal.send(b,e)},states:function(b){var e;a.utils.isMobile()?e="mobile":a.utils.isTablet()?e="tablet":a.utils.isDesktop()&&(e="desktop");a.states.set(a.STATE_DEVICE,e);b=a.utils.parseUri(b).queryKey.frosmotest;
"on"===b?a.states.set(a.STATE_MODE,a.STATE_MODE_TEST,a.STATE_TYPE_SESSION):"off"===b&&a.states.remove(a.STATE_MODE)},truncate:function(a,e){a=z(a);return a.length>e?a.substr(0,e)+"...{"+(a.length-e)+"}":a}}}();a.api=function(){function f(){var b=new B,c=q?b.getTime()-q.getTime():0;return a.utils.pad(b.getUTCDate(),0,2)+a.utils.pad(b.getUTCHours(),0,2)+a.utils.pad(b.getUTCMinutes(),0,2)+c+f._globalId++}function b(){return q?q.getUTCFullYear()+a.utils.pad(q.getUTCMonth()+1,0,2)+a.utils.pad(q.getUTCDate(),
0,2)+a.utils.pad(q.getUTCHours(),0,2)+a.utils.pad(q.getUTCMinutes(),0,2)+a.utils.pad(q.getUTCSeconds(),0,2):""}function e(a){return c&&t[a]?"preview"===a?g+"/"+t[a]:"https:"+c.replace(/^https?:?/,"")+t[a]:null}function h(b){var c={cookieId:a.uid.get(),origin:d,ver:a.getVersion()};if("optimizer"===b||"tracking"===b)c.segments=a.context?a.internal.getSegmentIds(a.context.segments):"";return c}var c,d,g,l=!1,q=null,t={contextApi:"contextApi",error:"errorApi",event:"eventsApi",location:"location",message:"messageApi",
optimizer:"optimizerApi",pageload:"pageloadApi",preview:"previewDataApi",product:"productApi",reco:"recoApi",search:"search",searchBox:"searchBox",smartDiscovery:"smartDiscoveryApi",tracking:"trackingApi",visitor:"visitorApi"},r=function(b,c){var d={};a.utils.each(c,function(b,c){a.utils.isObject(b)?d=a.utils.extend(d,b):d[c]=b});a.utils.each(d,function(a,b){!1===a||null===a||void 0===a?d[b]="":!0===a&&(d[b]="1")});a.utils.extend(d,h(b));return a.utils.addQueryString(e(b),d)},u=function(b){if(b){if(!l)throw new x('API called before context initialized for "'+
b+'"');a.internal.sendBeacon(b+"&"+f(),!0)}};f._globalId=1;return{init:function(a,b,e){c=a;d=b;g=e},getOrigin:function(){return d},setRequestEnabled:function(a){l=C(a)},setSessionStartTime:function(a){q=a?new B(a):null},addToCart:function(a){a=r("optimizer",{event:"addToCart",items:v.JSON.stringify(a),sessionStart:b()});u(a)},buyProduct:function(a,c,d,g,e,f,l,h,q,t){a=r("optimizer",{event:"buyProduct",productType:c,productId:d,netValue:g,fee:e,tax:f,paymentChannel:l,customId:h,quantity:t,sessionStart:b()});
u(a)},transaction:function(a,c,d,g,e){a=r("optimizer",{event:"transaction",conversionType:c,transactionId:d,value:g,products:v.JSON.stringify(e),sessionStart:b()});u(a)},showMessage:function(a,c,d){a=r("optimizer",{event:"showMessage",messageId:c,revision:d,sessionStart:b()});u(a)},clickMessage:function(a,c,d){a=r("optimizer",{event:"clickMessage",messageId:c,revision:d,sessionStart:b()});u(a)},trueDisplay:function(a,c,d){a=r("optimizer",{event:"trueDisplay",messageId:c,revision:d,sessionStart:b()});
u(a)},login:function(a,c){var d=r("optimizer",{event:"login",userId:a,source:c,sessionStart:b()});u(d)},visit:function(a,c,d){a=r("optimizer",{event:"visit",source:c,device:d,sessionStart:b()});u(a)},setProductData:function(a,c,d){a=r("optimizer",{event:"setProductData",productId:a,productAttributes:c,sessionStart:b()});u(a)},setProductDataPayload:function(c,d){var g={event:"setProductData",payload:v.JSON.stringify(c),sessionStart:b()};a.utils.isNil(d)||(g.mode=d);g=r("optimizer",g);u(g)},setConversionData:function(a,
c,d){a=r("optimizer",{event:"setProductData",productId:a,productAttributes:c,mode:"set",sessionStart:b()});u(a)},setUserSegment:function(a,c,d){a=r("optimizer",{event:"setUserSegment",segmentName:c,segmentValue:d,sessionStart:b()});u(a)},viewItemList:function(a){a=r("optimizer",{event:"viewItemList",filters:v.JSON.stringify(a),sessionStart:b()});u(a)},custom:function(c){a.utils.extend(c,h("optimizer"),{event:"custom",sessionStart:b()});c=r("optimizer",c);u(c)},sendCustomAction:function(b,c,d){b=r("event",
{method:"customAction",name:b,value:c,title:d});a.internal.sendBeacon(b,!1)},getCallUrl:r,getApiUrl:e,getSessionStart:b,getCallId:f,_testSetGetUrl:function(a){var b=r;r=a;return b},_testSetCallUrl:function(a){var b=u;u=a;return b}}}();a.contextLoader=function(){function f(b,c){var d=a.defaultContext.clone();if(!b)return a.utils.extend(d,{origin:c.api.origin});b=a.utils.extend(d,b);b=a.convert.convert(b);b.origin||(b.origin=c.api.origin);return b}function b(b,c,g){function e(){b.getContext(function(b){a.events.trigger(a.EVENT_INIT_CONTEXT,
f(b,c))},d)}b.getUid(function(c){c?(a.uid.set(c),e()):(c=a.uid.newUid(g),b.setUid(c,e,d),a.events.trigger(a.EVENT_UID_CREATED,c));a.events.trigger(a.EVENT_INIT_UID,c)},d)}function e(b){a.events.trigger(a.EVENT_XDM_REQUEST);var g=b.api.origin.replace(/_/g,""),g=b.api.domain.replace("//","https://"+g+"."),e=b.xdmUrl||g+"frosmo.xdm.html";return h(e).then(function(a){return b.xdmPreviousUrl&&b.xdmPreviousUrl!==e?c(a,b.xdmPreviousUrl,e):a}).then(function(b){a.sharedContextRpc=b;a.events.trigger(a.EVENT_XDM_READY)}).catch(d)}
function h(b){return(new a.xdmLocal({remote:b,timeout:a.XDM_INIT_TIMEOUT})).init()}function c(b,c,d){var g;return b.get("UID").then(function(e){if(e)return b;a.console.info("[contextLoader]",'Started migrating the UID and context from "'+c+'" to "'+d+'"');return h(c).then(function(a){g=a}).then(function(){return g.get("UID")}).then(function(a){if(!a)throw new x("Previous UID not set");return b.set("UID",a)}).then(function(){return g.get("context")}).then(function(a){if(!a)throw new x("Previous context not set");
return b.set("context",a)}).then(function(){a.console.info("[contextLoader]",'Successfully migrated the UID and context from "'+c+'" to "'+d+'"');return b}).catch(function(c){a.console.warn("[contextLoader]",c);return b})})}function d(b){b||(b="Unexpected error with initializing context (default)");switch(b.type){case "context_"+a.ERROR_TYPE_ARG_INVALID:b.type="context_init_"+a.ERROR_TYPE_ARG_INVALID;break;case "context_"+a.ERROR_TYPE_AJAX_TIMEOUT:b.type=a.ERROR_TYPE_CONTEXT_INIT_TIMEOUT;break;case "context_"+
a.ERROR_TYPE_STORAGE_EXCEPTION:b.type=a.ERROR_TYPE_CONTEXT_INIT_STORAGE,b.options=b.options||{},b.options.level=a.LOG_LEVEL_WARNING,b.options.module=a.MODULE_CORE}a.main.initFailure(b,b.type||a.ERROR_TYPE_CONTEXT_INIT,b.options)}function g(b){var c=M.vendor&&-1<M.vendor.indexOf("Apple");b=/(ipad|iphone|ipod)/i.test(b||r);return(c||b)&&a.config.contextApi}function l(b,c){b=a.internal.createLogError(b,"context_"+b.type);a.utils.isFunction(c)&&c(b);throw b;}function q(b){return function(c,d,g,e){c=a.internal.createLogError(g.text,
"context_"+g.type,{level:g.type===a.ERROR_TYPE_AJAX_TIMEOUT?a.LOG_LEVEL_WARNING:a.LOG_LEVEL_ERROR,debug:e});a.utils.isFunction(b)&&b(c)}}var t,r="",u={getUid:function(b){b(a.store.get("UID"))},setUid:function(b,c,d){try{a.store.set("UID",b),a.utils.isFunction(c)&&c()}catch(g){l(g,d)}},getContext:function(b){b(a.store.get("context"))},setContext:function(b,c,d){try{a.store.set("context",b),a.utils.isFunction(c)&&c()}catch(g){l(g,d)}}},k={getUid:function(b){b(a.cookies.get("frosmo_uid"))},setUid:function(b,
c){a.cookies.set("frosmo_uid",b,365);a.utils.isFunction(c)&&c()},getContext:function(b,c){if(!a.uid.get())throw new x("UID not set");a.contextApi.get("context",b,q(c))},setContext:function(b,c,d){if(!a.uid.get())throw new x("UID not set");a.contextApi.set("context",b,c,q(d))}},m={getUid:function(b,c){a.sharedContextRpc.get("UID").then(b).catch(c)},setUid:function(b,c,d){a.sharedContextRpc.set("UID",b).then(c).catch(d)},getContext:function(b,c){a.sharedContextRpc.get("context").then(b).catch(c)},setContext:function(b,
c,d){a.sharedContextRpc.set("context",b).then(c).catch(d)}};return{init:function(c,d){r=d;a.events.isTriggered(a.EVENT_INIT_CONTEXT)?a.main.initFailure("Context has already initialized",a.ERROR_TYPE_CONTEXT_INIT,{level:a.LOG_LEVEL_ERROR}):c.sharedContext&&g(d)?(t=a.CONTEXT_TYPE_SERVER,a.convert.toSharedContext(k,function(){b(k,c,d)}),a.events.once(a.EVENT_VISIT,function(){k.getUid(function(a){k.setUid(a)})})):c.sharedContext?(t=a.CONTEXT_TYPE_XDM,e(c).then(function(){a.convert.toSharedContext(m,function(){b(m,
c,d)})})):(t=a.CONTEXT_TYPE_STORAGE,b(u,c,d))},getContextAccessor:function(){return a.config.sharedContext?g()?k:m:u},getType:function(){return t},getValidContext:f,initUidAndContext:b,useServerApi:g,_testSetUserAgent:function(a){r=a}}}();a.checkRequirements=function(f){return a.utils.isString(f)&&0!==f.length?-1!==a.utils.getIEVersion(f)?(a.console.error("[checkRequirements]","Unsupported browser"),!1):a.store.check()?a.cookies.isEnabled()&&!a.cookies.check()?(a.log.info("cookies not accessible",
a.ERROR_TYPE_STORAGE_MISSING),!1):!0:(a.log.info("localStorage not found",a.ERROR_TYPE_STORAGE_MISSING),!1):(a.log.info('Invalid "userAgent" argument, got "'+f+'"',a.ERROR_TYPE_ARG_INVALID),!1)};a.preview=function(){function f(){if(a.domElements.selector("#frosmo-debug")[0])a.console.warn("[preview]",'Frosmo Preview iFrame "#frosmo-debug" already exists in the DOM');else{var b=w.createElement("iframe");b.id="frosmo-debug";b.src="about:blank";b.style.display="none";b.onload=function(){c=!0;var g;(g=
a.store.get("frosmo_preview_base_url"))?(g=a.utils.parseUri(g),g=g.host?"//"+g.host+g.path:a.config.baseUrl):g=a.config.baseUrl;var e=w.createElement("script");e.src=g+"preview/PreviewApp.js?_ts="+(new B).toISOString().slice(0,13).replace(/[T-]+/g,"");b.contentDocument.head.appendChild(e);b.contentWindow.baseURL=g;b.contentWindow.frosmo=v;a.cookies.set("frosmo_preview_tool",1);a.events.trigger(a.EVENT_PREVIEW_TOOL_ENABLE)};a.domElements.waitFor({selector:"body",timeout:2E4}).then(function(){w.body.appendChild(b)}).catch(function(b){a.console.warn("[preview]",
b)})}}function b(){var b=a.utils.parseUri(a.main.getCurrentBrowserData().href);return C("on"===b.queryKey.frosmo_preview_tool||b.anchor.match("frosmo_preview_tool=on")||a.cookies.get("frosmo_preview_tool"))}function e(b){var c=b.split(":");if(3===c.length&&a.utils.every(c,a.utils.isPositiveInteger))return{positionId:H(c[0]),messageId:H(c[1]),revisionId:H(c[2])};a.console.error("[preview]",'Invalid preview params string, for "'+b+'"')}function h(b,c){return new a.Promise(function(e,f){var h=a.utils.addQueryString(a.api.getApiUrl(b),
a.utils.extend({origin:a.config.api.origin,ws:a.internal.getWorkspaceId(),_source:"core",_ts:B.now()},c));a._jsonp.request(h,function(b){if(b.error){switch(b.error){case "Not logged in":case "Invalid site":b=a.internal.createLogError('Select the site origin "'+a.config.api.origin+'" in the Frosmo Platform, to allow previewing',a.ERROR_TYPE_INIT,b);break;case "Revision not found":var c=a.utils.parseUri(h);b=a.internal.createLogError('Invalid previewing "revision id" of "'+c.queryKey.revisionId+'"',
a.ERROR_TYPE_ARG_INVALID,b);break;default:b=a.internal.createLogError(b.error,a.ERROR_TYPE_EXCEPTION,b)}f(b)}else e(b)})})}var c=!1;return{init:function(){b()&&f()},enable:f,disable:function(){h("preview",{method:"disable"}).finally(function(){c=!1;a.events.trigger(a.EVENT_PREVIEW_TOOL_DISABLE);a.cookies.remove("frosmo_preview_tool");var b=a.domElements.selector("#frosmo-debug")[0];b&&b.parentElement&&b.parentElement.removeChild(b)})},isEnabled:function(){return c},isLoadable:b,createParams:e,getParams:function(){var b=
a.main.getCurrentBrowserData().href,b=a.utils.parseUri(b);return b.queryKey.frosmo_preview&&a.utils.isString(b.queryKey.frosmo_preview)?e(X(b.queryKey.frosmo_preview)):void 0},requestMessage:function(b){return h("message",a.utils.extend({method:"preview"},b))},requestPreviewData:function(){return h("preview",{method:"previewData",enable:"1"})}}}();a.convert=function(){return{convert:function(f){return!a.versionAtLeast("1.0",f.VERSION)||f.lastVisit&&f.lastVisit.time&&31536E6<B.now()-f.lastVisit.time?
a.defaultContext.clone():f},toSharedContext:function(f,b){function e(){a.store.remove("UID");a.store.remove("context");b()}var h=a.store.get("context"),c=a.store.get("UID");h&&c?h.origin!==a.config.api.origin?b():(a.uid.set(c),f.setUid(c,function(){f.setContext(h,e);a.log.info("Migrated local context to shared context","context.migration")})):e()}}}();(function(){var f=0;a.defaultContext={VERSION:"1.0",UID:null,loginId:null,lastLoginId:void 0,profile:void 0,origin:null,firstVisit:null,lastPageView:{time:0},
lastVisit:{source:"",time:0},pageVisits:{},siteVisits:[],segments:{},states:{session:{}},referer:{host:null,path:null},landingpage:{host:null,path:null},landingPages:{},linkClicks:{},metaCount:{},metaData:{keywords:null,description:null,ogtitle:null,ogdescription:null},country:{country:"",country2:"",latitude:0,longitude:0,city:"",time:0},userAgent:"",segmentChanged:0,lastRuleActions:{},site:{},counts:{},removeFunctions:function(a){delete a.save;delete a.clone;delete a.removeFunctions;delete a.addFunctions},
addFunctions:function(a){a.save=this.save;a.clone=this.clone;a.removeFunctions=this.removeFunctions;a.addFunctions=this.addFunctions},save:function(b,e,h){e=a.utils.isFunction(e)?e:function(){};if(a.contextLoader.useServerApi()){if(b&&0===f){e();return}if(!b){f++;return}f=0}b=a.utils.clone(this);this.removeFunctions(b);a.contextLoader.getContextAccessor().setContext(b,e,h)},clone:function(){var b=a.utils.clone(this);this.addFunctions(b);return b},customActions:{},segmentEvents:{enter:{},leave:{}},
conversions:{},sessionPathVisits:{},messageDisplayIntervalTimestamps:{},messageDisplayTimes:{}}})();a.conversion=function(){function f(b,c,d){d=0<=d?d:0;c||a.log.warn("easy.conversion.evaluateDefinitions",a.ERROR_TYPE_DEPRECATED+".conversion_module",{module:a.internal.getCurrentModule(),debug:v.JSON.stringify({conversionsCount:a.conversions.length,productsCount:a.products.length,expectedCount:d,callerModuleName:"direct",triggerId:a.utils.isObject(b)?b.id:0})});a.utils.each(m,function(c){if(a.conversionEvaluator.evaluateDefinition(c)||
a.conversionEvaluator.evaluateTrigger(c,b))d+=1,a.conversions.push({conversion_id:c.conversionId,conversion_type:c.conversionType,conversion_value:c.conversionValue,conversion_name:c.conversionId})});a.conversion.handleConversionArray(c,d)}function b(b,d){var g=[];d=0<=d?d:0;a.conversions.length>d&&a.log.warn("easy.conversion.handleConversionArray (global array contains conversions)",a.ERROR_TYPE_DEPRECATED+".conversion_module",{module:a.internal.getCurrentModule(),debug:v.JSON.stringify({conversionsCount:a.conversions.length,
productsCount:a.products.length,expectedCount:d,callerModuleName:b||"direct"})});var e=l(a.conversions,n.conversion);a.conversions=[];b||a.log.warn("easy.conversion.handleConversionArray (external call)",a.ERROR_TYPE_DEPRECATED+".conversion_module",{module:a.internal.getCurrentModule(),debug:v.JSON.stringify({conversionsCount:a.conversions.length,productsCount:a.products.length,expectedCount:d,callerModuleName:"direct"})});a.utils.each(e,function(b){b.conversion_id!==b.conversion_name&&a.api.setConversionData(b.conversion_id,
{productType:b.conversion_type,productName:b.conversion_name});a.api.buyProduct(null,b.conversion_type,b.conversion_id,b.conversion_value,null,null,b.payment_channel,b.custom_id,null,b.conversion_quantity);a.console.log("[conversion]",'Conversion sent with the product type "'+b.conversion_type+'" and product name "'+b.conversion_name+'"');var d=b.conversion_type||"undefined";a.visitsHistory.addConversion(d,b.conversion_id,new B);g.push(d);g.push(d+" "+b.conversion_id);a.events.trigger(a.EVENT_CONVERSION,
c(b))});0<e.length&&(a.context.save(),a.segmentchange.evaluate({conversion:g},new B))}function e(b,c){c=0<=c?c:0;a.products.length>c&&a.log.warn("easy.conversion.handleProductArray (global array contains products)",a.ERROR_TYPE_DEPRECATED+".conversion_module",{module:a.internal.getCurrentModule(),debug:v.JSON.stringify({conversionsCount:a.conversions.length,productsCount:a.products.length,expectedCount:c,callerModuleName:b||"direct"})});var e=l(a.products,n.product);a.products=[];b||a.log.warn("easy.conversion.handleProductArray (external call)",
a.ERROR_TYPE_DEPRECATED+".conversion_module",{module:a.internal.getCurrentModule(),debug:v.JSON.stringify({conversionsCount:a.conversions.length,productsCount:a.products.length,expectedCount:c,callerModuleName:"direct"})});a.utils.each(e,function(b){var c=d(b);a.api.setProductData(b.product_id,c);a.console.log("[conversion]",'Product sent with the product type "'+c.productType+'" and product name "'+c.productName+'"');a.events.trigger(a.EVENT_PRODUCT_DATA,g(b))})}function h(b){var c=a.domElements.selector("div.frosmo-conversion",
b),d;d=a.utils.map(c,t);d=l(d,n.conversion);a.utils.isEmpty(c)||a.log.warn("easy.conversion.parseHtml -> _parseConversions",a.ERROR_TYPE_DEPRECATED+".conversion_module",{module:a.internal.getCurrentModule(),count:d.length,elements:c.length});ba.prototype.push.apply(a.conversions,d);b=a.domElements.selector("div.frosmo-product",b);c=a.utils.map(b,r);c=l(c,n.product);a.utils.isEmpty(b)||a.log.warn("easy.conversion.parseHtml -> _parseProducts",a.ERROR_TYPE_DEPRECATED+".conversion_module",{module:a.internal.getCurrentModule(),
count:c.length,elements:b.length});ba.prototype.push.apply(a.products,c)}function c(b){var c={};a.utils.each(b,function(a,b){c[b.replace(/^conversion_/,"")]=a});c.products=[{id:c.id,value:c.value,quantity:c.quantity}];return c}function d(b){var c="product_categories product_colors product_custom_images product_data product_ids product_multi_prices".split(" "),d={};a.utils.each({productName:"product_name",productImage:"product_image",productPrice:"product_price",productType:"product_type",productUrl:"product_url",
productArea:"product_area",productCampaign:"product_campaign",productCategories:"product_categories",productCategory:"product_category",productCity:"product_city",productColors:"product_colors",productCompany:"product_company",productConversion:"product_conversion",productCountry:"product_country",productCustomImages:"product_custom_images",productData:"product_data",productDescription:"product_description",productDiscountPrice:"product_discount_price",productIds:"product_ids",productManufacturer:"product_manufacturer",
productModel:"product_model",productMultiPrices:"product_multi_prices",productPromotionLabel:"product_promotion_label",productRating:"product_rating",productStock:"product_stock",productSubCategory:"product_sub_category",productUrn:"product_urn",productVenue:"product_venue"},function(g,e){void 0!==b[g]&&(d[e]=!a.utils.isString(b[g])&&a.utils.inArray(c,g)?v.JSON.stringify(b[g]):b[g])});return d}function g(b){var c=/^product_/,d={};a.utils.each(b,function(a,b){d[b.replace(c,"")]=d[b]=a});return d}function l(b,
c){return a.utils.filter(b,function(a){return k(a,c)})}function q(b,c){return a.utils.every(c,function(a){return I.prototype.hasOwnProperty.call(b,a)})}function t(a){return u(a,n.conversion)}function r(a){return u(a,n.product)}function u(b,c){var d={};a.utils.each(a.domElements.selector("span",b),function(b){var g=b.getAttribute("class");(a.utils.inArray(c.required,g)||a.utils.inArray(c.optional,g))&&(b=a.utils.trim(b.innerHTML))&&(d[g]=b)});return q(d,c.required)?d:null}function k(b,c){if(!b||!q(b,
c.required))return null;a.utils.each(b,function(d,g){a.utils.inArray(c.optional,g)||a.utils.inArray(c.required,g)||delete b[g]});return b}a.conversions=a.conversions||[];a.products=a.products||[];var m=[],n={product:{required:"product_id product_name product_image product_price product_type product_url".split(" "),optional:"product_area product_campaign product_categories product_category product_city product_colors product_company product_conversion product_country product_custom_images product_data product_description product_discount_price product_ids product_manufacturer product_model product_multi_prices product_part_payment product_promotion_label product_rating product_stock product_sub_category product_urn product_venue".split(" ")},
conversion:{required:["conversion_id","conversion_name","conversion_type","conversion_value"],optional:["payment_channel","custom_id","conversion_quantity"]}};return{init:function(b){a.utils.isEmpty(b)||(m=b,a.events.on(a.EVENT_TRIGGER_FIRE,function(a){f(a,"conversion_module",0)}))},evaluateDefinitions:f,handle:function(c,d,g){g=0<=g?g:0;d||a.log.warn("easy.conversion.handle",a.ERROR_TYPE_DEPRECATED+".conversion_module",{module:a.internal.getCurrentModule(),debug:v.JSON.stringify({conversionsCount:a.conversions.length,
productsCount:a.products.length,expectedCount:g,callerModuleName:"direct"})});a.domEvents.ready(function(){f(void 0,d,g);h(c);e(d,g);b(d,g)})},handleConversionArray:b,handleProductArray:e,parseHtml:h}}();a.conversionEvaluator=function(){function f(b){var f=a.visitsHistory.getConversionLastTime(b.conversionType,b.conversionId);return f?f+b.interval<=a.utils.getTimestamp():!0}var b={matchUrl:function(b,f,c,d){var g=a.main.getCurrentBrowserData().href,g=a.utils.getLocationFromUrl(g);return a.evaluator.matchUrl(b,
f,c,d,g)},matchRefererUrl:function(b,f,c){var d=a.main.getCurrentBrowserData().referer,d=a.utils.getLocationFromUrl(d);return a.evaluator.matchUrl(b,f,c,{},d)},matchHtmlElement:function(b,f){f=f||w;return C(a.domElements.selector(b,f)[0])}};return{evaluateDefinition:function(e){if(e.rules&&f(e)){var h=new a.baseEvaluator;a.utils.each(b,function(a,b){h.addEvaluatorFunction(b,a)});return h.evaluate(e.rules)}return!1},evaluateTrigger:function(a,b){return a&&b&&a.triggerId===b.id&&f(a)}}}();a.sharedCode=
function(){function f(b,c){a.utils.each(b,function(b){var g={args:a.utils.extend({easy:v.easy,site:v.site,sharedCode:{id:b.id},triggerEventData:void 0},c),guardOptions:{type:a.ERROR_TYPE_SHARED_CODE_EXCEPTION,level:a.LOG_LEVEL_ERROR,module:a.MODULE_SHARED_CODE,sharedCodeId:b.id},scriptNamespace:a.SHARED_CODE_ID+b.id};a.internal.safeEval(b.content,g)})}function b(b){a.utils.each(b.triggers,function(a){(a=e[a.id])&&f(a,{triggerEventData:b.data})})}var e={};return{init:function(h){var c=[];a.utils.each(h,
function(a){0<a.triggerId?(e[a.triggerId]=e[a.triggerId]||[],e[a.triggerId].push(a)):c.push(a)});f(c);a.events.on(a.EVENT_TRIGGER_EVENT,b)},clear:function(){e={};a.events.off(a.EVENT_TRIGGER_EVENT,b)}}}();a.message=function(){function f(){return a.utils.map(m,b)}function b(a){return n[a]}function e(b,c){c=a.utils.extend({},c);c.restoreMessage=a.utils.isBoolean(c.restoreMessage)?c.restoreMessage:a.spa.isEnabled();c.trackMessage=a.utils.isBoolean(c.trackMessage)?c.trackMessage:!0;c.onRender=function(){c.trackMessage&&
p.push(b)};b.isPopup()?a.popup.render(b,c):b.render(c)}function h(){a.utils.each(k,function(a){a.cancel()});k=[]}function c(){a.utils.each(p,function(a){(a=a.getMessageInstance())&&a.clearTimers()})}function d(b,c){var d={};return[a.utils.map(b,function(b){d[b.position]=new a.positionData(a.utils.clone(b),c);return b.position}),d]}function g(b){var c,d=H.MAX_VALUE;a.utils.each(b,function(a){a.isPopup()&&a.priorityLevel<d&&(c=a,d=a.priorityLevel)});return a.utils.filter(b,function(a){var b=a.isPopup();
return!b||b&&c===a})}function l(b){b={method:"multifetch",origin:a.config.api.origin,cookieId:a.uid.get(),positions:b.join("."),states:v.JSON.stringify(a.states.getAll()),debug:a.isDev(),_source:"core",_ts:B.now(),_ver:a.getVersion()};var c=a.user.getLastLoginId();c&&(b.loginId=c);a.context.segments&&(b.segments=a.internal.getSegmentIds(a.context.segments));if(c=a.context.lastVisit.source)b.source=c;if(c=a.api.getSessionStart())b.sessionStart=c;if(c=a.internal.getProfile())b.profile=c;c=a.internal.getWorkspaceId();
0<c&&(b.ws=c);return b}function q(b){if(a.isReady())if(a.events.isTriggered(a.EVENT_SEGMENTS_READY)){b=b||{};a.events.trigger(a.EVENT_MESSAGE_REQUEST);var c=a.main.getCurrentBrowserData().href,g=m,e=n;if(b.positions)var f=d(b.positions,c),g=f[0],e=f[1];f=a.utils.filter(g,function(b){var d=n[b];return(d=d?d.getMessageInstance():void 0)&&d.getType()===a.MESSAGE_TYPE_CACHED?!1:c&&e[b].isMatchingUrl(c)});0===f.length?a.console.warn("[message]","Requesting of messages was skipped, due to no active positions"):
(g=a.utils.map(f,function(a){return e[a]}),b.cancelPending&&h(),f=l(f),g=a.fetch.get(a.api.getApiUrl("message"),{params:f,timeout:b.timeout||5E3,success:t(g,u,f),error:function(b,c,d,g){a.events.trigger(a.EVENT_MESSAGE_FAILURE);a.log.warn("Unexpected error occurred with requesting messages","message_"+d.type,{module:a.internal.getCurrentModule(),debug:g})}}),b.cancelPending&&k.push(g))}else a.events.once(a.EVENT_SEGMENTS_READY,function(){q(b)});else a.ready(function(){q(b)})}function t(b,c,d){return function(e){if(c&&
c!==u)a.log.warn("Initialization of messages is already in progress",a.ERROR_TYPE_MESSAGE_INIT);else if(a.utils.isArray(e.messages)){a.events.trigger(a.EVENT_MESSAGE_RECEIVE,b);b=a.utils.filter(b,function(b,c){var d=e.messages[c];if(a.internal.isMessage(d))return b.setMessage(d),!0;b.show();return!1});a.events.trigger(a.EVENT_MESSAGE_SUCCESS,b);b=g(b);var f=b.reverse(),l=a.guard(a.message.show,{module:a.MODULE_MESSAGE});a.utils.each(f,l)}else a.log.error("Invalid response for Message API. Debugging for Product Team",
a.ERROR_TYPE_MESSAGE_INIT,{debug:v.JSON.stringify({params:d,response:e,gotInitId:u,wantInitId:c})})}}function r(){a.utils.each(m,function(a){n[a].show()})}var u=0,k=[],m=[],n={},p=[],J={};return{init:function(b){u+=1;b=b&&b.positions?b.positions:a.config.positions;var c=a.main.getCurrentBrowserData().href;b=d(b,c);m=b[0];n=b[1];a.events.trigger(a.EVENT_MESSAGE_INIT);a.events.once(a.EVENT_INIT_FAILURE,r);a.events.on(a.EVENT_MESSAGE_FAILURE,r)},addCustomRenderer:function(b,c){if(J[b])return a.log.error('Renderer name "'+
b+'" is already defined',a.ERROR_TYPE_RENDERER_INVALID),!1;if(!a.utils.isString(b))return a.log.error('Invalid type for renderer "name" argument, got "'+a.utils.getType(b)+'" for "'+b+'". Expected string type',a.ERROR_TYPE_RENDERER_INVALID),!1;if(!a.utils.isFunction(c))return a.log.error('Invalid type for renderer "fn" argument, got "'+a.utils.getType(c)+'" for "'+c+'". Expected function type',a.ERROR_TYPE_RENDERER_INVALID),!1;J[b]=c;return!0},getCustomRenderer:function(a){return J[a]},clear:function(){h();
a.utils.each(p.reverse(),function(a){a.clear()});p=[];a.utils.each([a.EVENT_MESSAGE_CLICK,a.EVENT_MESSAGE_SHOW,a.EVENT_MESSAGE_TRUE_DISPLAY,a.EVENT_MESSAGESHOW_COMPLETE,a.EVENT_MESSAGESHOW_FAILED],a.events.clearEvent);a.events.off(a.EVENT_INIT_FAILURE,r)},getActivePositions:function(b){var c=a.main.getCurrentBrowserData().href;b=a.utils.filter(b||f(),function(a){return a.isMatchingUrl(c)});return a.utils.map(b,function(a){return{position:a.position}})},getPositions:f,getPosition:b,requestMessages:function(b){c();
var d=a.preview.getParams();d?a.message.requestPreview(d):q(b)},requestPreview:function(b){b&&a.preview.requestMessage(b).then(function(c){var d=n[b.positionId];d?(d.setMessage(c.content),e(d,{excludeTrigger:!0,trackMessage:!1})):a.console.error("[message]",'Invalid previewing "position id" of '+b.positionId)}).catch(function(b){a.console.error("[message]",b)})},show:e,updatePositions:function(b){a.utils.each(b,function(b){b instanceof a.positionData&&n[b.position]&&(n[b.position]=b)})}}}();(function(){function f(a){a&&
a.parentNode&&a.parentNode.removeChild(a)}function b(b,d){b.removeAttribute("class");d.cssClasses.length&&a.utils.addClassName(b,d.cssClasses);b.removeAttribute("style");d.cssText&&(b.style.cssText=d.cssText);b.id=d.id;b.removeAttribute("data-frosmo-message-id");b.removeAttribute("data-frosmo-position-id")}var e=0,h={value:!0};a.messageInstance=function(b){if(!(this instanceof a.messageInstance))throw new x('"easy.messageInstance" cannot be called as a function. Use the "new" keyword to construct a new "Message" instance');
if(!a.internal.isMessage(b.message))throw new x('Invalid type for "message" property, got "'+a.utils.getType(b.message)+'" for '+this.id);a.utils.extend(this,b.message);I.defineProperty(this,"positionData",{configurable:!0,writable:!0,value:b});this._displayDelayIds=[];this._elementCount=a.utils.isNumber(a.config.messageMaxElements)&&0<a.config.messageMaxElements?a.config.messageMaxElements:50;this._origClickOrSubmitEvents=[];this._origElementsData=[];this._elements=[];this._trackableElements=[];
this._middleButton=void 0;this._type=a.utils.some(a.config.quickMessages,function(a){return this.id===a.id},this)?a.MESSAGE_TYPE_CACHED:a.MESSAGE_TYPE_BASIC;this._uniqueId=++e;this.setRestorable(!1);this._clearFns=[];this.setTrackable(!0)};a.messageInstance.prototype.isShowable=function(){return this._hasMaxDisplays()||!this._hasElapsedDisplayInterval()?!1:this._createElements()};a.messageInstance.prototype.insertHtml=function(b,d){void 0===b&&(b=this.content);a.utils.each(this._elements,function(g,
e){var f=this._createParams(a.utils.extend({messageOptions:void 0,messageWrapperIndex:e},d));a.domElements.html(g,b,f)},this)};a.messageInstance.prototype.isRendered=function(){return C(this._isRendered)};a.messageInstance.prototype.show=function(){if(this.isRendered()||!this.isShowable())return!1;var b=1E3*this.options.displayDelay||0;if(0<b){var d=a.guard(this._showRevision,this._createGuardOptions(!1,!0));this._displayDelayIds.push(a.utils.setTimeout(d,b))}else this._showRevision();I.defineProperty(this,
"_isRendered",h);return!0};a.messageInstance.prototype.trackingEvent=function(b){a.tracking?a.tracking.event(b,{modificationId:this.id,variationId:this.revision}):this._logSend('Enable the tracking module, so the action "'+b+'" can be tracked',a.ERROR_TYPE_MODULE_MISSING,a.LOG_LEVEL_WARNING)};a.messageInstance.prototype._showRevision=function(){this.isHidden()?this._showHiddenRevision():this._useTemplatePreRenderer()?this._preRenderTemplate():(this._showNormalRevision(),a.uihooks.initLinks(a.config.links),
a.uihooks.initForms(a.config.forms))};a.messageInstance.prototype._showHiddenRevision=function(){var b=this.positionData.getHiddenRenderer();b?this._callRenderer(b,this._elements[0]):this.startTracking();a.console.info("[messageRendered]","position_id."+this.positionData.position+", message_id."+this.id+", revision_id."+this.revision,this.positionData)};a.messageInstance.prototype._showNormalRevision=function(b){this.content=this.positionData.message.content=this.getContent(b);var d=this.positionData.getRenderer();
if(!a.utils.isEmpty(this.content)||d)this.isRestorable()&&(this._origElementsData=a.utils.map(this._origElementsData,this._backupElements,this)),a.utils.each(this._elements,function(g,e){this.positionData.method===this.positionData.METHOD_RENEW&&f(g.nextSibling);if(d)this._callRenderer(d,g);else{var h=this._createParams({messageOptions:b,messageWrapperIndex:e});a.domElements.html(g,this.content,h);this.positionData.show();this.startTracking()}},this),a.console.info("[messageRendered]","position_id."+
this.positionData.position+", message_id."+this.id+", revision_id."+this.revision,this.positionData)};a.messageInstance.prototype._preRenderTemplate=function(){var b=this._getTemplatePreRenderer(),d=this._createParams({templateInstance:{name:this.template.variable,options:this._getTemplateDefaults(),render:a.guard(this._showNormalRevision,this._createGuardOptions(!1,!0))}},a.MESSAGE_PRE_RENDERER_SCRIPT_ID);a.internal.safeEval(b,d)};a.messageInstance.prototype.clear=function(){if(!this.isRestorable())return!1;
a.utils.each(this._clearFns,function(a){a()});this._clearFns=[];this.clearTimers();var b=this._getTrackableElements();a.domEvents.off(b,"click."+a.DOM_EVENT_NAMESPACE,'a, area, button, input[type="button"], input[type="image"], input[type="submit"], .frosmo-click',this._onClick);a.domEvents.off(b,"click."+a.DOM_EVENT_NAMESPACE,this._onClick);a.domEvents.off(b,"mousedown."+a.DOM_EVENT_NAMESPACE,"a, area",this._onMiddleClick);a.domEvents.off(b,"mouseup."+a.DOM_EVENT_NAMESPACE,"a, area",this._onMiddleClick);
a.utils.each(this._origClickOrSubmitEvents,function(a){a[0][a[1]]=a[2]});a.events.off(a.EVENT_MESSAGE_CLICK,this._onClickEvent);a.events.off(a.EVENT_MESSAGE_TRUE_DISPLAY,this._onTrueDisplayEvent);a.messageTrueDisplay.clearId(this.positionData.message,this.positionData);a.utils.each(b,this._restoreElements,this);a.utils.each(a.domElements.selector("."+a.MESSAGE_SCRIPT_ID+this.id),f);a.domElements.removeStyles(void 0,a.MESSAGE_STYLE_ID+this.id);this._origClickOrSubmitEvents=[];this._origElementsData=
[];this._elements=[];this._trackableElements=[];return!0};a.messageInstance.prototype.onClear=function(b){if(a.utils.isFunction(b)){var d=this._createGuardOptions(!0,!0);this._clearFns.push(a.guard(b,d))}else this._logSend('Invalid type for "fn" argument, got "'+a.utils.getType(b)+'" for "'+b+'". Expected function type',a.ERROR_TYPE_ARG_INVALID,a.LOG_LEVEL_ERROR)};a.messageInstance.prototype.clearTimers=function(){a.utils.each(this._displayDelayIds,V);this._displayDelayIds=[]};a.messageInstance.prototype._backupElements=
function(a){switch(this.positionData.method){case this.positionData.METHOD_HIDE:case this.positionData.METHOD_REPLACE:for(var b=this._createElement();a.el.hasChildNodes();)b.appendChild(a.el.firstChild);a.el=b}return a};a.messageInstance.prototype._restoreElements=function(a,d){if(a){var g=this._origElementsData[d];switch(this.positionData.method){case this.positionData.METHOD_RENEW:if(!g)break;if(this.isHidden()){b(a,g);break}a.parentNode&&a.parentNode.insertBefore(g.el,a);f(a);break;case this.positionData.METHOD_HIDE:case this.positionData.METHOD_REPLACE:if(!g)break;
b(a,g);if(this.isHidden())break;for(;a.hasChildNodes();)a.removeChild(a.lastChild);for(;g.el.hasChildNodes();)a.appendChild(g.el.firstChild);break;default:f(a)}}};a.messageInstance.prototype._applyContainerStyles=function(b){var d=/;\s*$/;return a.utils.map(b,function(b){this.positionData.cssClasses&&a.utils.addClassName(b,this.positionData.cssClasses);if(this.positionData.cssText){var c=b.style.cssText||"",e=c&&!d.test(c)?";":"";b.style.cssText=c+e+this.positionData.cssText}b.id=b.id||"frosmo_message_id_"+
this._uniqueId;a.utils.addClassName(b,["frosmo_inline","frosmo_message_"+this.id,"frosmo_position_"+this.positionData.position]);b.setAttribute("data-frosmo-message-id",this.id);b.setAttribute("data-frosmo-position-id",this.positionData.position);return b},this)};a.messageInstance.prototype._createElements=function(){if(this._elements.length)return!0;var b=this.positionData.getElements();if(0===b.length)return this._elements=[],!1;var d=this.isHidden(),g=this.positionData.method===this.positionData.METHOD_RENEW;
this.positionData.method===this.positionData.METHOD_REPLACE||this.positionData.method===this.positionData.METHOD_HIDE?(d=b,this._origElementsData=this._getElementsData(b)):g?(d=d?b:this._createContainers(b),this._origElementsData=this._getElementsData(b)):d=d?[this._createElement()]:this._createContainers(b);this._elements=this._applyContainerStyles(d);this._elements.length>this._elementCount&&(this._origElementsData=this._origElementsData.slice(0,this._elementCount),this._elements=this._elements.slice(0,
this._elementCount),this._logSend("Selector matched "+this._elements.length+" elements",a.ERROR_TYPE_ELEMENTS_LONG,a.LOG_LEVEL_INFO));return 0<this._elements.length};a.messageInstance.prototype._createElement=function(b){var d="DIV LI P SPAN TD TH TR".split(" "),d=b&&b.tagName&&a.utils.inArray(d,b.tagName);return w.createElement(d?b.tagName:"DIV")};a.messageInstance.prototype._createContainers=function(b){return a.utils.map(b,function(b){var c=this._getRelatedContainer(b,this.positionData),e="frosmo_position_"+
this.positionData.position;return a.utils.inArray(a.utils.getClassNames(c),e)?c:this._createContainer(b,this.positionData)},this)};a.messageInstance.prototype._createContainer=function(a,b){var g;switch(b.method){case b.METHOD_RENEW:return g=this._createElement(a),a.parentNode.insertBefore(g,a),g;case b.METHOD_BEFORE:return g=this._createElement(a),a.parentNode.insertBefore(g,a),g;case b.METHOD_AFTER:for(g=a.nextSibling;g&&g.nodeType!==S.ELEMENT_NODE;)g=g.nextSibling;g=this._createElement(g);a.parentNode.insertBefore(g,
a.nextSibling);return g;case b.METHOD_PREPEND:for(g=a.firstChild;g&&g.nodeType!==S.ELEMENT_NODE;)g=g.nextSibling;g=this._createElement(g);a.insertBefore(g,a.firstChild);return g;case b.METHOD_APPEND:for(g=a.lastChild;g&&g.nodeType!==S.ELEMENT_NODE;)g=g.previousSibling;g=this._createElement(g);a.appendChild(g);return g;default:return g}};a.messageInstance.prototype._getRelatedContainer=function(a,b){switch(b.method){case b.METHOD_BEFORE:return a.previousSibling;case b.METHOD_AFTER:return a.nextSibling;
case b.METHOD_PREPEND:if(a.childNodes.length)return a.childNodes[0];break;case b.METHOD_APPEND:if(a.childNodes.length)return a.childNodes[a.childNodes.length-1]}};a.messageInstance.prototype._getElementsData=function(b){return a.utils.map(b,function(b){return{cssClasses:a.utils.getClassNames(b),cssText:b.style.cssText,el:b,id:b.id}})};a.messageInstance.prototype.isClicked=function(){return C(this._isClicked)};a.messageInstance.prototype.startClickTracking=function(){if(this._hasClickTracking||!this.isTrackable()||
this.isHidden()&&!this._isHiddenTrackable("click"))return!1;I.defineProperty(this,"_hasClickTracking",h);var b=this._getTrackableElements();a.utils.each(b,this._clickEventHandlers,this);a.events.on(a.EVENT_MESSAGE_CLICK,this._onClickEvent,this);return!0};a.messageInstance.prototype.setClicked=function(){if(this.isClicked()||!this.isTrackable())return!1;I.defineProperty(this,"_isClicked",h);a.ready(function(){a.api.clickMessage(null,this.id,this.revision);a.events.trigger(a.EVENT_MESSAGE_CLICK,this.positionData.message);
a.console.info("[messageClick]","position_id."+this.positionData.position+", message_id."+this.id+", revision_id."+this.revision,this.positionData)},this);this.setTrueDisplayed();return!0};a.messageInstance.prototype._isTrackingDisabled=function(a){return/(close|fb_button|frosmo-no-click)/i.test(a.className)};a.messageInstance.prototype._clickEventHandlers=function(b){this._middleButton=void 0;a.domEvents.on(b,"click."+a.DOM_EVENT_NAMESPACE,'a, area, button, input[type="button"], input[type="image"], input[type="submit"], .frosmo-click',
this._onClick,this);if(a.domElements.matches(b,'a, area, button, input[type="button"], input[type="image"], input[type="submit"], .frosmo-click'))a.domEvents.on(b,"click."+a.DOM_EVENT_NAMESPACE,this._onClick,this);a.domEvents.on(b,"mousedown."+a.DOM_EVENT_NAMESPACE,"a, area",this._onMiddleClick,this);a.domEvents.on(b,"mouseup."+a.DOM_EVENT_NAMESPACE,"a, area",this._onMiddleClick,this);a.utils.each(a.domElements.selector("a, area, form",b),this._onClickOrSubmit,this)};a.messageInstance.prototype._onClick=
function(a,b){this._isTrackingDisabled(b)||this.setClicked()};a.messageInstance.prototype._onClickEvent=function(a){this.id!==a.id||this.revision!==a.revision||this.isClicked()||I.defineProperty(this,"_isClicked",h)};a.messageInstance.prototype._onClickOrSubmit=function(b){if(!this._isTrackingDisabled(b)){var d="FORM"===b.tagName?"onsubmit":"onclick",g=b[d];this.isRestorable()&&this._origClickOrSubmitEvents.push([b,d,g]);var e=this._createGuardOptions(!1,!0);b[d]=a.guard(function(e){this.setClicked();
b[d]=g;return a.utils.isFunction(g)?g.call(this,e):void 0},e)}};a.messageInstance.prototype._onMiddleClick=function(a,b){this._isTrackingDisabled(b)||1!==a.button||("mousedown"===a.type?this._middleButton=b:"mouseup"===a.type&&this._middleButton===b&&(this._middleButton=void 0,this.setClicked()))};a.messageInstance.prototype.isDisplayed=function(){return C(this._isDisplayed)};a.messageInstance.prototype.setDisplayed=function(){if(this.isDisplayed()||!this.isTrackable())return!1;I.defineProperty(this,
"_isDisplayed",h);a.ready(function(){a.api.showMessage(null,this.id,this.revision);a.events.trigger(a.EVENT_MESSAGE_SHOW,this.positionData.message);a.console.info("[messageDisplay]","position_id."+this.positionData.position+", message_id."+this.id+", revision_id."+this.revision,this.positionData)},this);this._setDisplayIntervalTimestamp();this._incrMaxDisplays();return!0};a.messageInstance.prototype.isTrueDisplayed=function(){return C(this._isTrueDisplayed)};a.messageInstance.prototype.startTrueDisplayTracking=
function(){if(this._hasTrueDisplayTracking||!this.isTrackable()||this.isHidden()&&!this._isHiddenTrackable("true display"))return!1;I.defineProperty(this,"_hasTrueDisplayTracking",h);var b=this._getTrackableElements();a.messageTrueDisplay.start(this.positionData.message,this.positionData,b);a.events.on(a.EVENT_MESSAGE_TRUE_DISPLAY,this._onTrueDisplayEvent,this);return!0};a.messageInstance.prototype.setTrueDisplayed=function(){if(this.isTrueDisplayed()||!this.isTrackable())return!1;I.defineProperty(this,
"_isTrueDisplayed",h);a.ready(function(){a.messageTrueDisplay.logInstantly(this.id,this.revision)},this);return!0};a.messageInstance.prototype._onTrueDisplayEvent=function(a){this.id!==a.id||this.revision!==a.revision||this.isTrueDisplayed()||I.defineProperty(this,"_isTrueDisplayed",h)};a.messageInstance.prototype.startTracking=function(){a.ready(function(){this.setDisplayed();this.startClickTracking();this.startTrueDisplayTracking()},this)};a.messageInstance.prototype.setTrackableElements=function(b){this._trackableElements=
a.utils.isArray(b)?b:[b]};a.messageInstance.prototype._getTrackableElements=function(){return this._elements.concat(this._trackableElements)};a.messageInstance.prototype.getTemplateDefaults=function(){return this.template?this.template.defaults:null};a.messageInstance.prototype.insertTemplate=function(a,b,g){this.insertHtml(this.getContent(a,b),g)};a.messageInstance.prototype._hasTemplate=function(){return this.template&&this.template.active};a.messageInstance.prototype._getTemplateDefaults=function(){return a.utils.isObject(this.template.defaults)?
this.template.defaults:v.JSON.safeParse(this.template.defaults,null)};a.messageInstance.prototype._setTemplateDefaults=function(){var b=this._getTemplateDefaults();this._useTemplateContent()||this._useTemplateExport()||(b=a.utils.getByDotString(this.template.variable)||b,a.utils.isEmpty(b)&&(b=null));this.template.defaults=b;this.positionData.message.template=this.template};a.messageInstance.prototype._getTemplateContent=function(){if(this._useTemplateContent())return this.template.content;if(this._useTemplateExport())return a.config.templates[this.template.variable]};
a.messageInstance.prototype._useTemplateContent=function(){return C(this.template.content)};a.messageInstance.prototype._getTemplatePreRenderer=function(){if(this.template.preRenderer)return this.template.preRenderer;if(a.config.templatePreRenderers&&a.config.templatePreRenderers[this.template.variable])return a.config.templatePreRenderers[this.template.variable]};a.messageInstance.prototype._useTemplatePreRenderer=function(){return this._hasTemplate()&&C(this._getTemplatePreRenderer())};a.messageInstance.prototype._useTemplateExport=
function(){return C(a.config.templates&&a.config.templates[this.template.variable])};a.messageInstance.prototype._callRenderer=function(b,d){a.messageTrueDisplay.setData(this.positionData.message,this.positionData,d);var g=this,e=this._createGuardOptions(!0,!0);return a.runGuarded(b,[this.positionData,this.positionData.message,d,function(){g.startTracking()}],e)};a.messageInstance.prototype.getContent=function(b,d){if(!this._hasTemplate())return this.content;if(!a.template)return this._logSend("Template module not found",
a.ERROR_TYPE_MODULE_MISSING,a.LOG_LEVEL_CRITICAL),this.content;if(!this.template.variable)return this._logSend("Template variable is missing",a.ERROR_TYPE_TEMPLATE_MISSING,a.LOG_LEVEL_ERROR),null;this._setTemplateDefaults();var g=this._getTemplateContent()||this.content;if(!g)return this._logSend("Template content is missing",a.ERROR_TYPE_TEMPLATE_MISSING,a.LOG_LEVEL_ERROR),null;var e=b||this.getTemplateDefaults();if(!e)return this._logSend("Template defaults is missing",a.ERROR_TYPE_TEMPLATE_MISSING,
a.LOG_LEVEL_ERROR),null;var f=this._createGuardOptions();return a.template.render(g,e,d,void 0,f)};a.messageInstance.prototype.getElements=function(){return a.utils.arrayFrom(this._elements)};a.messageInstance.prototype.getType=function(){return this._type};a.messageInstance.prototype.isComparisonGroup=function(){return 999===this.revision};a.messageInstance.prototype.isHidden=function(){return"hidden"===this.revisionType};a.messageInstance.prototype.isRestorable=function(){return this._isRestorable};
a.messageInstance.prototype.setRestorable=function(a){this._isRestorable=C(a)};a.messageInstance.prototype.isTrackable=function(){return this._isTrackable};a.messageInstance.prototype.setTrackable=function(a){this._isTrackable=C(a)};a.messageInstance.prototype._createGuardOptions=function(b,d){return{type:a.ERROR_TYPE_MESSAGE_EXCEPTION,level:a.LOG_LEVEL_ERROR,module:a.MODULE_MESSAGE,messageId:this.id,revisionId:this.revision,positionId:this.positionData.position,rendererName:b&&this.positionData.hasRenderer()?
this.positionData.renderer:void 0,templateId:this.template&&this.template.variable?z(this.template.variable):void 0,context:d?this:void 0}};a.messageInstance.prototype._createParams=function(b,d){d||(d=a.MESSAGE_SCRIPT_ID);return{args:a.utils.extend({message:this.positionData.message,positionData:this.positionData,easy:v.easy,site:v.site},b),guardOptions:this._createGuardOptions(),scriptNamespace:d+this.id,styleNamespace:a.MESSAGE_STYLE_ID+this.id}};a.messageInstance.prototype._hasElapsedDisplayInterval=
function(){if(0<this.options.displayInterval&&0<=a.context.messageDisplayIntervalTimestamps[this.id]){var b=B.now()-a.context.messageDisplayIntervalTimestamps[this.id];return F.floor(b/1E3)>=this.options.displayInterval}return!0};a.messageInstance.prototype._setDisplayIntervalTimestamp=function(){0<this.options.displayInterval&&(a.context.messageDisplayIntervalTimestamps=a.context.messageDisplayIntervalTimestamps||{},a.context.messageDisplayIntervalTimestamps[this.id]=B.now(),a.context.save())};a.messageInstance.prototype._hasMaxDisplays=
function(){return 0<this.options.maxDisplayTimes&&a.context.messageDisplayTimes[this.id]>=this.options.maxDisplayTimes};a.messageInstance.prototype._incrMaxDisplays=function(){0<this.options.maxDisplayTimes&&(a.context.messageDisplayTimes=a.context.messageDisplayTimes||{},a.context.messageDisplayTimes[this.id]=(a.context.messageDisplayTimes[this.id]||0)+1,a.context.save())};a.messageInstance.prototype._isHiddenTrackable=function(b){var d=a.utils.inArray([this.positionData.METHOD_HIDE,this.positionData.METHOD_RENEW,
this.positionData.METHOD_REPLACE],this.positionData.method);d&&!a.config.hiddenMessageClickTracking&&a.console.warn(a.MODULE_MESSAGE,'Set "easy.config.hiddenMessageClickTracking" to true, so message_id.'+this.id+' will be tracked as "'+b+'"',this.positionData);return d&&a.config.hiddenMessageClickTracking};a.messageInstance.prototype._logSend=function(b,d,g){var e=this._createGuardOptions();delete e.type;e.level=g;a.log.send(b,d,e)}})();a.messageTrueDisplay=function(){function f(){a.utils.each(t,
e)}function b(b,c,d,g){t[c.position]={message:b,positionData:c,elements:a.utils.isArray(d)?d:[d],timerId:void 0,trackAutomatically:g,onScroll:void 0}}function e(b){if(b.trackAutomatically){var d=a.utils.some(b.elements,a.domElements.isVisible);d&&!b.timerId?b.timerId=a.utils.setTimeout(function(){l(b);g(b)},a.MESSAGE_TRUE_DISPLAY_TIME):d||c(b)}}function h(){a.utils.isEmpty(t)&&(na(r),r=void 0)}function c(a){a.timerId&&(V(a.timerId),a.timerId=void 0)}function d(b){b.onScroll||(b.onScroll=function(){e(b)},
a.domEvents.on(window,"scroll."+a.DOM_EVENT_NAMESPACE,b.onScroll))}function g(b){b.onScroll&&a.domEvents.off(window,"scroll."+a.DOM_EVENT_NAMESPACE,b.onScroll)}function l(b){var d=b.message,g=b.positionData,e=d.id+"-"+d.revision;q[e]||(q[e]=!0,a.ready(function(){a.api.trueDisplay(null,d.id,d.revision);a.events.trigger(a.EVENT_MESSAGE_TRUE_DISPLAY,d);a.console.info("[messageTrueDisplay]","position_id."+g.position+", message_id."+d.id+", revision_id."+d.revision,g)}));c(b);delete t[g.position];h()}
var q={},t={},r;return{checkAll:f,clear:function(){a.utils.each(t,g);a.utils.each(t,c);a.events.clearEvent(a.EVENT_MESSAGE_TRUE_DISPLAY);q={};t={};h()},clearId:function(a,b){var d=t[b.position];d&&(g(d),c(d));delete q[a.id+"-"+a.revision];delete t[b.position];h()},logInstantly:function(b,c){if(!q[b+"-"+c]){var d=a.utils.find(t,function(a){return b===a.message.id});d?(d.message.revision=c,l(d)):a.log.warn("True display not initialized for message",a.ERROR_TYPE_MESSAGE_INIT,{module:a.internal.getCurrentModule(),
messageId:b,revisionId:c})}},setData:b,start:function(c,g,e){e&&0!==e.length&&c&&g&&(b(c,g,e,!0),d(t[g.position]),f(),r||(r=a.utils.setInterval(f,1E3)))}}}();a.positionData=function(f,b){if(!(this instanceof a.positionData))throw new x('"easy.positionData" cannot be called as a function. Use the "new" keyword to construct a new "Position" instance');f instanceof a.positionData&&a.console.error(a.MODULE_POSITION,'Invalid type for "position" argument, must not be an instance of easy.positionData');
if(!f)throw new x('Invalid type for "position" argument, got "'+a.utils.getType(f)+'"');if(!f.elementId)throw new x('Invalid position "elementId" property for '+f);a.utils.extend(this,f);this._messageInstance=void 0;I.defineProperty(this,"_waitForElement",{configurable:!0,writable:!0});this.triggerId=H(this.triggerId)||void 0;this._isTriggered=this._hasTriggerEvent=!1;this.cssClasses=this.cssClasses||null;this.cssText=this.cssText||null;this.renderer=this.renderer||null;this.message=void 0;this.hidden=
!1;this._setPriorityLevel();this.method===this.METHOD_HIDE&&this.isMatchingUrl(b)&&this.hide()};a.positionData.prototype.getElements=function(){return a.domElements.selector(this.getSelector(),w,this.hasjQuerySelector())};a.positionData.prototype.getSelector=function(){return this.isPopup()?(a.deprecate("easy.positionData.getSelector(popup)","N/A",function(){},void 0,!0)(),a.popup.getId()):this.selectorType===this.SELECTOR_TYPE_V1?/^\$/.test(this.elementId)?this.elementId.substring(1):"#"+this.elementId:
this.elementId};a.positionData.prototype.hasjQuerySelector=function(){return this.selectorType===this.SELECTOR_TYPE_JQUERY||!a.domElements.isSelector(this.getSelector())};a.positionData.prototype.isPopup=function(){return this.elementId===this.SELECTOR_TYPE_POPUP};a.positionData.prototype.hide=function(){var f=this.getSelector();if(a.domElements.isSelector(f)){var b=a.domElements.selector(f);a.utils.some(b,function(b){return 0<a.domElements.visibility(b)})||(a.domElements.addStyles(f+" { visibility: hidden !important; }",
"hide_and_replace_"+this.position),this.hidden=!0)}else a.log.warn('Invalid position CSS selector of "'+f+'"',a.ERROR_TYPE_SELECTOR_INVALID,{module:a.MODULE_POSITION,positionId:this.position})};a.positionData.prototype.show=function(){if(this.method===this.METHOD_HIDE&&this.hidden){this.hidden=!1;var f=this.getSelector();a.domElements.isSelector(f)&&a.domElements.removeStyles(f,"hide_and_replace_"+this.position)}};a.positionData.prototype.getRenderer=function(){if(this.hasRenderer()){var f=a.message.getCustomRenderer(this.renderer);
if(f)return f;f=this.message&&0<this.message.id?this.message.id:void 0;a.log.error('Invalid renderer function, for "'+this.renderer+'"',a.ERROR_TYPE_MESSAGE_INVALID,{module:a.MODULE_POSITION,messageId:f,revisionId:f?this.message.revision:void 0,positionId:this.position,rendererName:this.renderer||void 0});return function(a){a.clear()}}};a.positionData.prototype.getHiddenRenderer=function(){return this.hasRenderer()?a.message.getCustomRenderer(this.renderer+".hidden"):void 0};a.positionData.prototype.hasRenderer=
function(){return a.utils.isString(this.renderer)&&0<this.renderer.length};a.positionData.prototype.render=function(f){a.console.info("[positionActive]","position_id."+this.position+", message_id."+this.message.id+", revision_id."+this.message.revision,this);this._onRender=a.utils.isFunction(f.onRender)?f.onRender:function(){};this._messageInstance=new a.messageInstance(this);this._messageInstance.setRestorable(f.restoreMessage);this._messageInstance.setTrackable(f.trackMessage);this._startTriggerEvent(!0===
f.excludeTrigger);this._onRender()};a.positionData.prototype._completeInstance=function(f){var b=void 0===f;a.events.trigger(b?a.EVENT_MESSAGESHOW_COMPLETE:a.EVENT_MESSAGESHOW_FAILED,this);b||a.debug.addEntry("errors_position",{error:f,positionId:this.position});a.console.info("[positionComplete]",(b?"Success":"Failed")+": position_id."+this.position+", message_id."+this.message.id+", revision_id."+this.message.revision,this)};a.positionData.prototype._showInstance=function(){this._isCleared=!1;a.events.off(a.EVENT_JQUERY_READY,
this._showInstance);a.events.off(a.ERROR_SITE_JQUERY_MISSING,this._showInstance);a.console.info("[positionWait]","position_id."+this.position+", message_id."+this.message.id+", revision_id."+this.message.revision,this);this._waitForElement=a.domElements.waitFor({selector:this.getSelector(),interval:100,timeout:1E4});var f=this;this._waitForElement.then(function(){a.console.info("[positionFound]","position_id."+f.position+", message_id."+f.message.id+", revision_id."+f.message.revision,this);if(f._isCleared||
!f._messageInstance.show())throw new x("Position was cleared or the message was not shown for "+f.position);f._completeInstance(void 0)}).catch(function(a){f._completeInstance(a)})};a.positionData.prototype.isTriggered=function(){return this._isTriggered};a.positionData.prototype._startTriggerEvent=function(f){f||void 0===this.triggerId?this._onTriggerEvent():this._hasTriggerEvent||(this._hasTriggerEvent=!0,a.events.on(a.EVENT_TRIGGER_FIRE,this._onTriggerEvent,this))};a.positionData.prototype._onTriggerEvent=
function(f){f&&this.triggerId!==f.id||(this._isTriggered=!0,this.hasjQuerySelector()&&!a.sizzle?(a.events.once(a.EVENT_JQUERY_READY,this._showInstance,this),a.events.once(a.ERROR_SITE_JQUERY_MISSING,this._showInstance,this)):this._showInstance(),this.show())};a.positionData.prototype.clear=function(){this._waitForElement&&this._waitForElement.cancel();this._messageInstance&&(this._messageInstance.clear()&&this.isPopup()&&a.popup.hide(),this._messageInstance.clearTimers());this._isCleared=!0;this._waitForElement=
this._messageInstance=void 0;this._isTriggered=this._hasTriggerEvent=this.hidden=!1;a.events.off(a.EVENT_TRIGGER_FIRE,this._onTriggerEvent);a.events.off(a.EVENT_JQUERY_READY,this._showInstance);a.events.off(a.ERROR_SITE_JQUERY_MISSING,this._showInstance)};a.positionData.prototype.getMessageInstance=function(){return this._messageInstance};a.positionData.prototype.setMessage=function(f){if(!a.internal.isMessage(f))throw new x('Invalid type for "message" argument, got "'+a.utils.getType(f)+'" for '+
this.position);this.message=f};a.positionData.prototype.isMatchingUrl=function(f){if(a.utils.isArray(this.rules)&&0<this.rules.length){var b=new a.baseEvaluator;f&&b.setEvaluatorValue("location",f);b.setErrorOptions({type:a.ERROR_TYPE_POSITION_EXCEPTION,level:a.LOG_LEVEL_ERROR,module:a.MODULE_POSITION,positionId:this.position});return b.evaluate(this.rules)}if(a.utils.isArray(this.urlMatch)&&0<this.urlMatch.length){var e=a.utils.getLocationFromUrl(f);return a.utils.some(this.urlMatch,function(b){var c=
a.evaluator.getMatcherFunction(b[0]);return a.evaluator.matchUrl(c,b[1],b[2]||{},b[3]||{},e)})}return!0};a.positionData.prototype._setPriorityLevel=function(){var f={matchExact:0,matchBegins:1,matchRegex:2},b=9999;a.utils.each(this.urlMatch,function(a){a=a[0];f.hasOwnProperty(a)&&(a=f[a],a<b&&(b=a))});this.priorityLevel=b};I.defineProperties(a.positionData.prototype,{METHOD_HIDE:{value:"hide"},METHOD_REPLACE:{value:"replace"},METHOD_RENEW:{value:"renew"},METHOD_BEFORE:{value:"before"},METHOD_AFTER:{value:"after"},
METHOD_PREPEND:{value:"prepend"},METHOD_APPEND:{value:"append"},HIDDEN_CLASS:{value:"frosmo-message-hidden"},SELECTOR_TYPE_CSS:{value:"css"},SELECTOR_TYPE_JQUERY:{value:"jquery"},SELECTOR_TYPE_POPUP:{value:"popup"},SELECTOR_TYPE_V1:{value:"v1"}});a.popup=function(){function f(){if(!w.body)throw a.internal.createLogError("Body not found",a.ERROR_TYPE_SELECTOR_INVALID,{module:a.internal.getCurrentModule()});var g;(g=a.domElements.selector(b())[0])||(c&&d||(c=w.createElement("div"),d=w.createElement("div"),
c.setAttribute("id","frosmoPopupBackground"),d.setAttribute("id","frosmoPopup"),w.body.appendChild(c),w.body.appendChild(d)),g=d);return g}function b(){return"#frosmoPopup"}function e(){c.style.display="none";d.style.display="none";a.domEvents.off(c,"click."+a.DOM_EVENT_NAMESPACE,e);a.domEvents.off(a.domElements.selector(".frosmoPopupClose",d),"click."+a.DOM_EVENT_NAMESPACE,e)}function h(b,l){l=l||{};f();var h={args:{message:l.message,positionData:l,easy:v.easy,site:v.site}};l.message&&(h.scriptNamespace=
a.MESSAGE_SCRIPT_ID+l.message.id,h.styleNamespace=a.MESSAGE_STYLE_ID+l.message.id);a.domElements.html(d,b,h);a.domEvents.on(c,"click."+a.DOM_EVENT_NAMESPACE,e);a.domEvents.on(a.domElements.selector(".frosmoPopupClose",d),"click."+a.DOM_EVENT_NAMESPACE,e);d.style.display="block";c.style.display="block"}var c,d;return{create:a.deprecate("easy.popup.create","N/A",f,void 0,!0),getId:a.deprecate("easy.popup.getId","N/A",b,void 0,!0),hide:a.deprecate("easy.popup.hide","N/A",e,void 0,!0),render:a.deprecate("easy.popup.render",
"N/A",function(b,c){b.renderer="easy.popup.renderer."+B.now();a.message.addCustomRenderer(b.renderer,function(a){var b=a.getMessageInstance();h(b.content,a);b.startTracking();b.setTrueDisplayed()});a.domEvents.ready(function(){f();b.render(c)})},void 0,!0),show:a.deprecate("easy.popup.show","N/A",h,void 0,!0)}}();a.visitsHistory=function(){function f(b,d,g){if(!b||a.utils.isString(b))return[d];var e=[];e.push(d);for(d=0;d<b.length;d+=1){var f=b[d];8===f.length&&e.push(f);if(e.length>=g)break}return e}
function b(b,d,g){var e=[];a.utils.each(d,function(d,t){if(null!==d){var r;a:{for(r in h)if(d[4]===r){r=!0;break a}r=!1}if(!r||!h[d[4]](t,a.context.pageVisits,g)){r=d[2]||{};var u=a.evaluator.getMatcherFunction(d[0]);a.evaluator.matchUrl(u,d[1],r,a.config.anchorEnabled&&d[3]?d[3]:{},b)&&(a.context.pageVisits[t]=f(a.context.pageVisits[t],g,20),e.push(t),a.context.sessionPathVisits[t]=1)}}});return e}function e(a,b){return a+"\n"+b}var h={day:function(b,d,g){var e=!1;a.utils.each(d[b],function(a){a===
g&&(e=!0)});return e},visit:function(b){return a.context.sessionPathVisits[b]}};return{addPageVisit:function(c,d,g,e){g=a.utils.getDateInContextFormat(g);c=a.utils.getLocationFromUrl(c.href);d=b(c,d,g);e(d)},addSiteVisit:function(b){b=a.utils.getDateInContextFormat(b);a.context.siteVisits=f(a.context.siteVisits,b,20)},shiftDateArray:f,addCustomAction:function(b,d){var g=a.utils.getDateInContextFormat(d);a.context.customActions[b]=f(a.context.customActions[b],g,20)},addMetaCount:function(b,d){var g=
a.utils.getDateInContextFormat(d);a.context.metaCount[b]=f(a.context.metaCount[b],g,20)},addConversion:function(b,d,g){var l=a.utils.getDateInContextFormat(g);a.context.conversions[b]=f(a.context.conversions[b],l,20);if(d){var h=e(b,d);b=e(b,d)+"\nlast";a.context.conversions[h]=f(a.context.conversions[h],l,20);a.context.conversions[b]=a.utils.getTimestamp(g)}},getConversionIdKey:e,getConversionLastTime:function(b,d){var g=e(b,d)+"\nlast";return a.context.conversions[g]}}}();a.styles="#frosmoPopup{display:none;position:fixed;top:10%;background-color:#fff;-moz-opacity:1;opacity:1;filter:alpha(opacity=100);border:1px solid #000;z-index:1002;-moz-box-shadow:0 0 30px #000;-webkit-box-shadow:0 0 30px #000;border-radius:7px;box-shadow:0 0 30px #000;width:560px;margin-left:-280px;left:50%;font-family:'Helvetica Neue',Helvetica,Arial,sans-serif;padding:10px 15px;overflow:auto}.frosmoPopupHeader{background-repeat:no-repeat}.frosmoPopupHeader h1{margin:10px}.frosmoPopupHeader .frosmoPopupClose{display:inline-block;float:right;background:transparent;border:none;font-size:20px;font-weight:bold;line-height:20px;cursor:pointer;margin:0;opacity:.4}.frosmoPopupHeader .frosmoPopupClose:hover{opacity:.8}.frosmoPopupContent{clear:both;position:relative;max-height:400px;overflow:auto;margin-bottom:15px;padding:0 10px 10px}.frosmoPopupFooter{display:block;text-align:right}.frosmoPopupFooter button{background:#ccc;border:none;padding:5px 10px;cursor:pointer;border-radius:4px}.frosmoPopupFooter button:hover{background:#aaa}#frosmoPopupBackground{display:none;position:fixed;top:0;left:0;width:100%;height:100%;background-color:#000;z-index:1001;-moz-opacity:.7;opacity:.7;filter:alpha(opacity=70);margin:0;padding:0}#frosmoPopup.frosmoPopupMaxWidth640{width:auto;left:auto;margin-left:10px;margin-right:10px}@media(max-width:640px){#frosmoPopup{width:auto;left:auto;margin-left:10px;margin-right:10px}}@media(max-height:640px){.frosmoPopupContent{max-height:200px}}@media(max-height:840px){.frosmoPopupContent{max-height:400px}}@media(min-height:841px){.frosmoPopupContent{max-height:600px}}.frosmo-message-hidden{visibility:hidden!important}";
a.customAction=function(){var f;return{init:function(b){f=b;f.rules&&a.customActionRules.init(f.rules)},trigger:function(b,e,h){var c='Name: "'+b+'", Value: "'+e+'", Title: "'+h+'"';if(!f)return a.log.error("Custom actions not initialized, due to initalization failure",a.ERROR_TYPE_CUSTOM_ACTION_INVALID,{module:a.internal.getCurrentModule(),debug:c}),!1;if(!a.utils.isString(b))return a.log.error('Invalid type for custom action "name" argument, got "'+a.utils.getType(b)+'" for "'+b+'"',a.ERROR_TYPE_CUSTOM_ACTION_INVALID,
{module:a.internal.getCurrentModule(),debug:c}),!1;var d=a.utils.getType(e);if(!a.utils.inArray(["string","boolean","number"],d))return a.log.error('Invalid type for custom action "value" argument, got "'+d+'" for "'+e+'"',a.ERROR_TYPE_CUSTOM_ACTION_INVALID,{module:a.internal.getCurrentModule(),debug:c}),!1;if(!b||128<b.length)return a.log.error('Invalid custom action "name" argument length, for "'+b+'"',a.ERROR_TYPE_CUSTOM_ACTION_INVALID,{module:a.internal.getCurrentModule(),debug:c}),!1;e=z(e);
if(!e||128<e.length)return a.log.error('Invalid custom action "value" argument length, for "'+e+'"',a.ERROR_TYPE_CUSTOM_ACTION_INVALID,{module:a.internal.getCurrentModule(),debug:c}),!1;var g=f.date||new B,l=[];a.utils.each(f.segments,function(c,d){b===c.name&&a.utils.inArray(c.values,e)&&(a.visitsHistory.addCustomAction(d,g),l.push(d))});0<l.length&&(a.segmentchange.evaluate({customActions:l},g),a.context.save());a.utils.inArray(f.states,b)&&a.states.set(b,e);a.events.trigger(a.EVENT_CUSTOMACTION,
b,e);c=a.EVENT_CUSTOMACTION+"."+b;a.events.trigger(c,b,e);a.events.trigger(c+"."+e,b,e);a.api.sendCustomAction(b,e,h);return 0<l.length}}}();a.customActionRules=function(){function f(b){if(v.geo)a.events.on(a.EVENT_LOCATION,function(a){e(b,a)});else a.log.send("Geolocation module not found",a.ERROR_TYPE_MODULE_MISSING,{level:a.LOG_LEVEL_CRITICAL})}function b(a){switch(a.type){case "geolocation":f(a)}}function e(b,c){var d={lat:c.latitude,lon:c.longitude};a.utils.each(b.rules,function(c,e){var f=K(c[2]);
v.geo.getCircleDistance(d,{lat:c[0],lon:c[1]})<=f&&a.customAction.trigger(b.name,e)})}return{init:function(e){a.utils.each(e,b)},initGeolocation:f,initRule:b}}();a.location=function(){function f(){return g||!a.utils.isMobile()}function b(a,b){var c={text:a,type:b,status:0,url:"",method:"getNative"},d;try{d=v.JSON.stringify(c)}catch(g){d='{"text":"Unexpected error with navigator.geolocation (default)","type":"'+b+'","status":-1,"url":"","method":"getNative"}'}return[c,d]}function e(b,c,d,g){a.utils.isFunction(b)&&
a.runGuarded(b,[d]);c(d);a.log.warn("Unexpected error occurred with requesting the location","location_"+d.type,{debug:g});a.events.trigger(a.EVENT_LOCATION_FAILURE,d)}function h(b,c,d){a.utils.isFunction(b)&&a.runGuarded(b,[d]);c(d);a.events.trigger(a.EVENT_LOCATION,d)}var c={enableHighAccuracy:!1,maximumAge:0,timeout:5E3},d={country2:"",ip:"",isp:"",latitude:0,longitude:0,city:"",regionCode:""},g=!1;return{enableMobile:function(){g=!0},isSupported:f,get:function(b,c){var g,r,u=new a.Promise(function(a,
b){g=a;r=b});if(!f())return h(b,g,a.utils.clone(d)),u;var k=a.api.getApiUrl("location");if(!k)return h(b,g,a.utils.clone(d)),u;a.fetch.get(k,{dataType:"text",success:function(a,c,d){a={city:d.getResponseHeader("X-City"),country2:d.getResponseHeader("X-Country2"),ip:d.getResponseHeader("X-Real-IP"),isp:d.getResponseHeader("X-ISP"),latitude:K(d.getResponseHeader("X-latitude"))||0,longitude:K(d.getResponseHeader("X-longitude"))||0,regionCode:d.getResponseHeader("X-Region-Code")};h(b,g,a)},error:function(a,
b,d,g){e(c,r,d,g)}});return u},getNative:function(g,f,t){var r,u,k=new a.Promise(function(a,b){r=a;u=b}),m=a.utils.parseUri(a.main.getCurrentBrowserData().href).protocol;if("https"!==m)return t=b('Invalid protocol of "'+m+'", only "https" is supported',a.ERROR_TYPE_ARG_INVALID),e(f,u,t[0],t[1]),k;if(!M||!M.geolocation)return t=b("navigator.geolocation is not available",a.ERROR_TYPE_MODULE_MISSING),e(f,u,t[0],t[1]),k;m=t=a.utils.extend({},c,t);M.geolocation.getCurrentPosition(function(b){var c=a.utils.clone(d);
c.latitude=b.coords.latitude;c.longitude=b.coords.longitude;h(g,r,c)},function(c){c=b(c.message,a.ERROR_TYPE_EXCEPTION);e(f,u,c[0],c[1])},m);return k}}}();a.dataLayer=function(){function f(a){return{conversion_id:a.conversionId,conversion_name:a.frosmoConversionName,conversion_value:a.conversionValue,conversion_type:a.conversionType}}function b(a){return{product_id:a.frosmoProductId,product_name:a.frosmoProductName,product_price:a.frosmoProductPrice,product_type:a.frosmoProductCategory,product_image:a.frosmoProductImage,
product_url:a.frosmoProductUrl,product_discount_price:a.frosmoProductDiscountPrice,product_promotion_label:a.frosmoProductPromotionLabel,product_area:a.frosmoProductArea,product_campaign:a.frosmoProductCampaign,product_categories:a.frosmoProductCategories,product_category:a.frosmoProductMainCategory,product_city:a.frosmoProductCity,product_colors:a.frosmoProductColors,product_company:a.frosmoProductCompany,product_conversion:a.frosmoProductConversion,product_country:a.frosmoProductCountry,product_custom_images:a.frosmoProductCustomImages,
product_data:a.frosmoProductData,product_description:a.frosmoProductDescription,product_ids:a.frosmoProductIds,product_manufacturer:a.frosmoProductManufacturer,product_model:a.frosmoProductModel,product_multi_prices:a.frosmoProductMultiPrices,product_rating:a.frosmoProductRating,product_stock:a.frosmoProductStock,product_sub_category:a.frosmoProductSubCategory,product_urn:a.frosmoProductUrn,product_venue:a.frosmoProductVenue}}function e(){p=window.dataLayer.push;window.dataLayer.push=function(){var b=
a.utils.arrayFrom(arguments),c=p.apply(window.dataLayer,b);h(b);return c}}function h(b){a.utils.each(b,function(b){b&&(J(b),a.events.trigger(a.EVENT_DATALAYER,b))})}function c(b){if(!a.utils.isArray(b.transactionProducts))throw new x('Invalid type for "transactionProducts" property, got "'+a.utils.getType(b.transactionProducts)+'"');var c=a.utils.map(b.transactionProducts,function(a){return{id:a.id||a.sku||a.name,value:K(a.price),quantity:P(a.quantity,10)||1}}),d=a.utils.map(c,function(b){b=a.utils.clone(b);
b.value*=b.quantity;return b}),g=b.transactionTotal||a.utils.reduce(d,function(a,b){return a+b.value},0);a.api.transaction(null,"transaction",b.transactionId,g,d);a.events.trigger(a.EVENT_CONVERSION,{id:"transaction",type:"transaction",transactionId:b.transactionId,products:c,value:g});a.utils.each(c,function(b){for(var c={id:b.id,value:b.value},d=0;d<b.quantity;d++)a.events.trigger(a.EVENT_PRODUCT_PURCHASE,c)})}function d(b){return function(c,d){if(!a.utils.isNumeric(d))return'Invalid type for "'+
c+'" product attribute, got "'+a.utils.getType(d)+'", expected "numerical" value';var g=v.JSON.stringify(d).length;if(g>b)return'Invalid length for "'+c+'" product attribute, got '+g+", expected less than or equal to "+b}}function g(a){return'Invalid "'+a+'" product attribute, this is read-only and maintained by the Frosmo Platform'}function l(b){return function(c,d){if(!a.utils.isString(d))return'Invalid type for "'+c+'" product attribute, got "'+a.utils.getType(d)+'", expected "string" type';var g=
a.utils.trim(d).length;if(g>b)return'Invalid length for "'+c+'" product attribute, got '+g+", expected less than or equal to "+b}}function q(b){var c={},d={};a.utils.each(b,function(a,b){var g=E[b];g?c[g.evtAlias]=c[b]=a:(c[b]=a,d[b]=a)});void 0===b.data&&(c.product_data=c.data=v.JSON.stringify(d));return c}function t(){n&&window.dataLayer===n||(window.dataLayer=window.dataLayer||[],n=window.dataLayer,h(window.dataLayer),e())}function r(b){b=a.utils.getByDotString("frosmo.addToCart.items",b,{empty:!1,
nonObjects:!1});if(!a.utils.isNil(b))if(a.utils.isArray(b))if(a.utils.isEmpty(b))a.log.error('Invalid length for "frosmo.addToCart.items" array, got 0, expected greater than or equal to 1',a.ERROR_TYPE_ARG_INVALID);else if(20<b.length)a.log.error('Invalid length for "frosmo.addToCart.items" array, got '+b.length+", expected less than or equal to 20",a.ERROR_TYPE_ARG_INVALID);else{var c=[];a.utils.each(b,function(b){b=b.id;var d=E.id.validator("id",b);d?c.push(d):(a.utils.isNil(b)||""===a.utils.trim(b))&&
c.push('Missing "id" product attribute, expected to be defined as a "string" type')});a.utils.isEmpty(c)?(b=a.utils.map(b,function(b){b=a.utils.clone(b);b.id=a.utils.trim(b.id);return b}),a.api.addToCart(b),a.console.log("[dataLayer]","Add to cart items sent")):a.log.error("Invalid add to cart items",a.ERROR_TYPE_ARG_INVALID,{debug:v.JSON.stringify({errors:c,cartItems:b})})}else a.log.error('Invalid type for "frosmo.addToCart.items" array, got "'+a.utils.getType(b)+'", expected "array" type',a.ERROR_TYPE_ARG_INVALID)}
function u(b){var c=a.utils.getByDotString("frosmo.view.products",b,{empty:!1,nonObjects:!1});if(!a.utils.isNil(c))if(a.utils.isArray(c))if(a.utils.isEmpty(c))a.log.error('Invalid length for "frosmo.view.products" array, got 0, expected greater than or equal to 1',a.ERROR_TYPE_ARG_INVALID);else{var d=["set","view","setView"],g=a.utils.getByDotString("frosmo.view.mode",b,{empty:!1,nonObjects:!1});a.utils.isNil(g)||a.utils.inArray(d,g)?a.utils.each(c,function(b){var c=[];a.utils.each(E,function(d,g){if(d.required){var e=
b[g];(a.utils.isNil(e)||""===a.utils.trim(e))&&c.push('Missing "'+g+'" product attribute, expected to be defined as a "string" type')}});a.utils.each(b,function(a,b){var d=E[b];(d=d?d.validator(b,a):w(b,a))&&c.push(d)});if(a.utils.isEmpty(c)){var d={};a.utils.each(b,function(b,c){var g=E[c];g&&g.transformer?d[c]=g.transformer(b):a.utils.isString(b)?d[c]=a.utils.trim(b):d[c]=b});var e=q(d);a.console.log("[dataLayer]",'Product sent with the product type "'+e.type+'" and product name "'+e.name+'"');
a.events.trigger(a.EVENT_PRODUCT_DATA,e);a.api.setProductDataPayload(d,g)}else a.log.error("Invalid product data payload",a.ERROR_TYPE_ARG_INVALID,{debug:v.JSON.stringify({errors:c,product:b,mode:g})})}):a.log.error('Invalid mode for "frosmo.view.mode", got "'+g+'", expected one of: "'+d.join('", "')+'"',a.ERROR_TYPE_ARG_INVALID)}else a.log.error('Invalid type for "frosmo.view.products" array, got "'+a.utils.getType(c)+'", expected "array" type',a.ERROR_TYPE_ARG_INVALID)}function k(b){b=a.utils.getByDotString("frosmo.viewItemList.filters",
b,{empty:!1,nonObjects:!1});if(!a.utils.isNil(b))if(a.utils.isPlainObject(b))if(a.utils.isEmpty(b))a.log.error('Invalid length for "frosmo.viewItemList.filters" object, got 0, expected greater than or equal to 1',a.ERROR_TYPE_ARG_INVALID);else if(20<a.utils.keys(b).length)a.log.error('Invalid length for "frosmo.viewItemList.filters" object, got 0, expected less than or equal to 20',a.ERROR_TYPE_ARG_INVALID);else{var c=[];a.utils.each(b,function(a,b){var d=m(b,a,20,256);d&&c.push(d)});if(a.utils.isEmpty(c)){var d=
{};a.utils.each(b,function(b,c){d[a.utils.trim(c)]=a.utils.map(b,function(b){return a.utils.trim(b)})});a.api.viewItemList(d);a.console.log("[dataLayer]","View item list filters sent")}else a.log.error("Invalid view item list filters",a.ERROR_TYPE_ARG_INVALID,{debug:v.JSON.stringify({errors:c,filters:b})})}else a.log.error('Invalid type for "frosmo.viewItemList.filters" object, got "'+a.utils.getType(b)+'", expected "object" type',a.ERROR_TYPE_ARG_INVALID)}function m(b,c,d,g){var e=a.utils.trim(b).length;
if(0===e)return'Missing name, expected to be a non-empty "string" type';if(e>g)return'Invalid length for "'+b+'" filter name, got '+e+", expected less than or equal to "+g;if(!a.utils.isArray(c))return'Invalid type for "'+b+'" filter, got "'+a.utils.getType(c)+'", expected "array" type containing "string" types';if(a.utils.isEmpty(c))return'Invalid length for "'+b+'" filter name, got 0, expected greater than or equal to 1';if(c.length>d)return'Invalid length for "'+b+'" filter name, got '+c.length+
", expected less than or equal to "+d;for(d=0;d<c.length;d++){e=c[d];if(!a.utils.isString(e))return'Invalid type for "'+b+'" filter, got "'+a.utils.getType(e)+'", expected "array" type containing "string" types';e=a.utils.trim(e).length;if(0===e)return'Missing value for "'+b+'" filter, expected to have non-empty "string" types';if(e>g)return'Invalid length for "'+b+'" filter, got '+e+", expected less than or equal to "+g}}var n,p,J=function(d){d.transactionProducts?c(d):d.frosmoProductId?(a.products.push(b(d)),
a.conversion.handleProductArray("dataLayer_module",1)):d.conversionId?(a.conversions.push(f(d)),a.conversion.handleConversionArray("dataLayer_module",1)):d.frosmoEvent?a.customAction.trigger(z(d.frosmoEvent),z(d.frosmoValue)):(r(d),u(d),k(d))},E={id:{evtAlias:"product_id",required:!0,validator:l(256)},availability:{evtAlias:"product_availability",required:!1,validator:function(b){return function(c,d){if(!a.utils.inArray(b,d))return'Invalid value for "'+c+'" product attribute, got "'+d+'", expected one of: "'+
b.join('", "')+'"'}}(["in stock","out of stock","preorder"])},availableOn:{evtAlias:"product_available_on",required:!1,validator:function(b,c){if(!a.utils.isString(c))return'Invalid type for "'+b+'" product attribute, got "'+a.utils.getType(c)+'", expected "datetime string" type';var d=a.utils.trim(c),g=new B(d);if(!(0<g.valueOf()&&g.toISOString()===d))return'Invalid value for "'+b+'" product attribute, got "'+c+'", expected "datetime string"'}},brand:{evtAlias:"product_brand",required:!1,validator:l(2048)},
categories:{evtAlias:"product_categories",required:!1,validator:function(b){return function(c,d){if(!a.utils.isArray(d)||a.utils.some(d,function(b){return!a.utils.isString(b)}))return'Invalid type for "'+c+'" product attribute, got "'+a.utils.getType(d)+'", expected "array" type containing "string" types';var g=v.JSON.stringify(d).length;if(g>b)return'Invalid length for "'+c+'" product attribute, got '+g+", expected less than or equal to "+b}}(2048)},image:{evtAlias:"product_image",required:!1,validator:l(2048)},
name:{evtAlias:"product_name",required:!1,validator:l(256)},originalPrice:{evtAlias:"product_original_price",required:!1,validator:d(2048),transformer:H},parentId:{evtAlias:"product_parent_id",required:!1,validator:function(b,c){return function(d,g){if(null!==g){if(!a.utils.isString(g))return'Invalid type for "'+d+'" product attribute, got "'+a.utils.getType(g)+'", expected "null" or "string" type';var e=a.utils.trim(g).length;if(e<b)return'Invalid length for "'+d+'" product attribute, got '+e+", expected greater than or equal to "+
b;if(e>c)return'Invalid length for "'+d+'" product attribute, got '+e+", expected less than or equal to "+c}}}(1,256)},price:{evtAlias:"product_price",required:!1,validator:d(2048),transformer:H},type:{evtAlias:"product_type",required:!1,validator:l(256)},url:{evtAlias:"product_url",required:!1,validator:l(2048)},created_at:{validator:g},updated_at:{validator:g},feed_updated_at:{validator:g}},w=function(b,c){return function(d,g){var e=z(d).length;if(e>b)return'Invalid length for "'+d+'" product attribute name, got '+
e+", expected less than or equal to "+b;if(void 0!==g&&(a.utils.isString(g)&&(g=a.utils.trim(g)),e=v.JSON.stringify(g).length,e>c))return'Invalid length for "'+d+'" product attribute, got '+e+", expected less than or equal to "+c}}(32,2048);return{init:function(){t();a.utils.setInterval(t,1E3)},convertToConversions:function(b){if(!a.utils.isArray(b.transactionProducts))throw new x('Invalid type for conversion "transactionProducts" property, got "'+a.utils.getType(b.transactionProducts)+'"');return a.utils.map(b.transactionProducts,
function(a){return{conversion_id:a.id||a.sku||a.name,conversion_name:a.name,conversion_value:K(a.price),conversion_quantity:a.quantity,conversion_type:a.category,transaction_id:b.transactionId,payment_channel:b.transactionPaymentType||null}})},convertToConversion:f,convertToProduct:b,handleItem:J,setHandleItem:function(b){J=a.guard(b,{module:a.internal.getCurrentModule()})}}}();a.user=function(){function f(b){var e=z(b);a.context.lastLoginId=e;a.context.save();a.events.once(a.EVENT_INIT_QUICK_CONTEXT,
function(){var b=a.quickContext.get();b.lastLoginId=e;a.quickContext.save(b)})}return{init:function(){a.states.set("loginStatus",a.user.getLoginId()?"authenticated":"unauthenticated")},getLoginId:function(){return a.context.loginId},getLastLoginId:function(){return a.context.lastLoginId},login:function(b){if(!(a.utils.isNumber(b)||a.utils.isString(b)&&0<b.length))throw new x('Invalid type for "loginId" argument, got "'+a.utils.getType(b)+'" for "'+v.JSON.stringify(b)+'"');f(b);a.context.loginId=b;
a.context.save();a.api.login(b,a.context.referer.host);a.states.set("loginStatus","authenticated");a.events.trigger(a.EVENT_LOGIN);return!0},logout:function(){a.context.loginId=null;a.context.save();a.states.set("loginStatus","unauthenticated");a.events.trigger(a.EVENT_LOGOUT);return!0}}}();a.googleAnalytics=function(){var f;return{init:function(b){f=a.utils.clone(b);f.trackingId&&(f.trackDisplays&&a.googleAnalytics.trackEvent(a.EVENT_MESSAGE_SHOW,f.eventActionDisplay,!0),f.trackTrueDisplays&&a.googleAnalytics.trackEvent(a.EVENT_MESSAGE_TRUE_DISPLAY,
f.eventActionTrueDisplay,!0),f.trackClicks&&a.googleAnalytics.trackEvent(a.EVENT_MESSAGE_CLICK,f.eventActionClick,!1))},getEventLabel:function(a){var e="#"+a.id+"."+(999===a.revision?"CG":a.revision);a.title&&(e+=" "+a.title);return e},getClassicTracker:function(){if(window._gat&&a.utils.isFunction(window._gat._getTrackers)){var b=window._gat._getTrackers();return a.utils.find(b,function(a){return f.trackingId===a._getAccount()})}},getUniversalTracker:function(){if(window.ga&&a.utils.isFunction(window.ga.getAll)){var b=
window.ga.getAll();return a.utils.find(b,function(a){return f.trackingId===a.get("trackingId")})}},isEnabled:function(a){return void 0===a.gaTracking||a.gaTracking},sendClassicEvent:function(b,e,h){var c=a.googleAnalytics.getClassicTracker();if(c){var d=f.eventCategory;b=a.googleAnalytics.getEventLabel(b);c._trackEvent(d,e,b,0,h)}else a.console.error("[googleAnalytics]",'Unable to find the classic tracker for id "'+f.trackingId+'"')},sendEvent:function(b,e,h){var c={level:a.LOG_LEVEL_WARNING,module:a.MODULE_MESSAGE,
messageId:b.id,revisionId:b.revision,debug:'Action: "'+e+'"'},d=a.utils.extend({type:a.ERROR_TYPE_GA_EXCEPTION},c),d=a.guard(function(){var c=!1;window.ga&&a.googleAnalytics.getUniversalTracker()&&(c=!0,window.ga(function(){a.googleAnalytics.sendUniversalEvent(b,e,h)}));window._gaq&&a.googleAnalytics.getClassicTracker()&&(c=!0,window._gaq.push(function(){a.googleAnalytics.sendClassicEvent(b,e,h)}));c&&a.debug.addEntry("google_analytics",{messageId:b.id,revisionId:b.revision,action:e,category:f.eventCategory,
label:a.googleAnalytics.getEventLabel(b)});return c},d);a.utils.waitFor(100,a.GA_INIT_TIMEOUT,d,function(){a.console.warn("GA not found, but enabled for the site/message",a.ERROR_TYPE_GA_MISSING,c)})},sendUniversalEvent:function(b,e,h){var c=a.googleAnalytics.getUniversalTracker();if(c){var d=f.eventCategory;b=a.googleAnalytics.getEventLabel(b);c.send("event",d,e,b,0,{nonInteraction:h})}else a.console.error("[googleAnalytics]",'Unable to find the universal tracker for id "'+f.trackingId+'"')},trackEvent:function(b,
e,f){a.events.on(b,function(b){a.googleAnalytics.isEnabled(b)&&a.googleAnalytics.sendEvent(b,e,f)})}}}();(function(a){function b(a,b){var c=(a&65535)+(b&65535);return(a>>16)+(b>>16)+(c>>16)<<16|c&65535}function e(a,c,d,e,f,h){a=b(b(c,a),b(e,h));return b(a<<f|a>>>32-f,d)}function h(a,b,c,d,f,h,k){return e(b&c|~b&d,a,b,f,h,k)}function c(a,b,c,d,f,h,k){return e(b&d|c&~d,a,b,f,h,k)}function d(a,b,c,d,f,h,k){return e(c^(b|~d),a,b,f,h,k)}a.md5=function(a){var f=ja(W(a)),q;a=[];a[(f.length>>2)-1]=void 0;
for(q=0;q<a.length;q+=1)a[q]=0;var t=8*f.length;for(q=0;q<t;q+=8)a[q>>5]|=(f.charCodeAt(q/8)&255)<<q%32;f=8*f.length;a[f>>5]|=128<<f%32;a[(f+64>>>9<<4)+14]=f;for(var r,u,k=1732584193,m=-271733879,n=-1732584194,p=271733878,f=0;f<a.length;f+=16)q=k,t=m,r=n,u=p,k=h(k,m,n,p,a[f],7,-680876936),p=h(p,k,m,n,a[f+1],12,-389564586),n=h(n,p,k,m,a[f+2],17,606105819),m=h(m,n,p,k,a[f+3],22,-1044525330),k=h(k,m,n,p,a[f+4],7,-176418897),p=h(p,k,m,n,a[f+5],12,1200080426),n=h(n,p,k,m,a[f+6],17,-1473231341),m=h(m,n,
p,k,a[f+7],22,-45705983),k=h(k,m,n,p,a[f+8],7,1770035416),p=h(p,k,m,n,a[f+9],12,-1958414417),n=h(n,p,k,m,a[f+10],17,-42063),m=h(m,n,p,k,a[f+11],22,-1990404162),k=h(k,m,n,p,a[f+12],7,1804603682),p=h(p,k,m,n,a[f+13],12,-40341101),n=h(n,p,k,m,a[f+14],17,-1502002290),m=h(m,n,p,k,a[f+15],22,1236535329),k=c(k,m,n,p,a[f+1],5,-165796510),p=c(p,k,m,n,a[f+6],9,-1069501632),n=c(n,p,k,m,a[f+11],14,643717713),m=c(m,n,p,k,a[f],20,-373897302),k=c(k,m,n,p,a[f+5],5,-701558691),p=c(p,k,m,n,a[f+10],9,38016083),n=c(n,
p,k,m,a[f+15],14,-660478335),m=c(m,n,p,k,a[f+4],20,-405537848),k=c(k,m,n,p,a[f+9],5,568446438),p=c(p,k,m,n,a[f+14],9,-1019803690),n=c(n,p,k,m,a[f+3],14,-187363961),m=c(m,n,p,k,a[f+8],20,1163531501),k=c(k,m,n,p,a[f+13],5,-1444681467),p=c(p,k,m,n,a[f+2],9,-51403784),n=c(n,p,k,m,a[f+7],14,1735328473),m=c(m,n,p,k,a[f+12],20,-1926607734),k=e(m^n^p,k,m,a[f+5],4,-378558),p=e(k^m^n,p,k,a[f+8],11,-2022574463),n=e(p^k^m,n,p,a[f+11],16,1839030562),m=e(n^p^k,m,n,a[f+14],23,-35309556),k=e(m^n^p,k,m,a[f+1],4,-1530992060),
p=e(k^m^n,p,k,a[f+4],11,1272893353),n=e(p^k^m,n,p,a[f+7],16,-155497632),m=e(n^p^k,m,n,a[f+10],23,-1094730640),k=e(m^n^p,k,m,a[f+13],4,681279174),p=e(k^m^n,p,k,a[f],11,-358537222),n=e(p^k^m,n,p,a[f+3],16,-722521979),m=e(n^p^k,m,n,a[f+6],23,76029189),k=e(m^n^p,k,m,a[f+9],4,-640364487),p=e(k^m^n,p,k,a[f+12],11,-421815835),n=e(p^k^m,n,p,a[f+15],16,530742520),m=e(n^p^k,m,n,a[f+2],23,-995338651),k=d(k,m,n,p,a[f],6,-198630844),p=d(p,k,m,n,a[f+7],10,1126891415),n=d(n,p,k,m,a[f+14],15,-1416354905),m=d(m,n,
p,k,a[f+5],21,-57434055),k=d(k,m,n,p,a[f+12],6,1700485571),p=d(p,k,m,n,a[f+3],10,-1894986606),n=d(n,p,k,m,a[f+10],15,-1051523),m=d(m,n,p,k,a[f+1],21,-2054922799),k=d(k,m,n,p,a[f+8],6,1873313359),p=d(p,k,m,n,a[f+15],10,-30611744),n=d(n,p,k,m,a[f+6],15,-1560198380),m=d(m,n,p,k,a[f+13],21,1309151649),k=d(k,m,n,p,a[f+4],6,-145523070),p=d(p,k,m,n,a[f+11],10,-1120210379),n=d(n,p,k,m,a[f+2],15,718787259),m=d(m,n,p,k,a[f+9],21,-343485551),k=b(k,q),m=b(m,t),n=b(n,r),p=b(p,u);a=[k,m,n,p];q="";t=32*a.length;
for(f=0;f<t;f+=8)q+=z.fromCharCode(a[f>>5]>>>f%32&255);a=q;f="";for(t=0;t<a.length;t+=1)q=a.charCodeAt(t),f+="0123456789abcdef".charAt(q>>>4&15)+"0123456789abcdef".charAt(q&15);return f}})(a);a.quickContext=function(){function f(b){var c={};a.utils.each(b,function(a,b){t[b]&&(c[b]=a)});return c}function b(b){var c={};a.utils.each(r,function(a,d){b[d]&&(c[d]=1)});return c}function e(b){var c=[];a.utils.each(b,function(b){a.utils.isArray(b)?c=c.concat(e(b)):(b=b.match(/sgmt_\d+/))&&(c=c.concat(b))});
return c}function h(d){var e=c();if(e){var h={};a.utils.each(e.segments,function(a){h["sgmt_"+a]=1});e.segments=h;l.UID=e.UID;l.lastLoginId=e.lastLoginId;l.origin=e.origin;l.lastPageView=e.lastPageView||l.lastPageView;a.utils.each(f(e.lastDisplayTime),function(a,b){g("lastDisplayTime",b,a)});a.utils.each(f(e.lastRevisionId),function(a,b){g("lastRevisionId",b,a)});l.segments=b(e.segments);e.profile&&(l.profile=e.profile);e.states&&(l.states.session=a.utils.extend({},e.states.session))}var e=B.now(),
q=e-l.lastPageView.time>=a.main.VISIT_TIMEOUT;q&&(l.states.session={});u=0===l.lastPageView.time||q;l.lastPageView.time=e;null===l.UID&&(l.UID=a.uid.newUid(d),l.origin=a.config.api.origin);a.quickContext.save(l)}function c(){var b;if(a.quickContext.getType()===a.CONTEXT_TYPE_STORAGE){if(b=a.store.get(a.COOKIE_QUICK_CONTEXT))return b;b=v.JSON.safeParse(a.cookies.get(a.COOKIE_QUICK_CONTEXT));if(!b)return;a.store.set(a.COOKIE_QUICK_CONTEXT,b);a.cookies.remove(a.COOKIE_QUICK_CONTEXT);a.log.info("Migrated quick context from cookie storage to local storage",
"context.migration");return b}if(b=v.JSON.safeParse(a.cookies.get(a.COOKIE_QUICK_CONTEXT)))return b;if(b=a.store.get(a.COOKIE_QUICK_CONTEXT))return a.cookies.set(a.COOKIE_QUICK_CONTEXT,v.JSON.stringify(b),365),a.store.remove(a.COOKIE_QUICK_CONTEXT),a.log.info("Migrated quick context from local storage to cookie storage","context.migration"),b}function d(){a.events.once(a.EVENT_INIT_UID,function(b){l.UID=b;a.quickContext.save(l)});a.ready(function(){l.lastPageView.time=a.context.lastPageView.time;
l.segments=b(a.context.segments);a.quickContext.save(l)});a.events.on(a.EVENT_SEGMENT_ENTER,function(b){r[b]&&(l.segments[b]=1,a.quickContext.save(l))});a.events.on(a.EVENT_SEGMENT_LEAVE,function(b){l.segments[b]&&(delete l.segments[b],a.quickContext.save(l))});a.events.on(a.EVENT_STATE_SET,function(b,c,d){d===a.STATE_TYPE_SESSION&&(l.states.session[b]=c,a.quickContext.save(l))});a.events.on(a.EVENT_STATE_REMOVE,function(b){void 0!==l.states.session[b]&&(delete l.states.session[b],a.quickContext.save(l))});
a.events.on(a.EVENT_MESSAGE_SHOW,function(b){t[b.id]&&g("lastDisplayTime",b.id,a.utils.getTimestamp())&&g("lastRevisionId",b.id,b.revision)&&a.quickContext.save(l)})}function g(a,b,c){b=H(b);return 0<b&&0<c?(l[a][b]=c,!0):!1}var l,q={VERSION:"1.1.0",UID:null,origin:null,lastDisplayTime:{},lastRevisionId:{},lastPageView:{time:0},segments:{},states:{session:{}}},t={},r={},u=!1;return{init:function(b,c){l=l||a.utils.clone(q);t={};a.utils.each(b,function(a){t[a.id]=1});a.utils.each(b,function(b){a.utils.each(e(b.segmentRules),
function(a){r[a]=1})});h(c);d();a.events.trigger(a.EVENT_INIT_QUICK_CONTEXT,a.quickContext.get())},get:function(){return a.utils.clone(l)},getType:function(){return a.config.sharedContext?a.CONTEXT_TYPE_XDM:a.CONTEXT_TYPE_STORAGE},hasSessionExpired:function(){return u},remove:function(){l=a.utils.clone(q);t={};r={};a.store.remove(a.COOKIE_QUICK_CONTEXT);a.cookies.exists(a.COOKIE_QUICK_CONTEXT)&&a.cookies.remove(a.COOKIE_QUICK_CONTEXT)},save:function(b){b=a.utils.clone(b);l=a.utils.extend(l,b);b.segments=
a.utils.map(b.segments,function(a,b){return H(b.replace(/sgmt_/,""))});0===b.segments.length&&delete b.segments;a.utils.isEmpty(b.lastDisplayTime)&&delete b.lastDisplayTime;a.utils.isEmpty(b.lastRevisionId)&&delete b.lastRevisionId;a.quickContext.getType()===a.CONTEXT_TYPE_STORAGE?a.store.set(a.COOKIE_QUICK_CONTEXT,b):a.cookies.set(a.COOKIE_QUICK_CONTEXT,v.JSON.stringify(b),365)},_getSegmentsFromRules:e}}();a.quickMessage=function(){function f(b,c,d){var e=B.now(),g=a.states.getAll(),f=new a.baseEvaluator;
f.setEvaluatorValue("segments",c.segments);a.utils.each(b,function(h){if(a.utils.inArray(h.decils,d)){var l=!h.endTime||e<=h.endTime;h.startTime<=e&&l?a.utils.every(h.states,function(b,c){return a.utils.inArray(b,g[c])})?f.evaluate(h.segmentRules)?void 0!==c.profile&&"all"!==h.profile&&h.profile!==c.profile&&delete b[h.id]:delete b[h.id]:delete b[h.id]:delete b[h.id]}else delete b[h.id]})}function b(b,c,d){a.utils.each(b,function(a){a.revision=e(a,c,d)})}function e(b,c,d){var e=a.utils.find(b.revisions,
function(a){return 999===a.id});if(d&&e)return e;d=a.utils.filter(b.revisions,function(a){return 999!==a.id});e=!a.quickContext.hasSessionExpired();if(b.revisionsLock||e){var g=c.lastRevisionId[b.id];if(b=a.utils.find(d,function(a){return a.id===g}))return b}if(a.utils.some(d,function(a){return 0<a.balancing})&&(b=h(d)))return b;b=F.floor(F.random()*d.length);return d[b]}function h(b){var c=0;b=a.utils.filter(b,function(a){return 0<a.balancing?(c+=a.balancing,!0):!1});b.sort(function(a,b){return a.balancing===
b.balancing?a.id-b.id:a.balancing-b.balancing});var d,e=0,g=c*F.random();return a.utils.find(b,function(a){d=a;e+=a.balancing;return e>=g})||d}function c(b,c){var d={},e=[];a.utils.each(b,function(b){var g={id:b.id,priority:b.priority,selected:0,lastShown:c.lastDisplayTime[b.id]||0};a.utils.each(b.positions,function(a){d[a]||(d[a]=[],e.push(a));d[a].push(g)})});e.sort(function(a,b){return a-b});var g=0,f={};a.utils.each(e,function(a){var b=d[a];b.sort(function(a,b){return a.priority!==b.priority?
b.priority-a.priority:a.selected!==b.selected?a.selected-b.selected:a.lastShown-b.lastShown});b=b[0];f[a]=b.id;g+=1;b.selected=g});return f}function d(b,c,d){c=a.utils.map(c,function(c,e){var f=a.message.getPosition(e);f instanceof a.positionData||(f=new a.positionData(f,d),a.console.error("[quickMessage]","Invalid type for "+e+", must be an instance of easy.positionData"));var h=g(b[c]);f.setMessage(h);return f});return a.utils.filter(c,function(a){return d&&a.isMatchingUrl(d)})}function g(b){b=
a.utils.clone(b);delete b.revisions;b.options=a.utils.extend({displayDelay:0,displayInterval:0,maxDisplayTimes:0},b.options);var c=b.revision;b.content=c.content||"";b.messageName="";b.revision=c.id;b.revisionType=c.type;b.title=c.title;c.template&&(b.template=c.template);return b}var l;return{init:function(b,c){a.utils.isEmpty(b)?a.quickContext.remove():(l={},a.utils.each(b,function(b){a.utils.isEmpty(b.revisions)||(l[b.id]=b)}),a.quickContext.init(b,c))},requestMessages:function(){if(l&&!a.preview.getParams()){var e=
a.quickContext.get();a.profile&&a.profile.validate(e.profile);var g=e.lastLoginId?e.lastLoginId:e.UID,h=a.uid.getDecilForUid(g),u=a.uid.isInComparisonGroup(g),g=a.utils.clone(l);f(g,e,h);b(g,e,u);e=c(g,e);h=a.main.getCurrentBrowserData().href;g=d(g,e,h);a.message.updatePositions(g);a.utils.each(g,a.guard(a.message.show,{module:a.MODULE_MESSAGE}))}},_testApplyMessageFilters:f,_testGetShowableRevision:e,_testPrioritizeAndSortMessages:c,_testConvertToNormalMessage:g}}();a.contextApi=function(){function f(b,
e,f,c,d){f=a.utils.isFunction(f)?a.guard(f):function(){};c=a.utils.isFunction(c)?a.guard(c):function(){};return a.fetch.ajax({url:e,method:b,data:v.JSON.stringify(d),dataType:"text",success:function(a){try{f(v.JSON.parse(a))}catch(b){f(void 0)}},error:c})}return{get:function(b,e,h){return f("GET",a.api.getCallUrl("contextApi",{method:"get",key:b,_source:"core"}),e,h,null)},set:function(b,e,h,c){return f("POST",a.api.getCallUrl("contextApi",{method:"set",key:b,_source:"core"}),h,c,e)}}}();a.segmentCounters=
function(){function f(c,d){var e=b(new B(a.context.lastPageView.time-864E5*(d-1)));return a.utils.filter(c,function(a){return a>=e})}function b(b){return a.utils.getDateInContextFormat(b)}function e(b){if(b=a.context.counts[b]){var d=[];a.utils.each(b.split(","),function(a){a=a.split(":");for(var b=H(a[1])||1;0<b--;)d.push(a[0])});return d}return[]}function h(b,d){d=d.slice(-20);var e={};a.utils.each(d,function(a){e[a]=++e[a]||1});var f=[];a.utils.each(a.utils.keys(e).sort(),function(a){var b=e[a];
f.push(a+(1===b?"":":"+b))});a.context.counts[b]=f.join(",");a.context.save()}return{getTriggerCount:function(a,b){return f(e(a.id),b).length},incrementCounter:function(c){var d=e(c.id);switch(c.frequency){case "everytime":d.push(b(new B(a.context.lastPageView.time)));break;case "once_a_visit":var f;f=new B(a.context.lastVisit.time);f=b(f)+a.utils.pad(f.getHours(),"0",2)+a.utils.pad(f.getMinutes(),"0",2);a.utils.inArray(d,f)||d.push(f);break;case "once_a_day":f=b(new B(a.context.lastPageView.time));
a.utils.inArray(d,f)||d.push(f);break;default:throw new x('Invalid segment "frequency" property of '+c.frequency);}h(c.id,d)},removeExpiredTimes:function(a){h(a.id,f(e(a.id),a.timelimit))},removeUnusedCounters:function(b){a.utils.each(a.context.counts,function(d,e){b[e]||delete a.context.counts[e]});a.context.save()}}}();a.segmentGroups=function(){function f(b,f){return b?a.utils.map(b.segments,function(b){return a.utils.extend({segment:b},f[b])}):a.utils.map(f,function(b,d){return a.utils.extend({segment:d},
b)})}function b(b){var f=null,c=null,d=null;a.utils.each(b,function(a){a.state&&(f=a.segment,a.inSegment&&(c=a.segment),a.event&&(d=a.segment));f=d||c||f});a.utils.each(b,function(b){var c=b.segment;f===b.segment?a.segmentchange.setSegment(c):a.segmentchange.removeSegment(c)})}return{changeState:function(e,h){var c=f(e,h);switch(e&&e.mode||"normal"){case "normal":a.utils.each(c,function(b){var c=b.segment;b.state?a.segmentchange.setSegment(c):a.segmentchange.removeSegment(c)});break;case "radio":b(c)}}}}();
a.segments=function(){function f(){a.utils.each(u,function(b,c){a.segmentGroups.changeState(r["sggp_"+c],b)});u={}}function b(){a.utils.setTimeout(function(){a.events.isTriggered(a.EVENT_SEGMENTS_READY)||a.events.trigger(a.EVENT_SEGMENTS_READY)})}function e(d){var e={};a.utils.each(d,function(b){a.utils.each(b.triggers,function(a){var c=a.on_event;(e[c]=e[c]||[]).push({segment:b,trigger:a})})});a.utils.each(e,function(d,e){a.events.on(e,function(){k||(k=!0,a.utils.setTimeout(function(){k=!1;f();b()}));
n=h(e,arguments);c(d);n={}})})}function h(b,c){switch(b){case a.EVENT_CUSTOMACTION:return{name:c[0],value:c[1]};case a.EVENT_STATE_REMOVE:return{name:c[0]};case a.EVENT_STATE_SET:return{name:c[0],value:c[1],type:c[2]};case a.EVENT_ERROR_SENT:return{error:c[0],code:c[1]};default:return c[0]}}function c(b){var c={};a.utils.each(b,function(b){var d=b.segment;b=b.trigger;t.setErrorOptions({type:a.ERROR_TYPE_SEGMENT_EXCEPTION,level:a.LOG_LEVEL_ERROR,module:a.MODULE_SEGMENT,segmentId:d.name});t.evaluate(b.rules)&&
(g(b.counterIds,c),l(d,!0))})}function d(b){var c={};a.utils.each((r["sggp_"+b]||{}).segments,function(b){c[b]={event:!1,inSegment:a.segmentchange.inSegment(b),state:!1}});return c}function g(b,c){a.utils.each(b,function(b){c[b]||(c[b]=!0,a.segmentCounters.incrementCounter(q[b]))})}function l(b,c){var e=b.segmentGroupId||0,f=u[e]=u[e]||d(e),g=f[b.name]=f[b.name]||{};g.event=c;g.inSegment=a.segmentchange.inSegment(b.name);g.state=m[b.name]=t.evaluate(b.rules);(e=r["sggp_"+e]||{},"radio"===e.mode)&&
a.utils.each(e.segments,function(a){f[a].state=C(m[a])})}var q,t,r,u={},k=!1,m={},n={},p={"get-event-data":function(a){return n[a]},"get-trigger-count":function(b,c){return a.segmentCounters.getTriggerCount(q[b],c)},"has-conversion-product-ids":function(b){var c=a.utils.map(n.products,function(a){return a.id});return a.utils.some(c,function(c){return a.utils.some(b,function(a){return z(c)===z(a)})})}};return{init:function(c,d,g){t||(q=g,r=d,t=new a.baseEvaluator,a.utils.each(p,function(a,b){t.addEvaluatorFunction(b,
a)}),a.utils.each(g,function(a,b){a.id=b}),a.segmentCounters.removeUnusedCounters(g),a.utils.each(g,a.segmentCounters.removeExpiredTimes),a.utils.each(c,function(a){l(a,!1)}),f(),e(c));b()},clear:function(){a.events.clearEvent(a.EVENT_SEGMENTS_READY)},handleQueuedEvents:f,isFinished:function(){return a.utils.isEmpty(u)},_testClear:function(){t=void 0}}}();a.ERROR_SITE_PRODUCT=20012;a.addExceptionHandling=a.deprecate("easy.addExceptionHandling","easy.guard",function(f,b){var e={};a.utils.isObject(b)&&
(e.type=void 0!==b.code?b.code:b.type,e.level=a.utils.isString(b.level)?b.level:void 0,e.module=a.utils.isString(b.module)?b.module:void 0,e.html=a.utils.isString(b.html)?b.html:void 0,e.trace=a.utils.isString(b.trace)?b.trace:void 0,e.context=b.context);return a.guard(f,e)});a.api.error=a.deprecate("easy.api.error","easy.log.error",function(f){a.log.error('Deprecated "easy.api.error". Check "debug" for the original error',a.ERROR_TYPE_DEPRECATED+".removed",{debug:z(f),module:a.internal.getCurrentModule()})});
a.sendError=a.deprecate("easy.sendError","easy.log.error",function(f,b,e){var h={};f instanceof x||a.utils.isString(f)||(f=v.JSON.stringify(f));a.utils.isNumber(b)||(b=z(b||a.ERROR_TYPE_EXCEPTION));a.utils.isObject(e)&&(a.utils.isString(e.html)&&(h.html=e.html),a.utils.isString(e.trace)&&(h.trace=a.internal.truncate(e.trace,a.MAXIMUM_TRACE_LENGTH)));a.log.error(f,b,h);a.events.trigger(a.EVENT_ERROR_SENT,a.utils.extend({text:z(f)},h),b)});(function(){a.utils.isFunction(U.initFunction)&&!U.initialized&&
(a.workspaces=U.workspaces,a.runGuarded(U.initFunction,void 0,{type:a.ERROR_TYPE_SITE_INIT}),U.initialized=!0);if(U.base&&U.origin){var f=a.domElements.addScriptTag("//"+U.base+"sites/"+U.origin+".js");a.ready(function(){f&&(f.removeAttribute("src"),f.parentNode?f.parentNode.removeChild(f):a.console.error("[init]","Customer's script element node does not have a parent node"),f=null)})}})();a.namespaceLoaded=!0}})();
